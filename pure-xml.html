

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Pure-XML - XML/XSLT interface &mdash; Pure Language and Library Documentation</title>
    
    <link rel="stylesheet" href="_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.68',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="Pure Language and Library Documentation" href="index.html" />
    <link rel="next" title="pure-g2" href="pure-g2.html" />
    <link rel="prev" title="Pure-Sql3" href="pure-sql3.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pure-modindex.html" title="Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pure-g2.html" title="pure-g2"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pure-sql3.html" title="Pure-Sql3"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Pure Language and Library Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-xml">
<span id="pure-xml-xml-xslt-interface"></span><h1>Pure-XML - XML/XSLT interface<a class="headerlink" href="#module-xml" title="Permalink to this headline">¶</a></h1>
<p>Version 0.7, April 11, 2018</p>
<p>Albert Graef &lt;<a class="reference external" href="mailto:aggraef&#37;&#52;&#48;gmail&#46;com">aggraef<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p><a class="reference external" href="http://www.w3.org/TR/xml">XML</a>, the Extensible Markup Language, facilitates the exchange of complex
structured data between applications and systems. <a class="reference external" href="http://www.w3.org/TR/xslt">XSLT</a> allows you to
transform XML documents to other XML-based formats such as HTML. Together, XML
and XSLT let you create dynamic web content with ease. Both XML and XSLT are
open standards by the W3C consortium (<a class="reference external" href="http://www.w3.org">http://www.w3.org</a>).</p>
<p>Pure&#8217;s XML interface is based on the libxml2 and libxslt libraries from the
GNOME project. If you have a Linux system then you most likely have these
libraries, otherwise you can get them from <a class="reference external" href="http://xmlsoft.org">http://xmlsoft.org</a>. For Windows
users, the required dlls are available from the GnuWin32 project
(<a class="reference external" href="http://gnuwin32.sourceforge.net">http://gnuwin32.sourceforge.net</a>) and are already included in the Pure MSI
package.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#copying" id="id1">Copying</a></li>
<li><a class="reference internal" href="#installation" id="id2">Installation</a></li>
<li><a class="reference internal" href="#usage" id="id3">Usage</a></li>
<li><a class="reference internal" href="#data-structure" id="id4">Data Structure</a><ul>
<li><a class="reference internal" href="#the-document-tree" id="id5">The Document Tree</a></li>
<li><a class="reference internal" href="#document-types" id="id6">Document Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operations" id="id7">Operations</a><ul>
<li><a class="reference internal" href="#document-operations" id="id8">Document Operations</a></li>
<li><a class="reference internal" href="#traversing-documents" id="id9">Traversing Documents</a></li>
<li><a class="reference internal" href="#node-information" id="id10">Node Information</a></li>
<li><a class="reference internal" href="#node-manipulation" id="id11">Node Manipulation</a></li>
<li><a class="reference internal" href="#transformations" id="id12">Transformations</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="copying">
<h2><a class="toc-backref" href="#id1">Copying</a><a class="headerlink" href="#copying" title="Permalink to this headline">¶</a></h2>
<p>Copyright (c) 2009 by Albert Graef &lt;<a class="reference external" href="mailto:aggraef&#37;&#52;&#48;gmail&#46;com">aggraef<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;.</p>
<p>pure-xml is free software: you can redistribute it and/or modify it under the
terms of the GNU Lesser General Public License as published by the Free
Software Foundation, either version 3 of the License, or (at your option) any
later version.</p>
<p>pure-xml is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more
details.</p>
<p>You should have received a copy of the GNU Lesser General Public License along
with this program.  If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id2">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Get the latest source from
<a class="reference external" href="https://bitbucket.org/purelang/pure-lang/downloads/pure-xml-0.7.tar.gz">https://bitbucket.org/purelang/pure-lang/downloads/pure-xml-0.7.tar.gz</a>.</p>
<p>Run <tt class="docutils literal"><span class="pre">make</span></tt> and then <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">install</span></tt> to compile and install this
module. This requires libxml2, libxslt and Pure.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id3">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Use the following declaration to make the operations of this module available
in your programs:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="kr">using</span> xml<span class="p">;</span>
</pre></div>
</div>
<p>The module defines two namespaces <tt class="docutils literal"><span class="pre">xml</span></tt> and <tt class="docutils literal"><span class="pre">xslt</span></tt> for the XML and the
XSLT operations, respectively. For convenience, you can open these in your
program as follows:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="kr">using</span> <span class="kr">namespace</span> xml, xslt<span class="p">;</span>
</pre></div>
</div>
<p>A number of complete examples illustrating the use of this module can be found
in the examples directory in the source distribution.</p>
</div>
<div class="section" id="data-structure">
<h2><a class="toc-backref" href="#id4">Data Structure</a><a class="headerlink" href="#data-structure" title="Permalink to this headline">¶</a></h2>
<p>This module represents XML documents using pointers to the <tt class="docutils literal"><span class="pre">xmlDoc</span></tt> and
<tt class="docutils literal"><span class="pre">xmlNode</span></tt> structures provided by the libxml2 library. Similarly,
stylesheets are simply pointers to the xmlStylesheet structure from libxslt
(cf. <a class="reference internal" href="#transformations">Transformations</a>). This makes it possible to use these objects
directly with the operations of the libxml2 and libsxslt libraries (via
Pure&#8217;s C interface) if necessary. Note, however, that these are all
&#8220;cooked&#8221; pointers which take care of freeing themselves automatically when
they are no longer needed, therefore you shouldn&#8217;t free them manually.</p>
<p>You can also check for these types of pointers using the following
predicates:</p>
<dl class="function">
<dt id="xml::docp">
<tt class="descclassname">xml::</tt><tt class="descname">docp</tt> x<a class="headerlink" href="#xml::docp" title="Permalink to this definition">¶</a></dt>
<dd><p>checks whether <tt class="docutils literal"><span class="pre">x</span></tt> is an XML document pointer.</p>
</dd></dl>

<dl class="function">
<dt id="xml::nodep">
<tt class="descclassname">xml::</tt><tt class="descname">nodep</tt> x<a class="headerlink" href="#xml::nodep" title="Permalink to this definition">¶</a></dt>
<dd><p>checks whether <tt class="docutils literal"><span class="pre">x</span></tt> is a pointer to a node in an XML document.</p>
</dd></dl>

<dl class="function">
<dt id="xslt::stylesheetp">
<tt class="descclassname">xslt::</tt><tt class="descname">stylesheetp</tt> x<a class="headerlink" href="#xslt::stylesheetp" title="Permalink to this definition">¶</a></dt>
<dd><p>checks whether <tt class="docutils literal"><span class="pre">x</span></tt> is an XSLT stylesheet pointer.</p>
</dd></dl>

<div class="section" id="the-document-tree">
<h3><a class="toc-backref" href="#id5">The Document Tree</a><a class="headerlink" href="#the-document-tree" title="Permalink to this headline">¶</a></h3>
<p>An XML document is a rooted tree which can be created, traversed and
manipulated using the operations of this module. There are different types
of nodes in the tree, each carrying their own type of data. In Pure land,
the node data is described using the following &#8220;node info&#8221; constructors.</p>
<span class="target" id="node-info"><span id="index-0"></span></span><dl class="constructor">
<dt id="xml::element">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">element</tt> tag ns attrs<a class="headerlink" href="#xml::element" title="Permalink to this definition">¶</a></dt>
<dd><p>An XML element with given (possibly qualified) name <tt class="docutils literal"><span class="pre">tag</span></tt>, a (possibly
empty) list of namespace declarations <tt class="docutils literal"><span class="pre">ns</span></tt> and a (possibly empty) list
of attributes <tt class="docutils literal"><span class="pre">attrs</span></tt>. Namespace declarations normally take the form
of a pair of strings <tt class="docutils literal"><span class="pre">(prefix,href)</span></tt>, where <tt class="docutils literal"><span class="pre">prefix</span></tt> is the prefix
associated with the namespace and <tt class="docutils literal"><span class="pre">href</span></tt> the corresponding URI (the
name of the namespace), but they can also be just a string <tt class="docutils literal"><span class="pre">href</span></tt> if
the namespace prefix is missing. Attributes are encoded as
<tt class="docutils literal"><span class="pre">key=&gt;value</span></tt> pairs, where <tt class="docutils literal"><span class="pre">key</span></tt> is the attribute name and <tt class="docutils literal"><span class="pre">value</span></tt>
the associated value; both <tt class="docutils literal"><span class="pre">key</span></tt> and <tt class="docutils literal"><span class="pre">value</span></tt> are strings.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::element_text">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">element_text</tt> tag ns attrs content<a class="headerlink" href="#xml::element_text" title="Permalink to this definition">¶</a></dt>
<dd><p>A convenience function which denotes a combination of an element node
with a text child. This is only used when creating a new node, and
indicates that a text node child is to be added to the node
automatically.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">attr</tt> key val<a class="headerlink" href="#xml::attr" title="Permalink to this definition">¶</a></dt>
<dd><p>An attribute node. These only occur as results of the <tt class="xref pure pure-func docutils literal"><span class="pre">select</span></tt> and
<tt class="xref pure pure-func docutils literal"><span class="pre">attrs</span></tt> functions, and cannot be inserted directly into a
document.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::text">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">text</tt> content<a class="headerlink" href="#xml::text" title="Permalink to this definition">¶</a></dt>
<dd><p>A text node with the given content (a string).</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::cdata">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">cdata</tt> content<a class="headerlink" href="#xml::cdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Like <a class="reference internal" href="#xml::text" title="xml::text"><tt class="xref pure pure-func docutils literal"><span class="pre">xml::text</span></tt></a>, but contains unparsed character data.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::comment">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">comment</tt> content<a class="headerlink" href="#xml::comment" title="Permalink to this definition">¶</a></dt>
<dd><p>A comment.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::entity_ref">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">entity_ref</tt> name<a class="headerlink" href="#xml::entity_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>An entity reference (<tt class="docutils literal"><span class="pre">&amp;name;</span></tt>).</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::pi">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">pi</tt> name content<a class="headerlink" href="#xml::pi" title="Permalink to this definition">¶</a></dt>
<dd><p>Processing instructions. <tt class="docutils literal"><span class="pre">name</span></tt> is the application name, <tt class="docutils literal"><span class="pre">content</span></tt>
the text of the processing instructions.</p>
</dd></dl>

</div>
<div class="section" id="document-types">
<h3><a class="toc-backref" href="#id6">Document Types</a><a class="headerlink" href="#document-types" title="Permalink to this headline">¶</a></h3>
<p id="dtd"><span id="index-1"></span>Besides the node types described above, there are some additional node
types used in the <a class="reference external" href="http://www.w3.org/TR/REC-xml/#dt-doctype">document type definition</a> (DTD), which can be extracted
from a document using the <tt class="xref pure pure-func docutils literal"><span class="pre">int_subset</span></tt> and <tt class="xref pure pure-func docutils literal"><span class="pre">ext_subset</span></tt>
functions. These are for inspection purposes only; it is not possible to
change the DTD of a document in-place. (However, you can create a new
document and attach a DTD to it, using the <tt class="xref pure pure-func docutils literal"><span class="pre">new_doc</span></tt> function.)</p>
<dl class="constructor">
<dt id="xml::doctype">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">doctype</tt> name extid<a class="headerlink" href="#xml::doctype" title="Permalink to this definition">¶</a></dt>
<dd><p>DTDs are represented using this special type of node, where <tt class="docutils literal"><span class="pre">name</span></tt> is
the name of the root element, and <tt class="docutils literal"><span class="pre">extid</span></tt> is a pair consisting of the
external identifier and the URI of the DTD (or just the URI if there is
no external identifier). The <a class="reference internal" href="#xml::doctype" title="xml::doctype"><tt class="xref pure pure-cons docutils literal"><span class="pre">xml::doctype</span></tt></a> node has as its
children zero or more of the following kinds of DTD declaration nodes
(these are just straightforward abstract syntax for the !ELEMENT,
!ATTLIST and !ENTITY declarations inside a DTD declaration; see the XML
specification for details).</p>
</dd></dl>

<p id="element-declaration"><span id="index-2"></span><em>Element declarations:</em> Here, <tt class="docutils literal"><span class="pre">name</span></tt> is the element tag and <tt class="docutils literal"><span class="pre">content</span></tt>
the definition of the element structure, see <a class="reference internal" href="#element-content">element content</a> below. XML
supports various kinds of element types, please refer to <a class="reference external" href="http://www.w3.org/TR/REC-xml/#dt-doctype">document type
definition</a> in the XML specification for details.</p>
<dl class="constructor">
<dt id="xml::undefined_element">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">undefined_element</tt> name<a class="headerlink" href="#xml::undefined_element" title="Permalink to this definition">¶</a></dt>
<dd><p>An undefined element. This is in libxml2, but not in the XML
specification, you shouldn&#8217;t see this in normal operation.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::empty_element">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">empty_element</tt> name<a class="headerlink" href="#xml::empty_element" title="Permalink to this definition">¶</a></dt>
<dd><p>An element without any content.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::any_element">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">any_element</tt> name<a class="headerlink" href="#xml::any_element" title="Permalink to this definition">¶</a></dt>
<dd><p>An element with unrestricted content.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::mixed_element">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">mixed_element</tt> name content<a class="headerlink" href="#xml::mixed_element" title="Permalink to this definition">¶</a></dt>
<dd><p>A &#8220;mixed&#8221; element which can contain character data, optionally
interspersed with child elements, as given in the <tt class="docutils literal"><span class="pre">content</span></tt>
specification.</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::std_element">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">std_element</tt> name content<a class="headerlink" href="#xml::std_element" title="Permalink to this definition">¶</a></dt>
<dd><p>A standard element consisting <em>only</em> of child elements, as given in the
<tt class="docutils literal"><span class="pre">content</span></tt> specification.</p>
</dd></dl>

<p id="attribute-declaration"><span id="index-3"></span><em>Attribute declarations:</em> These are used to declare the attributes of an
element. <tt class="docutils literal"><span class="pre">elem_name</span></tt> is the name of an element which describes the
attribute type, <tt class="docutils literal"><span class="pre">name</span></tt> is the name of the attribute itself, and
<tt class="docutils literal"><span class="pre">default</span></tt> specifies the default value of the attribute, see <a class="reference internal" href="#attribute-defaults">attribute
defaults</a> below. XML supports a bunch of different attribute types, please
refer to <a class="reference external" href="http://www.w3.org/TR/REC-xml/#dt-doctype">document type definition</a> in the XML specification for details.</p>
<dl class="constructor">
<dt id="xml::cdata_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">cdata_attr</tt> elem_name name default<a class="headerlink" href="#xml::cdata_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::id_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">id_attr</tt> elem_name name default<a class="headerlink" href="#xml::id_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::idref_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">idref_attr</tt> elem_name name default<a class="headerlink" href="#xml::idref_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::idrefs_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">idrefs_attr</tt> elem_name name default<a class="headerlink" href="#xml::idrefs_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::entity_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">entity_attr</tt> elem_name name default<a class="headerlink" href="#xml::entity_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::entities_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">entities_attr</tt> elem_name name default<a class="headerlink" href="#xml::entities_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::nmtoken_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">nmtoken_attr</tt> elem_name name default<a class="headerlink" href="#xml::nmtoken_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::nmtokens_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">nmtokens_attr</tt> elem_name name default<a class="headerlink" href="#xml::nmtokens_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::enum_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">enum_attr</tt> elem_name name vals default<a class="headerlink" href="#xml::enum_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::notation_attr">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">notation_attr</tt> elem_name name vals default<a class="headerlink" href="#xml::notation_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p id="entity-declaration"><span id="index-4"></span><em>Entity declarations:</em> These are used for internal and external entity
declarations. <tt class="docutils literal"><span class="pre">name</span></tt> is the entity name and <tt class="docutils literal"><span class="pre">content</span></tt> its
definition. External entities also have an <tt class="docutils literal"><span class="pre">extid</span></tt> (external
identifier/URI pair) identifying the entity.</p>
<dl class="constructor">
<dt id="xml::int_entity">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">int_entity</tt> name content<a class="headerlink" href="#xml::int_entity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::int_param_entity">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">int_param_entity</tt> name content<a class="headerlink" href="#xml::int_param_entity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::ext_entity">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">ext_entity</tt> name extid content<a class="headerlink" href="#xml::ext_entity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="constructor">
<dt id="xml::ext_param_entity">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">ext_param_entity</tt> name extid content<a class="headerlink" href="#xml::ext_param_entity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p id="element-content"><span id="index-5"></span>The element content type (<tt class="docutils literal"><span class="pre">content</span></tt> argument of the <a class="reference internal" href="#element-declaration">element
declaration</a> nodes) is a kind of regular expression formed with tags
(specified as strings) and the following constructors:</p>
<dl class="constructor">
<dt id="xml::pcdata">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">pcdata</tt><a class="headerlink" href="#xml::pcdata" title="Permalink to this definition">¶</a></dt>
<dd><p>text data (<tt class="docutils literal"><span class="pre">#PCDATA</span></tt>)</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::sequence">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">sequence</tt> xs<a class="headerlink" href="#xml::sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>concatenation (<tt class="docutils literal"><span class="pre">x,y,z</span></tt>)</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::union">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">union</tt> xs<a class="headerlink" href="#xml::union" title="Permalink to this definition">¶</a></dt>
<dd><p>alternatives (<tt class="docutils literal"><span class="pre">x|y|z</span></tt>)</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::opt">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">opt</tt> x<a class="headerlink" href="#xml::opt" title="Permalink to this definition">¶</a></dt>
<dd><p>optional element (<tt class="docutils literal"><span class="pre">x?</span></tt>)</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::mult">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">mult</tt> x<a class="headerlink" href="#xml::mult" title="Permalink to this definition">¶</a></dt>
<dd><p>repeated element (<tt class="docutils literal"><span class="pre">x*</span></tt>)</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::plus">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">plus</tt> x<a class="headerlink" href="#xml::plus" title="Permalink to this definition">¶</a></dt>
<dd><p>non-optional repeated element (<tt class="docutils literal"><span class="pre">x+</span></tt>)</p>
</dd></dl>

<p id="attribute-defaults"><span id="index-6"></span>Attribute defaults (the <tt class="docutils literal"><span class="pre">default</span></tt> argument of <a class="reference internal" href="#attribute-declaration">attribute declaration</a>
nodes) are represented using the following constructor symbols:</p>
<dl class="constructor">
<dt id="xml::required">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">required</tt><a class="headerlink" href="#xml::required" title="Permalink to this definition">¶</a></dt>
<dd><p>a required attribute, i.e., the user must specify this</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::implied">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">implied</tt><a class="headerlink" href="#xml::implied" title="Permalink to this definition">¶</a></dt>
<dd><p>an implied attribute, i.e., the user does not have to specify this</p>
</dd></dl>

<dl class="constructor">
<dt id="xml::default">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">default</tt> val<a class="headerlink" href="#xml::default" title="Permalink to this definition">¶</a></dt>
<dd><p>an attribute with the given default value <tt class="docutils literal"><span class="pre">val</span></tt></p>
</dd></dl>

<dl class="constructor">
<dt id="xml::fixed">
<em class="property">constructor </em><tt class="descclassname">xml::</tt><tt class="descname">fixed</tt> val<a class="headerlink" href="#xml::fixed" title="Permalink to this definition">¶</a></dt>
<dd><p>an attribute with the given fixed value <tt class="docutils literal"><span class="pre">val</span></tt></p>
</dd></dl>

</div>
</div>
<div class="section" id="operations">
<h2><a class="toc-backref" href="#id7">Operations</a><a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h2>
<p>This module provides all operations necessary to create, inspect and
manipulate XML documents residing either in memory or on disk. Operations
for formatting XML documents using XSLT stylesheets are also available.</p>
<div class="section" id="document-operations">
<h3><a class="toc-backref" href="#id8">Document Operations</a><a class="headerlink" href="#document-operations" title="Permalink to this headline">¶</a></h3>
<p>The following functions allow you to create new XML documents, load them
from or save them to a file or a string, and provide general information
about a document.</p>
<dl class="function">
<dt id="xml::new_doc">
<tt class="descclassname">xml::</tt><tt class="descname">new_doc</tt> version dtd info<a class="headerlink" href="#xml::new_doc" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates an XML document. It returns a pointer to the new
document. <tt class="docutils literal"><span class="pre">version</span></tt> is a string denoting the XML version (or <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt> to
indicate the default). <tt class="docutils literal"><span class="pre">info</span></tt> is the <a class="reference internal" href="#node-info">node info</a> of the root node
(which should denote an element node). <tt class="docutils literal"><span class="pre">dtd</span></tt> denotes the document type
which can be <tt class="docutils literal"><span class="pre">()</span></tt> to denote an empty DTD, a string (the URI/filename
of the DTD), or a pair <tt class="docutils literal"><span class="pre">(pubid,sysid)</span></tt> where <tt class="docutils literal"><span class="pre">pubid</span></tt> denotes the
public identifier of the DTD and <tt class="docutils literal"><span class="pre">sysid</span></tt> its system identifier (URI).</p>
<p>Note that only simple kinds of documents with an internal DTD can be
created this way. Use the <tt class="xref pure pure-func docutils literal"><span class="pre">load_file</span></tt> or <tt class="xref pure pure-func docutils literal"><span class="pre">load_string</span></tt>
function below to create a skeleton document if a more elaborate prolog
is required.</p>
</dd></dl>

<dl class="function">
<dt id="xml::load_file">
<tt class="descclassname">xml::</tt><tt class="descname">load_file</tt> name flags<a class="headerlink" href="#xml::load_file" title="Permalink to this definition">¶</a></dt>
<dt id="xml::load_string">
<tt class="descclassname">xml::</tt><tt class="descname">load_string</tt> s flags<a class="headerlink" href="#xml::load_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an XML document from a file <tt class="docutils literal"><span class="pre">name</span></tt> or a string <tt class="docutils literal"><span class="pre">s</span></tt>. <tt class="docutils literal"><span class="pre">flags</span></tt>
denotes the parser flags, a bitwise disjunction of any of the following
constants, or 0 for the default:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">xml::DTDLOAD</span></tt>: load DTD</li>
<li><tt class="docutils literal"><span class="pre">xml::DTDVALID</span></tt>: validate</li>
<li><tt class="docutils literal"><span class="pre">xml::PEDANTIC</span></tt>: pedantic parse</li>
<li><tt class="docutils literal"><span class="pre">xml::SUBENT</span></tt>: substitute entities</li>
<li><tt class="docutils literal"><span class="pre">xml::NOBLANKS</span></tt>: suppress blank nodes</li>
</ul>
<p>The return value is the document pointer. These operations may also fail
if there is a fatal error parsing the document.</p>
</dd></dl>

<dl class="function">
<dt id="xml::save_file">
<tt class="descclassname">xml::</tt><tt class="descname">save_file</tt> name doc encoding compression<a class="headerlink" href="#xml::save_file" title="Permalink to this definition">¶</a></dt>
<dt id="xml::save_string">
<tt class="descclassname">xml::</tt><tt class="descname">save_string</tt> doc<a class="headerlink" href="#xml::save_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an XML document <tt class="docutils literal"><span class="pre">doc</span></tt> to a file or a string. When saving to a
file, <tt class="docutils literal"><span class="pre">encoding</span></tt> denotes the desired encoding (or <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt> for the
default), <tt class="docutils literal"><span class="pre">compression</span></tt> the desired level of zlib compression (0 means
none, 9 is maximum, -1 indicates the default). Note that with
<a class="reference internal" href="#xml::save_string" title="xml::save_string"><tt class="xref pure pure-func docutils literal"><span class="pre">xml::save_string</span></tt></a>, the result is always encoded as UTF-8.</p>
</dd></dl>

<dl class="function">
<dt id="xml::doc_info">
<tt class="descclassname">xml::</tt><tt class="descname">doc_info</tt> doc<a class="headerlink" href="#xml::doc_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve general information about a document. Returns a tuple
<tt class="docutils literal"><span class="pre">(version,encoding,url,compression,standalone)</span></tt>, where <tt class="docutils literal"><span class="pre">version</span></tt> is
the XML version of the document, <tt class="docutils literal"><span class="pre">encoding</span></tt> the external encoding (if
any), <tt class="docutils literal"><span class="pre">url</span></tt> the name/location of the document (if any),
<tt class="docutils literal"><span class="pre">compression</span></tt> the level of zlib compression, and <tt class="docutils literal"><span class="pre">standalone</span></tt> is a
flag indicating whether the document contains any external markup
declarations &#8220;which affect the information passed from the XML processor
to the application&#8221;, see the section on the <a class="reference external" href="http://www.w3.org/TR/REC-xml/#sec-rmd">standalone document
declaration</a> in the XML spec for details. (Apparently, in libxml2
<tt class="docutils literal"><span class="pre">standalone</span></tt> is either a truth value or one of the special values -1,
indicating that there&#8217;s no XML declaration in the prolog, or -2,
indicating that there&#8217;s an XML declaration but no <tt class="docutils literal"><span class="pre">standalone</span></tt>
attribute.)</p>
</dd></dl>

<dl class="function">
<dt id="xml::int_subset">
<tt class="descclassname">xml::</tt><tt class="descname">int_subset</tt> doc<a class="headerlink" href="#xml::int_subset" title="Permalink to this definition">¶</a></dt>
<dt id="xml::ext_subset">
<tt class="descclassname">xml::</tt><tt class="descname">ext_subset</tt> doc<a class="headerlink" href="#xml::ext_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the internal and external DTD subset of a document. Returns a
<tt class="docutils literal"><span class="pre">doctype</span></tt> node (fails if there&#8217;s no corresponding DTD).</p>
</dd></dl>

<p><strong>Example</strong></p>
<p>Read the sample.xml document distributed with the sources (ignoring blank
nodes) and retrieve the document info:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">using</span> xml<span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> sample = xml<span class="p">::</span>load_file <span class="s">&quot;sample.xml&quot;</span> xml<span class="p">::</span>NOBLANKS<span class="p">;</span>
<span class="gp">&gt; </span>xml<span class="p">::</span>doc_info sample<span class="p">;</span>
<span class="s">&quot;1.0&quot;</span>,<span class="s">&quot;&quot;</span>,<span class="s">&quot;sample.xml&quot;</span>,<span class="mi">0</span>,-<span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="traversing-documents">
<h3><a class="toc-backref" href="#id9">Traversing Documents</a><a class="headerlink" href="#traversing-documents" title="Permalink to this headline">¶</a></h3>
<p>These operations are used to traverse the document tree, i.e., the nodes of
the document. They take either a document pointer <tt class="docutils literal"><span class="pre">doc</span></tt> or a node pointer
<tt class="docutils literal"><span class="pre">node</span></tt> as argument, and yield a corresponding node pointer (or a document
pointer, in the case of <a class="reference internal" href="#xml::doc" title="xml::doc"><tt class="xref pure pure-func docutils literal"><span class="pre">xml::doc</span></tt></a>). The node pointers can then be
used with the <a class="reference internal" href="#node-information">Node Information</a> and <a class="reference internal" href="#node-manipulation">Node Manipulation</a> operations
described below.</p>
<dl class="function">
<dt id="xml::root">
<tt class="descclassname">xml::</tt><tt class="descname">root</tt> doc<a class="headerlink" href="#xml::root" title="Permalink to this definition">¶</a></dt>
<dd><p>the root node of <tt class="docutils literal"><span class="pre">doc</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="xml::doc">
<tt class="descclassname">xml::</tt><tt class="descname">doc</tt> node<a class="headerlink" href="#xml::doc" title="Permalink to this definition">¶</a></dt>
<dd><p>the document <tt class="docutils literal"><span class="pre">node</span></tt> belongs to</p>
</dd></dl>

<dl class="function">
<dt id="xml::parent">
<tt class="descclassname">xml::</tt><tt class="descname">parent</tt> node<a class="headerlink" href="#xml::parent" title="Permalink to this definition">¶</a></dt>
<dd><p>the parent of <tt class="docutils literal"><span class="pre">node</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="xml::first">
<tt class="descclassname">xml::</tt><tt class="descname">first</tt> node<a class="headerlink" href="#xml::first" title="Permalink to this definition">¶</a></dt>
<dt id="xml::last">
<tt class="descclassname">xml::</tt><tt class="descname">last</tt> node<a class="headerlink" href="#xml::last" title="Permalink to this definition">¶</a></dt>
<dd><p>first and last child node</p>
</dd></dl>

<dl class="function">
<dt id="xml::next">
<tt class="descclassname">xml::</tt><tt class="descname">next</tt> node<a class="headerlink" href="#xml::next" title="Permalink to this definition">¶</a></dt>
<dt id="xml::prev">
<tt class="descclassname">xml::</tt><tt class="descname">prev</tt> node<a class="headerlink" href="#xml::prev" title="Permalink to this definition">¶</a></dt>
<dd><p>next and previous sibling</p>
</dd></dl>

<dl class="function">
<dt id="xml::first_attr">
<tt class="descclassname">xml::</tt><tt class="descname">first_attr</tt> node<a class="headerlink" href="#xml::first_attr" title="Permalink to this definition">¶</a></dt>
<dt id="xml::last_attr">
<tt class="descclassname">xml::</tt><tt class="descname">last_attr</tt> node<a class="headerlink" href="#xml::last_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>first and last attribute node</p>
</dd></dl>

<p>All these operations fail if the corresponding target node does not exist,
or if the type of the given node is not supported by this implementation.</p>
<p>There are also two convenience functions to retrieve the children and
attribute nodes of a node:</p>
<dl class="function">
<dt id="xml::children">
<tt class="descclassname">xml::</tt><tt class="descname">children</tt> node<a class="headerlink" href="#xml::children" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the list of all child nodes of <tt class="docutils literal"><span class="pre">node</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="xml::attrs">
<tt class="descclassname">xml::</tt><tt class="descname">attrs</tt> node<a class="headerlink" href="#xml::attrs" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the list of all attribute nodes of <tt class="docutils literal"><span class="pre">node</span></tt></p>
</dd></dl>

<p>Moreover, given a node pointer <tt class="docutils literal"><span class="pre">node</span></tt>, <tt class="docutils literal"><span class="pre">node!i</span></tt> can be used to retrieve
the <tt class="docutils literal"><span class="pre">i</span></tt>th child of <tt class="docutils literal"><span class="pre">node</span></tt>.</p>
<p><strong>Example</strong></p>
<p>Peek at the root node of the sample document and its children:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> r = xml<span class="p">::</span>root sample<span class="p">;</span> r<span class="p">;</span>
<span class="kt">#&lt;pointer 0xe15e10&gt;</span>
<span class="gp">&gt; </span>xml<span class="p">::</span>node_info r<span class="p">;</span>
xml<span class="p">::</span>element <span class="s">&quot;story&quot;</span> [] []
<span class="gp">&gt; </span>#xml<span class="p">::</span>children r<span class="p">;</span>
<span class="mi">5</span>
<span class="gp">&gt; </span>xml<span class="p">::</span>node_info (r!<span class="mi">0</span>)<span class="p">;</span>
xml<span class="p">::</span>cdata <span class="s">&quot;&lt;greeting&gt;Hello, world!&lt;/greeting&gt;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="node-information">
<h3><a class="toc-backref" href="#id10">Node Information</a><a class="headerlink" href="#node-information" title="Permalink to this headline">¶</a></h3>
<p>These operations retrieve information about the nodes of an XML document.</p>
<dl class="function">
<dt id="xml::select">
<tt class="descclassname">xml::</tt><tt class="descname">select</tt> doc xpath<a class="headerlink" href="#xml::select" title="Permalink to this definition">¶</a></dt>
<dt>
<tt class="descclassname">xml::</tt><tt class="descname">select</tt> doc (xpath,ns)</dt>
<dd><p>Retrieve nodes using an <a class="reference external" href="http://www.w3.org/TR/xpath">XPath</a> specification. Given an XPath (a string)
<tt class="docutils literal"><span class="pre">xpath</span></tt>, this operation returns the list of all matching nodes in the
given document <tt class="docutils literal"><span class="pre">doc</span></tt>. You can also specify a node as the first
argument, in which case the document of the given node is searched and
paths are interpreted relative to the given node (rather than the root
node of the document).</p>
<p>Moreover, instead of just an XPath you can also specify a pair
<tt class="docutils literal"><span class="pre">(xpath,ns)</span></tt> consisting of an XPath <tt class="docutils literal"><span class="pre">xpath</span></tt> and a list <tt class="docutils literal"><span class="pre">ns</span></tt> of
<tt class="docutils literal"><span class="pre">prefix=&gt;uri</span></tt> string pairs which describe the namespaces to be
recognized in the XPath expression. This is necessary to select nodes by
qualified tag or attribute names. Note that only the namespace URIs must
match up with those used in the queried document; the corresponding
namespace prefixes can be chosen freely, so you can use whatever
prefixes are convenient to formulate the XPath query. However, for each
namespace prefix used in the XPath expression (not the document!), there
<em>must</em> be a corresponding binding in the <tt class="docutils literal"><span class="pre">ns</span></tt> list. Otherwise the
underlying libxml2 function will complain about an undefined namespace
prefix and <a class="reference internal" href="#xml::select" title="xml::select"><tt class="xref pure pure-func docutils literal"><span class="pre">xml::select</span></tt></a> will fail.</p>
</dd></dl>

<dl class="function">
<dt id="xml::node_info">
<tt class="descclassname">xml::</tt><tt class="descname">node_info</tt> node<a class="headerlink" href="#xml::node_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the node data from <tt class="docutils literal"><span class="pre">node</span></tt>. Returns a <a class="reference internal" href="#node-info">node info</a> value, as
described in <a class="reference internal" href="#data-structure">Data Structure</a> above. Fails if the node does not belong
to one of the supported node types.</p>
</dd></dl>

<dl class="function">
<dt id="xml::is_blank_node">
<tt class="descclassname">xml::</tt><tt class="descname">is_blank_node</tt><a class="headerlink" href="#xml::is_blank_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether a node is a blank node (empty or whitespace only) and
thus possibly ignorable.</p>
</dd></dl>

<dl class="function">
<dt id="xml::node_base">
<tt class="descclassname">xml::</tt><tt class="descname">node_base</tt> node<a class="headerlink" href="#xml::node_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the base URI of the given node.</p>
</dd></dl>

<dl class="function">
<dt id="xml::node_path">
<tt class="descclassname">xml::</tt><tt class="descname">node_path</tt> node<a class="headerlink" href="#xml::node_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the path of a node in the document, in the format accepted by
<tt class="xref pure pure-func docutils literal"><span class="pre">select</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="xml::node_content">
<tt class="descclassname">xml::</tt><tt class="descname">node_content</tt> node<a class="headerlink" href="#xml::node_content" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the text carried by the node, if any (after entity
substitution).</p>
</dd></dl>

<p>In addition, you can retrieve and change attributes of element nodes with
the following operations:</p>
<dl class="function">
<dt id="xml::node_attr">
<tt class="descclassname">xml::</tt><tt class="descname">node_attr</tt> node name<a class="headerlink" href="#xml::node_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the value of the attribute with the given <tt class="docutils literal"><span class="pre">name</span></tt> (after
entity substitution).</p>
</dd></dl>

<dl class="function">
<dt id="xml::set_node_attr">
<tt class="descclassname">xml::</tt><tt class="descname">set_node_attr</tt> node name value<a class="headerlink" href="#xml::set_node_attr" title="Permalink to this definition">¶</a></dt>
<dt id="xml::unset_node_attr">
<tt class="descclassname">xml::</tt><tt class="descname">unset_node_attr</tt> node name<a class="headerlink" href="#xml::unset_node_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets or unsets an attribute value.</p>
</dd></dl>

<p><strong>Examples</strong></p>
<p>Set and unset a node attribute:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>xml<span class="p">::</span>set_node_attr r <span class="s">&quot;foo&quot;</span> <span class="s">&quot;4711&quot;</span><span class="p">;</span>
()
<span class="gp">&gt; </span>xml<span class="p">::</span>node_info r<span class="p">;</span>
xml<span class="p">::</span>element <span class="s">&quot;story&quot;</span> [] [<span class="s">&quot;foo&quot;</span>=&gt;<span class="s">&quot;4711&quot;</span>]
<span class="gp">&gt; </span>xml<span class="p">::</span>node_attr r <span class="s">&quot;foo&quot;</span><span class="p">;</span>
<span class="s">&quot;4711&quot;</span>
<span class="gp">&gt; </span>xml<span class="p">::</span>unset_node_attr r <span class="s">&quot;foo&quot;</span><span class="p">;</span>
()
<span class="gp">&gt; </span>xml<span class="p">::</span>node_info r<span class="p">;</span>
xml<span class="p">::</span>element <span class="s">&quot;story&quot;</span> [] []
</pre></div>
</div>
<p>The <tt class="xref pure pure-func docutils literal"><span class="pre">select</span></tt> function is <em>very</em> powerful, and probably the single most
important operation of this module if you want to extract information from
an existing XML document without traversing the entire structure. Here is a
very simple example of its use:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>[xml<span class="p">::</span>node_content n, xml<span class="p">::</span>node_path n | n = xml<span class="p">::</span>select sample <span class="s">&quot;//author&quot;</span>]<span class="p">;</span>
[(<span class="s">&quot;John Fleck&quot;</span>,<span class="s">&quot;/story/storyinfo/author&quot;</span>)]
</pre></div>
</div>
<p>Note that if the XPath expression contains qualified names, the
corresponding namespace prefixes and their URIs must be given in the second
argument along with the XPath, as follows:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span>xml<span class="p">::</span>select doc (<span class="s">&quot;//foo:bar&quot;</span>, [<span class="s">&quot;foo&quot;</span>=&gt;<span class="s">&quot;http://www.foo.org&quot;</span>])<span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="node-manipulation">
<h3><a class="toc-backref" href="#id11">Node Manipulation</a><a class="headerlink" href="#node-manipulation" title="Permalink to this headline">¶</a></h3>
<p>These operations enable you to manipulate the document structure by adding
a new node to the document tree (specified through its <a class="reference internal" href="#node-info">node info</a>), and
by removing (unlinking) existing nodes from the tree.</p>
<dl class="function">
<dt id="xml::replace">
<tt class="descclassname">xml::</tt><tt class="descname">replace</tt> node info<a class="headerlink" href="#xml::replace" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the new node specified by <tt class="docutils literal"><span class="pre">info</span></tt> in place of the given node
<tt class="docutils literal"><span class="pre">node</span></tt>.</p>
</dd></dl>

<dl class="function">
<dt id="xml::add_first">
<tt class="descclassname">xml::</tt><tt class="descname">add_first</tt> node info<a class="headerlink" href="#xml::add_first" title="Permalink to this definition">¶</a></dt>
<dt id="xml::add_last">
<tt class="descclassname">xml::</tt><tt class="descname">add_last</tt> node info<a class="headerlink" href="#xml::add_last" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the new node as the first or last child of <tt class="docutils literal"><span class="pre">node</span></tt>, respectively.</p>
</dd></dl>

<dl class="function">
<dt id="xml::add_next">
<tt class="descclassname">xml::</tt><tt class="descname">add_next</tt> node info<a class="headerlink" href="#xml::add_next" title="Permalink to this definition">¶</a></dt>
<dt id="xml::add_prev">
<tt class="descclassname">xml::</tt><tt class="descname">add_prev</tt> node info<a class="headerlink" href="#xml::add_prev" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the new node as the next or previous sibling of <tt class="docutils literal"><span class="pre">node</span></tt>,
respectively.</p>
</dd></dl>

<p>The operations above all return a pointer to the new XML node object.</p>
<dl class="function">
<dt id="xml::unlink">
<tt class="descclassname">xml::</tt><tt class="descname">unlink</tt> node<a class="headerlink" href="#xml::unlink" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes an existing node from the document tree. Returns <tt class="docutils literal"><span class="pre">()</span></tt>.</p>
</dd></dl>

<p><strong>Examples</strong></p>
<p>Replace the first child of the root node in the sample document:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>xml<span class="p">::</span>node_info (r!<span class="mi">0</span>)<span class="p">;</span>
xml<span class="p">::</span>cdata <span class="s">&quot;&lt;greeting&gt;Hello, world!&lt;/greeting&gt;&quot;</span>
<span class="gp">&gt; </span>xml<span class="p">::</span>replace (r!<span class="mi">0</span>) (xml<span class="p">::</span>text <span class="s">&quot;bla bla&quot;</span>)<span class="p">;</span>
<span class="kt">#&lt;pointer 0xd40d80&gt;</span>
<span class="gp">&gt; </span>xml<span class="p">::</span>node_info (r!<span class="mi">0</span>)<span class="p">;</span>
xml<span class="p">::</span>text <span class="s">&quot;bla bla&quot;</span>
</pre></div>
</div>
<p>Delete that node:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>xml<span class="p">::</span>unlink (r!<span class="mi">0</span>)<span class="p">;</span>
()
<span class="gp">&gt; </span>xml<span class="p">::</span>node_info (r!<span class="mi">0</span>)<span class="p">;</span>
xml<span class="p">::</span>comment <span class="s">&quot;This is a sample document for testing the xml interface.&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="transformations">
<h3><a class="toc-backref" href="#id12">Transformations</a><a class="headerlink" href="#transformations" title="Permalink to this headline">¶</a></h3>
<p>The following operations provide basic XSLT support. As already mentioned,
stylesheets are represented as pointers to the xsltStylesheet structure
provided by libxslt. Note that, in difference to XML document pointers,
this is an opaque type, i.e., there is no direct means to inspect and
manipulate parsed stylesheets in memory using the operations of this
module. However, a stylesheet is just a special kind of XML document and
thus can be manipulated after reading the stylesheet as an ordinary XML
document. The <a class="reference internal" href="#xslt::load_stylesheet" title="xslt::load_stylesheet"><tt class="xref pure pure-func docutils literal"><span class="pre">load_stylesheet</span></tt></a> function then allows you to convert
the document pointer to an XSLT Stylesheet object.</p>
<p>Applying a stylesheet to an XML document generally involves the following
steps:</p>
<ol class="arabic simple">
<li>Load and parse the stylesheet using <a class="reference internal" href="#xslt::load_stylesheet" title="xslt::load_stylesheet"><tt class="xref pure pure-func docutils literal"><span class="pre">load_stylesheet</span></tt></a>. The
parameter to <a class="reference internal" href="#xslt::load_stylesheet" title="xslt::load_stylesheet"><tt class="xref pure pure-func docutils literal"><span class="pre">load_stylesheet</span></tt></a> can be either the name of a
stylesheet file or a corresponding document pointer. The function
returns a pointer to the stylesheet object which is used in the
subsequent processing.</li>
<li>Invoke <a class="reference internal" href="#xslt::apply_stylesheet" title="xslt::apply_stylesheet"><tt class="xref pure pure-func docutils literal"><span class="pre">apply_stylesheet</span></tt></a> on the stylesheet and the target
document.  This returns a new document containing the transformed XML
document.</li>
<li>Run <a class="reference internal" href="#xslt::save_result_file" title="xslt::save_result_file"><tt class="xref pure pure-func docutils literal"><span class="pre">save_result_file</span></tt></a> or <a class="reference internal" href="#xslt::save_result_string" title="xslt::save_result_string"><tt class="xref pure pure-func docutils literal"><span class="pre">save_result_string</span></tt></a> on the result
and the stylesheet to save the transformed document in a file or a
string.</li>
</ol>
<p>Here is a brief summary of the XSLT operations. Please check the <a class="reference external" href="http://www.w3.org/TR/xslt">XSLT</a>
documentation for details of the transformation process.</p>
<dl class="function">
<dt id="xslt::load_stylesheet">
<tt class="descclassname">xslt::</tt><tt class="descname">load_stylesheet</tt> x<a class="headerlink" href="#xslt::load_stylesheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a stylesheet. <tt class="docutils literal"><span class="pre">x</span></tt> can be either an XML document pointer, or a
string denoting the desired <tt class="docutils literal"><span class="pre">.xsl</span></tt> file.</p>
</dd></dl>

<dl class="function">
<dt id="xslt::apply_stylesheet">
<tt class="descclassname">xslt::</tt><tt class="descname">apply_stylesheet</tt> style doc params<a class="headerlink" href="#xslt::apply_stylesheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the stylesheet <tt class="docutils literal"><span class="pre">style</span></tt> to the given document <tt class="docutils literal"><span class="pre">doc</span></tt> with the
given parameters <tt class="docutils literal"><span class="pre">params</span></tt>. The third argument is a (possibly empty)
list of <tt class="docutils literal"><span class="pre">key=&gt;value</span></tt> string pairs which allows you to pass additional
parameters to the stylesheet.</p>
</dd></dl>

<dl class="function">
<dt id="xslt::save_result_file">
<tt class="descclassname">xslt::</tt><tt class="descname">save_result_file</tt> name doc style compression<a class="headerlink" href="#xslt::save_result_file" title="Permalink to this definition">¶</a></dt>
<dt id="xslt::save_result_string">
<tt class="descclassname">xslt::</tt><tt class="descname">save_result_string</tt> doc style<a class="headerlink" href="#xslt::save_result_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the transformation result <tt class="docutils literal"><span class="pre">doc</span></tt> obtained with the stylesheet
<tt class="docutils literal"><span class="pre">style</span></tt> to a file or a string. This works pretty much like
<tt class="xref pure pure-func docutils literal"><span class="pre">save_file</span></tt> or <tt class="xref pure pure-func docutils literal"><span class="pre">save_string</span></tt>, but also keeps track of some
output-related information contained in the stylesheet.</p>
</dd></dl>

<p><strong>Example</strong></p>
<p>Load the recipes.xml document and the recipes.xsl stylesheet distributed
with the sources:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> recipes = xml<span class="p">::</span>load_file <span class="s">&quot;recipes.xml&quot;</span> xml<span class="p">::</span>DTDVALID<span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> style = xslt<span class="p">::</span>load_stylesheet <span class="s">&quot;recipes.xsl&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>Apply the stylesheet to the document and save the result in a html file:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> res = xslt<span class="p">::</span>apply_stylesheet style recipes []<span class="p">;</span>
<span class="gp">&gt; </span>xslt<span class="p">::</span>save_result_file <span class="s">&quot;recipes.html&quot;</span> res style <span class="mi">0</span><span class="p">;</span>
()
</pre></div>
</div>
<p>That&#8217;s all. You can now have a look at recipes.html in your favourite web
browser.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Pure-XML - XML/XSLT interface</a><ul>
<li><a class="reference internal" href="#copying">Copying</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#data-structure">Data Structure</a><ul>
<li><a class="reference internal" href="#the-document-tree">The Document Tree</a></li>
<li><a class="reference internal" href="#document-types">Document Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operations">Operations</a><ul>
<li><a class="reference internal" href="#document-operations">Document Operations</a></li>
<li><a class="reference internal" href="#traversing-documents">Traversing Documents</a></li>
<li><a class="reference internal" href="#node-information">Node Information</a></li>
<li><a class="reference internal" href="#node-manipulation">Node Manipulation</a></li>
<li><a class="reference internal" href="#transformations">Transformations</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pure-sql3.html"
                        title="previous chapter">Pure-Sql3</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pure-g2.html"
                        title="next chapter">pure-g2</a></p>
<h3>This Page</h3>
<ul class="this-page-menu">
  <li><a href="bugs.html">Report a Bug</a></li>
  <li><a href="_sources/pure-xml.txt"
         rel="nofollow">Show Source</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pure-modindex.html" title="Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pure-g2.html" title="pure-g2"
             >next</a> |</li>
        <li class="right" >
          <a href="pure-sql3.html" title="Pure-Sql3"
             >previous</a> |</li>
        <li><a href="index.html">Pure Language and Library Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
    &copy; Copyright 2009-2020, Albert Gräf et al.
    Last updated on May 13, 2020.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>

  </body>
</html>