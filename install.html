

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installing Pure (and LLVM) &mdash; Pure Language and Library Documentation</title>
    
    <link rel="stylesheet" href="_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.64',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="Pure Language and Library Documentation" href="index.html" />
    <link rel="next" title="Running Pure on Windows" href="windows.html" />
    <link rel="prev" title="pure-midi" href="pure-midi.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pure-modindex.html" title="Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="windows.html" title="Running Pure on Windows"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pure-midi.html" title="pure-midi"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Pure Language and Library Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="installing-pure-and-llvm">
<h1>Installing Pure (and LLVM)<a class="headerlink" href="#installing-pure-and-llvm" title="Permalink to this headline">¶</a></h1>
<p>Version 0.64, July 07, 2016</p>
<div class="line-block">
<div class="line">Albert Graef &lt;<a class="reference external" href="mailto:aggraef&#37;&#52;&#48;gmail&#46;com">aggraef<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</div>
<div class="line">Eddie Rucker &lt;<a class="reference external" href="mailto:erucker&#37;&#52;&#48;bmc&#46;edu">erucker<span>&#64;</span>bmc<span>&#46;</span>edu</a>&gt;</div>
</div>
<p>These instructions explain how to compile and install LLVM (which is the
compiler backend required by Pure) and the Pure interpreter itself. The
instructions are somewhat biased towards Linux and other Unix-like systems;
the <a class="reference internal" href="#system-notes">System Notes</a> section at the end of this file details the tweaks
necessary to make Pure compile and run on various other platforms. More
information about installing LLVM and the required LLVM source packages can be
found at <a class="reference external" href="http://llvm.org">http://llvm.org</a>.</p>
<p>Pure is known to work on Linux, FreeBSD, NetBSD, Mac OS X and MS Windows, and
should compile (with the usual amount of tweaking) on all recent UNIX/POSIX-
based platforms. We recommend using version 4.x of the GNU C++ compiler; it
should be available almost everywhere (in fact, since you&#8217;ll need LLVM anyway,
you may also use one of the LLVM-based C/C++ compilers such as llvm-gcc or
clang). You&#8217;ll also need a Bourne-compatible shell and GNU make, which are
also readily available on most platforms.</p>
<p>A binary package in msi format is provided for Windows users in the download
area at <a class="reference external" href="http://purelang.bitbucket.org">http://purelang.bitbucket.org</a>. Information about ports and packages
for other (UNIX-like) systems is provided at the same location.</p>
<div class="section" id="quick-summary">
<h2>Quick Summary<a class="headerlink" href="#quick-summary" title="Permalink to this headline">¶</a></h2>
<p>Here is the executive summary for the impatient. This assumes that you&#8217;re
using LLVM 3.4 and Pure 0.64, please substitute your actual version
numbers in the commands given below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you&#8217;re reading this documentation online, then the Pure version
described here most likely is still under development, in which case you
can either grab the latest available release, or install from the
development sources instead (see <a class="reference internal" href="#installing-from-development-sources">Installing From Development Sources</a>
below).</p>
</div>
<p>Prerequisites: gcc, GNU make, flex/bison (development sources only), libltdl,
libgmp and libmpfr (including header files for development), wget (for
downloading and installing the online documentation), GNU emacs (if you want
to use Emacs Pure mode). These should all be available as binary packages on
most systems.</p>
<p>You&#8217;ll probably need the latest Pure and LLVM tarballs which, at the time of
this writing, are available here:</p>
<div class="line-block">
<div class="line"><a class="reference external" href="https://bitbucket.org/purelang/pure-lang/downloads/pure-0.64.tar.gz">https://bitbucket.org/purelang/pure-lang/downloads/pure-0.64.tar.gz</a></div>
<div class="line"><a class="reference external" href="http://llvm.org/releases/3.4/llvm-3.4.src.tar.gz">http://llvm.org/releases/3.4/llvm-3.4.src.tar.gz</a></div>
<div class="line"><a class="reference external" href="http://llvm.org/releases/3.4/clang-3.4.src.tar.gz">http://llvm.org/releases/3.4/clang-3.4.src.tar.gz</a></div>
<div class="line"><a class="reference external" href="http://llvm.org/releases/3.4/dragonegg-3.4.src.tar.gz">http://llvm.org/releases/3.4/dragonegg-3.4.src.tar.gz</a></div>
</div>
<p>Installing LLVM and clang (the latter is optional but recommended):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> tar xfvz llvm-3.4.src.tar.gz
<span class="gp">$</span> tar xfvz clang-3.4.src.tar.gz <span class="o">&amp;&amp;</span> mv clang-3.4 llvm-3.4/tools/clang
<span class="gp">$</span> <span class="nb">cd </span>llvm-3.4
<span class="gp">$</span> ./configure --enable-shared --enable-optimized --enable-targets<span class="o">=</span>host-only
<span class="gp">$</span> make <span class="o">&amp;&amp;</span> sudo make install
</pre></div>
</div>
<p>You may want to leave out <tt class="docutils literal"><span class="pre">--enable-shared</span></tt> to install LLVM as static
libraries only, and <tt class="docutils literal"><span class="pre">--enable-targets=host-only</span></tt> if you want to enable cross
compilation for all supported targets in LLVM. (With some older LLVM versions
you may also have to add <tt class="docutils literal"><span class="pre">--disable-assertions</span> <span class="pre">--disable-expensive-checks</span></tt>
to disable stuff that makes LLVM very slow and/or breaks it on some systems.)</p>
<p>If you&#8217;re running gcc 4.5 or later, you may also want to install the LLVM
&#8220;DragonEgg&#8221; plugin for gcc, please check the <a class="reference internal" href="#dragonegg">dragonegg</a> section below for
details.</p>
<p>Installing Pure:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> tar xfvz pure-0.64.tar.gz
<span class="gp">$</span> <span class="nb">cd </span>pure-0.64
<span class="gp">$</span> ./configure --enable-release
<span class="gp">$</span> make <span class="o">&amp;&amp;</span> sudo make install
</pre></div>
</div>
<p>Depending on your system you may have to run a utility to announce the shared
LLVM and Pure libraries to the dynamic loader. E.g., on Linux:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> sudo /sbin/ldconfig
</pre></div>
</div>
<p>It is also recommended that you run the following to make sure that the Pure
interpreter works correctly on your platform (see step 5 below for details):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> make check
</pre></div>
</div>
<p>The following is optional, but if you want to read the online documentation in
the interpreter or in <a class="reference internal" href="#emacs-pure-mode">Emacs Pure mode</a>, you&#8217;ll have to download and install
the documentation files:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> sudo make install-docs
</pre></div>
</div>
<p>This needs the <tt class="docutils literal"><span class="pre">wget</span></tt> program. You can also download and install the
pure-docs tarball manually in the usual way, e.g.:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> tar xfvz pure-docs-0.64.tar.gz
<span class="gp">$</span> <span class="nb">cd </span>pure-docs-0.64
<span class="gp">$</span> sudo make install
</pre></div>
</div>
<p>That&#8217;s it, Pure should be ready to go now:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> pure
</pre></div>
</div>
<p>Uninstalling:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>pure-0.64
<span class="gp">$</span> sudo make uninstall
<span class="gp">$</span> <span class="nb">cd</span> ../llvm-3.4
<span class="gp">$</span> sudo make uninstall
</pre></div>
</div>
<p>Please see below for much more detailed installation instructions.</p>
</div>
<div class="section" id="basic-installation">
<h2>Basic Installation<a class="headerlink" href="#basic-installation" title="Permalink to this headline">¶</a></h2>
<p>The basic installation process is as follows. Note that steps 1-3 are only
required once. Steps 2-3 can be avoided if binary LLVM packages are available
for your system (but see the caveats about broken LLVM packages on some
systems below). Additional instructions for compiling Pure from the latest
repository sources can be found in the <a class="reference internal" href="#installing-from-development-sources">Installing From Development Sources</a>
section below. Moreover, you can refer to the <a class="reference internal" href="#other-build-and-installation-options">Other Build And Installation
Options</a> section below for details about various options available when
building and installing Pure.</p>
<p><strong>Step 1.</strong> Make sure you have all the necessary dependencies installed
(<tt class="docutils literal"><span class="pre">-dev</span></tt> denotes corresponding development packages):</p>
<ul class="simple">
<li>GNU make, GNU C/C++ and the corresponding libraries;</li>
<li>the GNU multiprecision library (<tt class="docutils literal"><span class="pre">libgmp</span></tt>, <tt class="docutils literal"><span class="pre">-dev</span></tt>) or some compatible
replacement (see comments below);</li>
<li>the GNU multiprecision floating point library (<tt class="docutils literal"><span class="pre">libmpfr</span></tt>, <tt class="docutils literal"><span class="pre">-dev</span></tt>);</li>
<li>the PCRE library (<tt class="docutils literal"><span class="pre">libpcre</span></tt>, <tt class="docutils literal"><span class="pre">-dev</span></tt>), if you want Perl-compatible regex
support (see below);</li>
<li>GNU readline (<tt class="docutils literal"><span class="pre">libreadline</span></tt>, <tt class="docutils literal"><span class="pre">-dev</span></tt>) or some compatible replacement
(only needed if you want command line editing support in the interpreter;
see comments below).</li>
<li>GNU Emacs (if you want to use the Emacs Pure mode).</li>
<li>GNU TeXmacs (if you want to use the TeXmacs Pure plugin).</li>
</ul>
<p>In addition, the following will be required to compile the development version
(see the <a class="reference internal" href="#installing-from-development-sources">Installing From Development Sources</a> section below):</p>
<ul class="simple">
<li>autoconf and automake;</li>
<li>flex and bison;</li>
<li>mercurial (needed to fetch the development sources).</li>
</ul>
<p>The following may be required to build some LLVM versions:</p>
<ul class="simple">
<li>GNU ltdl library (<tt class="docutils literal"><span class="pre">libltdl</span></tt>, <tt class="docutils literal"><span class="pre">-dev</span></tt>).</li>
</ul>
<p>All dependencies are available as free software. Here are some links if you
need or want to install the dependencies from source:</p>
<ul class="simple">
<li>Autoconf: <a class="reference external" href="http://www.gnu.org/software/autoconf">http://www.gnu.org/software/autoconf</a></li>
<li>Automake: <a class="reference external" href="http://www.gnu.org/software/automake">http://www.gnu.org/software/automake</a></li>
<li>GNU C/C++: <a class="reference external" href="http://gcc.gnu.org">http://gcc.gnu.org</a></li>
<li>GNU make: <a class="reference external" href="http://www.gnu.org/software/make">http://www.gnu.org/software/make</a></li>
<li>Flex: <a class="reference external" href="http://flex.sourceforge.net">http://flex.sourceforge.net</a></li>
<li>Bison: <a class="reference external" href="http://www.gnu.org/software/bison">http://www.gnu.org/software/bison</a></li>
<li>GNU Emacs: <a class="reference external" href="http://www.gnu.org/software/emacs">http://www.gnu.org/software/emacs</a></li>
<li>GNU TeXmacs: <a class="reference external" href="http://savannah.gnu.org/projects/texmacs">http://savannah.gnu.org/projects/texmacs</a></li>
<li>GNU ltdl (part of the libtool software): <a class="reference external" href="http://www.gnu.org/software/libtool">http://www.gnu.org/software/libtool</a></li>
<li>Git: <a class="reference external" href="https://git-scm.com/">https://git-scm.com/</a> (A number of graphical frontends can be found
there as well. Windows users may also want to check TortoiseGit, see
<a class="reference external" href="https://tortoisegit.org/">https://tortoisegit.org/</a>.)</li>
</ul>
<p>The GNU multiprecision library or some compatible replacement is required for
Pure&#8217;s bigint support. Instead of GMP it&#8217;s also possible to use MPIR. You can
find these here:</p>
<ul class="simple">
<li>GMP: <a class="reference external" href="http://www.gnu.org/software/gmp">http://www.gnu.org/software/gmp</a></li>
<li>MPIR: <a class="reference external" href="http://www.mpir.org">http://www.mpir.org</a></li>
</ul>
<p>If you have both GMP and MPIR installed, you can specify <tt class="docutils literal"><span class="pre">--with-mpir</span></tt> when
configuring Pure to indicate that Pure should be linked against MPIR. Note
that using this option might cause issues with some Pure modules which
explicitly link against GMP. If you run into any such problems then you should
build MPIR with the <tt class="docutils literal"><span class="pre">--enable-gmpcompat</span></tt> configure option so that it becomes
a drop-in replacement for GMP (in this case the <tt class="docutils literal"><span class="pre">--with-mpir</span></tt> option isn&#8217;t
needed when configuring Pure).</p>
<p>In addition, Pure 0.48 and later also require the GNU multiprecision floating
point library:</p>
<ul class="simple">
<li>MPFR: <a class="reference external" href="http://www.mpfr.org">http://www.mpfr.org</a></li>
</ul>
<p>(Pure doesn&#8217;t really have built-in support for MPFR numbers, this is provided
through a separate pure-mpfr addon module instead, please check the Pure
website for details. However, there is now some support for printing both GMP
and MPFR numbers in the <tt class="docutils literal"><span class="pre">printf</span></tt> and <tt class="docutils literal"><span class="pre">scanf</span></tt> functions of the
<a class="reference internal" href="purelib.html#module-system"><tt class="xref pure pure-mod docutils literal"><span class="pre">system</span></tt></a> module, for which the MPFR library is needed.)</p>
<p>To make interactive command line editing work in the interpreter, you&#8217;ll also
need GNU readline or some compatible replacement such as BSD editline/libedit:</p>
<ul class="simple">
<li>GNU readline: <a class="reference external" href="http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html">http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html</a></li>
<li>BSD editline/libedit: <a class="reference external" href="http://www.thrysoee.dk/editline">http://www.thrysoee.dk/editline</a></li>
</ul>
<p>We recommend GNU readline because it&#8217;s easier to use and has full UTF-8
support, but in some situations BSD editline/libedit may be preferable for
license reasons or because it&#8217;s what the operating system provides. Pure&#8217;s
configuration script automatically detects the presence of both packages and
also lets you disable readline and/or editline support using the
<tt class="docutils literal"><span class="pre">--without-readline</span></tt> and <tt class="docutils literal"><span class="pre">--without-editline</span></tt> options.</p>
<p>Pure normally uses the system&#8217;s POSIX regex functions for its regular
expression support (<a class="reference internal" href="purelib.html#module-regex"><tt class="xref pure pure-mod docutils literal"><span class="pre">regex</span></tt></a> module). Instead, you can also build it with
support for Perl-style regular expressions. This is done by linking in the
POSIX compatibility layer of the PCRE library:</p>
<ul class="simple">
<li>PCRE: <a class="reference external" href="http://www.pcre.org/">http://www.pcre.org/</a></li>
</ul>
<p>Please note that the PCRE support is still experimental and currently disabled
by default. Configuring with <tt class="docutils literal"><span class="pre">--with-pcre</span></tt> enables it. Also note that at
present this is only available as a compile-time switch; to change the regex
library used by the Pure runtime you need to recompile the interpreter.</p>
<p><strong>Step 2.</strong> Get and unpack the latest LLVM sources.</p>
<p>You can find these at <a class="reference external" href="http://llvm.org/releases/download.html">http://llvm.org/releases/download.html</a>.</p>
<p>You only need the llvm-2.x or 3.x tarball which contains the LLVM library as
well as most of the LLVM toolchain. LLVM 3.4 is the latest stable release at
the time of this writing. LLVM versions 2.5 thru 3.4 have all been tested and
are known to work with Pure. We really recommend using LLVM 2.8 or later,
however, because LLVM has improved considerably in recent releases. (Support
for older versions may be dropped in the future.)</p>
<p>The latest LLVM from svn might work as well, but we don&#8217;t guarantee this.
While we&#8217;re committed to make Pure work with new LLVM versions as they become
available, we&#8217;re not able to track LLVM development in the trunk very closely.
So you might run into intermittent compilation problems, bugs and other
incompatibilities when going with the svn version.</p>
<p>At this point we also recommend getting an LLVM-capable C/C++ compiler. This
is completely optional, but you&#8217;ll need it to take advantage of the new
bitcode loader in Pure 0.44 and later. The easiest way to go is to take the
clang-2.x or 3.x tarball which corresponds to your LLVM version, unpack its
contents into the LLVM tools directory and rename the <tt class="docutils literal"><span class="pre">clang-x.y</span></tt> directory
to just <tt class="docutils literal"><span class="pre">clang</span></tt>. The clang compiler will then be built and installed along
with LLVM. You can also use llvm-gcc or dragonegg instead, please see
<a class="reference internal" href="#installing-an-llvm-capable-c-c-compiler">Installing an LLVM-capable C/C++ Compiler</a> below for further details.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some (older) Linux and BSD distributions provide LLVM packages and
ports which are compiled with wrong configure options and are thus broken.
If the Pure interpreter segfaults on startup or fails its test suite
(<tt class="docutils literal"><span class="pre">make</span> <span class="pre">check</span></tt>) then you should check whether there&#8217;s a newer LLVM package
available for your system, or compile LLVM yourself.</p>
</div>
<p><strong>Step 3.</strong> Configure, build and install LLVM as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>llvm-3.4
<span class="gp">$</span> ./configure --enable-shared --enable-optimized --enable-targets<span class="o">=</span>host-only
<span class="gp">$</span> make
<span class="gp">$</span> sudo make install
</pre></div>
</div>
<p>LLVM 2.7 and earlier may also require the flags <tt class="docutils literal"><span class="pre">--disable-assertions</span></tt>
<tt class="docutils literal"><span class="pre">--disable-expensive-checks</span></tt> to disable some features which make LLVM slow
and/or buggy on some systems. With LLVM 2.8 and later these options aren&#8217;t
needed any more.</p>
<p>Note that the <tt class="docutils literal"><span class="pre">--enable-shared</span></tt> option builds and installs LLVM as a shared
library, which is often preferable if you&#8217;re running different LLVM-based
tools and compilers on your system. This requires LLVM 2.7 or later and may be
broken on some systems. You can always leave out that option, in which case
LLVM will be linked statically into the Pure runtime library. (You can also
force Pure to be linked statically against LLVM even if you have the shared
LLVM library installed, by configuring Pure with the <tt class="docutils literal"><span class="pre">--with-static-llvm</span></tt>
flag. This may be useful if you plan to deploy the Pure runtime library on
systems which don&#8217;t have LLVM installed.)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">With LLVM 2.5, on x86-64 systems you have to add <tt class="docutils literal"><span class="pre">--enable-pic</span></tt> to
the configure command, so that the static LLVM libraries can be linked into
the Pure runtime library. (Do <em>not</em> add this option when compiling on a 32
bit system, it&#8217;s broken there.) With LLVM 2.6 and later this option isn&#8217;t
needed anymore. See the comments on 32/64 bit support in the <a class="reference internal" href="#system-notes">System
Notes</a> section below for details.</p>
</div>
<p>Also note that the configure flags are for an optimized (non-debug) build and
disable all compilation targets but the one for your system. You might wish to
play with the configure options, but note that some options (especially
<tt class="docutils literal"><span class="pre">--enable-expensive-checks</span></tt>) make LLVM very slow and may even break the Pure
interpreter on some systems.</p>
<p><strong>Step 4.</strong> Get and unpack the Pure sources.</p>
<p>These can be downloaded from <a class="reference external" href="http://purelang.bitbucket.org">http://purelang.bitbucket.org</a>. The latest
source tarballs can always be found under the &#8220;Featured Downloads&#8221; there.</p>
<p><strong>Step 5.</strong> Configure, build and install Pure as follows (<tt class="docutils literal"><span class="pre">x.y</span></tt> denotes the
current Pure version number):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>pure-x.y
<span class="gp">$</span> ./configure --enable-release
<span class="gp">$</span> make
<span class="gp">$</span> sudo make install
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">--enable-release</span></tt> option configures Pure for a release build. This is
recommended for maximum performance. If you leave away this option then you&#8217;ll
get a default build which includes debugging information and runtime checks
useful for the Pure maintainers, but also runs considerably slower.</p>
<p>To find out about other build options, you can invoke configure as
<tt class="docutils literal"><span class="pre">./configure</span> <span class="pre">--help</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">install</span></tt> command installs the pure program, the runtime.h
header file, the runtime library libpure.so, a Pure pkg-config file (pure.pc)
and the library scripts in the appropriate subdirectories of /usr/local; the
installation prefix can be changed with the <tt class="docutils literal"><span class="pre">--prefix</span></tt> configure option, see
<a class="reference internal" href="#other-build-and-installation-options">Other Build And Installation Options</a> for details. (The runtime.h header
file is not needed for normal operation, but can be used to write C/C++
extensions modules, if you need to access and manipulate Pure expressions from
C/C++.)</p>
<p>In addition, if the presence of GNU Emacs was detected at configure time, then
by default pure-mode.el and pure-mode.elc will be installed in the Emacs
site-lisp directory. make tries to guess the proper location of the site-lisp
directory, but if it guesses wrong or if you want to install in some custom
location then you can also set the <tt class="docutils literal"><span class="pre">elispdir</span></tt> make variable accordingly. If
you prefer, you can also disable the automatic installation of the elisp files
by running configure with <tt class="docutils literal"><span class="pre">./configure</span> <span class="pre">--without-elisp</span></tt>. (In that case, it&#8217;s
still possible to install the elisp files manually with <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install-el</span>
<span class="pre">install-elc</span></tt>.)</p>
<p>Similarly, if you have <a class="reference external" href="http://savannah.gnu.org/projects/texmacs/">GNU TeXmacs</a> on your system and configure can locate
it, the corresponding Pure plugin will be installed into the TeXmacs plugins
directory. make tries to guess the proper location of the TeXmacs plugins
directory, but if it guesses wrong or if you want to install in some custom
location then you can also set the <tt class="docutils literal"><span class="pre">tmdir</span></tt> make variable accordingly. If you
prefer, you can also disable the automatic installation of the TeXmacs plugin
by running configure with <tt class="docutils literal"><span class="pre">./configure</span> <span class="pre">--without-texmacs</span></tt>. (In that case, it&#8217;s
still possible to install the plugin manually with <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install-tm</span></tt>.)</p>
<p>On some systems you have to tell the dynamic linker to update its cache so
that it finds the Pure runtime library. E.g., on Linux this is done as
follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> sudo /sbin/ldconfig
</pre></div>
</div>
<p>After the build is complete, you can (and should) also run a few tests to
check that Pure is working correctly on your computer:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> make check
</pre></div>
</div>
<p>(This can be done before actually installing Pure, but make sure that you
first run <tt class="docutils literal"><span class="pre">ldconfig</span></tt> or similar if you installed LLVM as a shared library,
otherwise <tt class="docutils literal"><span class="pre">make</span> <span class="pre">check</span></tt> may fail simply because the LLVM library isn&#8217;t
found.)</p>
<p>If all is well, all tests should pass. If not, the test directory will contain
some <tt class="docutils literal"><span class="pre">*.diff</span></tt> files containing further information about the failed tests.
In that case please zip up the entire test directory and mail it to the
author, post it on the Pure mailing list, or enter a bug report at
<a class="reference external" href="https://bitbucket.org/purelang/pure-lang/issues">https://bitbucket.org/purelang/pure-lang/issues</a>. Also please include precise
information about your platform (operating system and cpu architecture) and
the Pure and LLVM versions and/or source revision numbers you&#8217;re running.</p>
<p>Note that <tt class="docutils literal"><span class="pre">make</span> <span class="pre">check</span></tt> executes the run-tests script which is generated at
configure time. If necessary, you can also run individual tests by running
run-tests directly (e.g., <tt class="docutils literal"><span class="pre">./run-tests</span> <span class="pre">test/test020.pure</span> <span class="pre">test/test047.pure</span></tt>)
or rerun only the tests that failed on the previous invocation (<tt class="docutils literal"><span class="pre">./run-tests</span>
<span class="pre">-f</span></tt> or, equivalently, <tt class="docutils literal"><span class="pre">make</span> <span class="pre">recheck</span></tt>).</p>
<p>Also note that MSYS 1.0.11 (or at least the diffutils package from that
version) is required to make <tt class="docutils literal"><span class="pre">make</span> <span class="pre">check</span></tt> work on Windows. Also, under MS
Windows this step is expected to fail on some math tests in test020.pure; this
is nothing to worry about, it just indicates that some math routines in
Microsoft&#8217;s C library aren&#8217;t fully POSIX-compatible. The same applies to BSD
systems.</p>
<p>If Pure appears to be broken on your system (<tt class="docutils literal"><span class="pre">make</span> <span class="pre">check</span></tt> reports a lot of
failures), it&#8217;s often because of a miscompiled LLVM. Please review the
instructions under step 3, and check the <a class="reference internal" href="#system-notes">System Notes</a> section to see
whether your platform is known to have issues and which workarounds may be
needed. If all that doesn&#8217;t help then you might be running into LLVM bugs and
limitations on not-so-well supported platforms; in that case please also
report the results of <tt class="docutils literal"><span class="pre">make</span> <span class="pre">check</span></tt> as described above, so that we can try to
figure out what is going on and whether there&#8217;s a fix or workaround for the
problem.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you have one of the LLVM C/C++ compilers installed (see
<a class="reference internal" href="#installing-an-llvm-capable-c-c-compiler">Installing an LLVM-capable C/C++ Compiler</a>), you can use those to compile
Pure by passing the appropriate compiler names on the configure line:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-release <span class="nv">CC</span><span class="o">=</span>clang <span class="nv">CXX</span><span class="o">=</span>clang++
</pre></div>
</div>
<p>Or, when using llvm-gcc:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-release <span class="nv">CC</span><span class="o">=</span>llvm-gcc <span class="nv">CXX</span><span class="o">=</span>llvm-g++
</pre></div>
</div>
<p class="last">llvm-gcc 4.2 and clang 2.8 or later should build Pure cleanly and pass all
checks.</p>
</div>
<p><strong>Step 6.</strong> Download and install the online documentation as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> sudo make install-docs
</pre></div>
</div>
<p>This isn&#8217;t necessary to run the interpreter, but highly recommended, as it
gives you a complete set of manuals in html format which covers the Pure
language and interpreter, the standard library, and all addon modules
available from the Pure website. You can read these manuals with the <tt class="docutils literal"><span class="pre">help</span></tt>
command in the interpreter. You also need to have a html browser installed to
make this work. By default, the interpreter assumes w3m (a text-based
browser), you can change this by setting the <tt class="docutils literal"><span class="pre">BROWSER</span></tt> or the <tt class="docutils literal"><span class="pre">PURE_HELP</span></tt>
variable accordingly.</p>
<p>The <tt class="docutils literal"><span class="pre">install-docs</span></tt> target requires a working Internet connection and the
wget command. Instead, you can also download the pure-docs-x.y.tar.gz tarball
manually and then install the documentation from the downloaded tarball in the
usual way (the x.y version number of the documentation tarball should
correspond to your interpreter version):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> tar xfvz pure-docs-x.y.tar.gz
<span class="gp">$</span> <span class="nb">cd </span>pure-docs-x.y
<span class="gp">$</span> sudo make install
</pre></div>
</div>
<p>As a bonus, downloading the package manually also gives you the documentation
in pdf format, so that you can print it if you like. In addition, as of
version 0.56 the tarball also contains the documentation in TeXmacs format so
that you can read it inside TeXmacs (see <a class="reference internal" href="#texmacs-plugin">TeXmacs Plugin</a> below). After
unpacking the tarball and installing the html documentation, you can install
the TeXmacs-formatted documentation as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> sudo make install-tm
</pre></div>
</div>
<p><strong>Step 7.</strong> The Pure interpreter should be ready to go now.</p>
<p>Run Pure interactively as:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> pure

<span class="go"> __ \  |   |  __| _ \    Pure 0.64 (x86_64-unknown-linux-gnu)</span>
<span class="go"> |   | |   | |    __/    Copyright (c) 2008-2014 by Albert Graef</span>
<span class="go"> .__/ \__,_|_|  \___|    (Type &#39;help&#39; for help, &#39;help copying&#39;</span>
<span class="go">_|                       for license information.)</span>

<span class="go">Loaded prelude from /usr/lib/pure/prelude.pure.</span>
</pre></div>
</div>
<p>Check that it works:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">&gt;</span> 6*7;
<span class="go">42</span>
</pre></div>
</div>
<p>Read the online documentation:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">&gt;</span> <span class="nb">help</span>
</pre></div>
</div>
<p>Exit the interpreter (you can also just type the end-of-file character at the
beginning of a line, i.e., <tt class="docutils literal"><span class="pre">Ctrl-D</span></tt> on Unix):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">&gt;</span> quit
</pre></div>
</div>
<p>You can also run the interpreter from GNU Emacs and GNU TeXmacs (see below),
and for Windows there is a nice GUI application named &#8220;PurePad&#8221; which makes it
easy to edit and run your Pure scripts.</p>
</div>
<div class="section" id="emacs-pure-mode">
<h2>Emacs Pure Mode<a class="headerlink" href="#emacs-pure-mode" title="Permalink to this headline">¶</a></h2>
<p>This step is optional, but if you&#8217;re friends with Emacs then you should
definitely give Pure mode a try. This is an Emacs programming mode which turns
Emacs into an advanced IDE to edit and run Pure programs. If Emacs was
detected by configure then after running <tt class="docutils literal"><span class="pre">make</span></tt> and <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">install</span></tt>
the required elisp files should already be installed in the Emacs site-lisp
directory (unless you specifically disabled this with the <tt class="docutils literal"><span class="pre">--without-elisp</span></tt>
configure option).</p>
<p>Note: make tries to guess the Emacs installation prefix. If it gets this
wrong, you can also set the make variable <tt class="docutils literal"><span class="pre">elispdir</span></tt> to point to your
site-lisp directory. (In fact, you can specify any directory on Emacs&#8217;
loadpath for <tt class="docutils literal"><span class="pre">elispdir</span></tt>.)</p>
<p>Before you can use Pure mode, you still have to add some stuff to your .emacs
file to load the mode at startup. A minimal setup looks like this:</p>
<div class="highlight-scheme"><div class="highlight"><pre><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;pure-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span> <span class="nv">auto-mode-alist</span>
      <span class="p">(</span><span class="nb">cons </span><span class="o">&#39;</span><span class="p">(</span><span class="s">&quot;\\.pure\\(rc\\)?$&quot;</span> <span class="o">.</span> <span class="nv">pure-mode</span><span class="p">)</span> <span class="nv">auto-mode-alist</span><span class="p">))</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">&#39;pure-mode-hook</span> <span class="ss">&#39;turn-on-font-lock</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">&#39;pure-eval-mode-hook</span> <span class="ss">&#39;turn-on-font-lock</span><span class="p">)</span>
</pre></div>
</div>
<p>This loads Pure mode, associates the .pure and .purerc filename extensions
with it, and enables syntax highlighting.</p>
<p>Other useful options are described at the beginning of the pure-mode.el
file. In particular, we recommend installing emacs-w3m and enabling it as
follows in your .emacs file, so that you can read the online documentation in
Emacs:</p>
<div class="highlight-scheme"><div class="highlight"><pre><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;w3m-load</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, you can enable code folding by adding this to your .emacs:</p>
<div class="highlight-scheme"><div class="highlight"><pre><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;hideshow</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span> <span class="ss">&#39;pure-mode-hook</span> <span class="ss">&#39;hs-minor-mode</span><span class="p">)</span>
</pre></div>
</div>
<p>These lines should come before the loading of Pure mode in your .emacs, so
that Pure mode can adjust accordingly.</p>
<p>Once Emacs has been configured to load Pure mode, you can just run it with a
Pure file to check that it works, e.g.:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> emacs examples/hello.pure
</pre></div>
</div>
<p>The online help about Pure mode can be read with <tt class="docutils literal"><span class="pre">C-h</span> <span class="pre">m</span></tt>. The Pure
documentation can be accessed in Pure mode with <tt class="docutils literal"><span class="pre">C-c</span> <span class="pre">h</span></tt>.</p>
</div>
<div class="section" id="texmacs-plugin">
<h2>TeXmacs Plugin<a class="headerlink" href="#texmacs-plugin" title="Permalink to this headline">¶</a></h2>
<p>Pure 0.56 has full support for running Pure as a session in <a class="reference external" href="http://savannah.gnu.org/projects/texmacs/">GNU TeXmacs</a>.
This is triggered by the <a class="reference internal" href="pure.html#cmdoption-pure--texmacs"><em class="xref std std-option">--texmacs</em></a> option of the interpreter. If
TeXmacs was detected by configure then after running <tt class="docutils literal"><span class="pre">make</span></tt> and <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">make</span>
<span class="pre">install</span></tt> the required plugin files should already be installed in the
system-wide TeXmacs plugins directory and you should be able to find Pure in
TeXmacs&#8217; Insert / Session and Document / Scripts menus. TeXmacs help is also
included; after installation this should be available with the Help / Plug-ins
/ Pure menu option. Or you can just go and read the TeXmacs documents (.tm
files) in texmacs/plugins/pure/doc included in the distribution.</p>
<p>Note: make tries to guess the TeXmacs installation prefix. If it gets this
wrong, you can also set the make variable <tt class="docutils literal"><span class="pre">tmdir</span></tt> to point to your TeXmacs
plugins directory. By default, the plugin files will be installed in the
plugins/pure subdirectory of your system-wide TeXmacs directory, usually
/usr/local/share/TeXmacs or similar. Removing the plugins/pure directory is
sufficient to uninstall the plugin; you can also do this with <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">make</span>
<span class="pre">uninstall-tm</span></tt>.</p>
<p>It&#8217;s also possible to disable the automatic installation by invoking configure
with the <tt class="docutils literal"><span class="pre">--without-texmacs</span></tt> option. To do a manual installation, it should
be sufficient to drop the texmacs/plugins/pure directory in the distribution
into your personal TeXmacs plugins folder, usually ~/.TeXmacs/plugins. You can
also do this with <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install-tm</span> <span class="pre">tmdir=~/.TeXmacs</span></tt> (in this case,
uninstall with <tt class="docutils literal"><span class="pre">make</span> <span class="pre">uninstall-tm</span> <span class="pre">tmdir=~/.TeXmacs</span></tt>). This has the advantage
that it doesn&#8217;t require root access and you can easily edit the plugin files
under ~/.TeXmacs/plugins/pure/progs afterwards to tailor them to your needs.</p>
<p>The distributed plugin has support for reading the Pure online help in TeXmacs
format. See Step 6 under <a class="reference internal" href="#basic-installation">Basic Installation</a> above for instructions on how
you can obtain the necessary TeXmacs files and install them in the Pure
library directory along with the html documentation. (The TeXmacs-formatted
documentation needs a little style file named puredoc.ts which is included in
the distribution and will be installed when doing <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span></tt> or <tt class="docutils literal"><span class="pre">make</span>
<span class="pre">install-tm</span></tt>. You can also just drop the file into your ~/.TeXmacs/packages
folder to make TeXmacs find it.)</p>
<p>If the distributed plugin doesn&#8217;t work for you, as a fallback option you can
try the following minimal setup instead. This lacks all the bells and whistles
of the distributed plugin, but should be sufficient to run a basic Pure
session in TeXmacs, and should hopefully work with any TeXmacs version which
has plugin support at all.</p>
<div class="highlight-scheme"><div class="highlight"><pre><span class="p">(</span><span class="nf">plugin-configure</span> <span class="nv">pure</span>
  <span class="p">(</span><span class="nf">:require</span> <span class="p">(</span><span class="nf">url-exists-in-path?</span> <span class="s">&quot;pure&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">:launch</span> <span class="s">&quot;pure -i --texmacs&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">:session</span> <span class="s">&quot;Pure&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>This Scheme file should go into ~/.TeXmacs/plugins/pure/progs/init-pure.scm.
Note that <em>both</em> the <tt class="docutils literal"><span class="pre">-i</span></tt> and <tt class="docutils literal"><span class="pre">--texmacs</span></tt> options are required in the
launch command to make this work (you might also want to add the <tt class="docutils literal"><span class="pre">-q</span></tt> option
to suppress the signon message of the interpreter).</p>
</div>
<div class="section" id="installing-an-llvm-capable-c-c-compiler">
<h2>Installing an LLVM-capable C/C++ Compiler<a class="headerlink" href="#installing-an-llvm-capable-c-c-compiler" title="Permalink to this headline">¶</a></h2>
<p>As already mentioned above, we suggest that you also install a C/C++ compiler
with an LLVM backend. Clang, llvm-gcc as well as the new dragonegg gcc plugin
are all fully supported by Pure. Pure can be used without this, but then
you&#8217;ll miss out on the LLVM bitcode loader and C/C++ inlining facilities in
Pure 0.44 and later. (However, you can always install clang, llvm-gcc and/or
dragonegg at a later time to enable these features.)</p>
<div class="section" id="clang">
<h3>clang<a class="headerlink" href="#clang" title="Permalink to this headline">¶</a></h3>
<p>With LLVM 2.8 and later, we recommend installing clang, the new LLVM-based
C/C++ compiler (<a class="reference external" href="http://clang.llvm.org/">http://clang.llvm.org/</a>). It&#8217;s much easier to build, runs
faster and has better diagnostics than gcc. Also, as of Pure 0.55 it is the
default for compiling inline C/C++ code, so it&#8217;s the easiest way to go if you
want to use that feature.</p>
<p>If you haven&#8217;t built clang along with LLVM yet, you can now just drop the
contents of the clang-x.y tarball into the <tt class="docutils literal"><span class="pre">llvm-x.y/tools</span></tt> directory,
renaming the resulting <tt class="docutils literal"><span class="pre">clang-x.y</span></tt> directory to just <tt class="docutils literal"><span class="pre">clang</span></tt>. Then build
and install clang as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>llvm-3.4/tools/clang
<span class="gp">$</span> make
<span class="gp">$</span> sudo make install
</pre></div>
</div>
</div>
<div class="section" id="llvm-gcc">
<h3>llvm-gcc<a class="headerlink" href="#llvm-gcc" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section applies to LLVM versions up to 2.9. With LLVM 3.0 or
later, llvm-gcc is not supported any more and you should use <a class="reference internal" href="#clang">clang</a> or
<a class="reference internal" href="#dragonegg">dragonegg</a> instead.</p>
</div>
<p>If available, llvm-gcc can be installed either as an alternative or in
addition to clang. The main advantage of llvm-gcc over clang is that it has
additional language frontends (Ada and Fortran).</p>
<p>Installing llvm-gcc from source actually isn&#8217;t all that difficult, if a bit
time-consuming. Assuming that you have unpacked both the LLVM and the llvm-gcc
sources in the same directory, you can build and install llvm-gcc as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>llvm-gcc-4.2-2.9.source
<span class="gp">$</span> mkdir obj
<span class="gp">$</span> <span class="nb">cd </span>obj
<span class="gp">$</span> ../configure --program-prefix<span class="o">=</span>llvm- --enable-llvm<span class="o">=</span><span class="nv">$PWD</span>/../../llvm-2.9 --enable-languages<span class="o">=</span>c,c++
<span class="gp">$</span> make
<span class="gp">$</span> sudo make install
</pre></div>
</div>
<p>(You might wish to add <tt class="docutils literal"><span class="pre">fortran</span></tt> to <tt class="docutils literal"><span class="pre">--enable-languages</span></tt> if you also want
to build the Fortran compiler, and, likewise, <tt class="docutils literal"><span class="pre">ada</span></tt> for the Ada compiler.)</p>
<p>Be patient, this takes a while.</p>
<p>Having installed llvm-gcc, you can add something like the following lines to
your shell startup files, so that Pure uses it for inlined C/C++/Fortran code:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">export PURE_CC=llvm-gcc</span>
<span class="go">export PURE_CXX=llvm-g++</span>
<span class="go">export PURE_FC=llvm-gfortran</span>
</pre></div>
</div>
</div>
<div class="section" id="dragonegg">
<h3>dragonegg<a class="headerlink" href="#dragonegg" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;re running LLVM 3.x, then instead of llvm-gcc you should use
&#8220;DragonEgg&#8221; (<a class="reference external" href="http://dragonegg.llvm.org/">http://dragonegg.llvm.org/</a>), the new LLVM backend for gcc &gt;=4.5.
This is provided in the form of a plugin which, if you have gcc 4.5 or later,
readily plugs into your existing system compiler.</p>
<p>If you already have a suitable gcc version, installing DragonEgg is a piece of
cake. First, make sure that you have the mpc and gcc plugin development files
installed (packages <tt class="docutils literal"><span class="pre">mpc-dev</span></tt> and <tt class="docutils literal"><span class="pre">gcc-plugin-dev</span></tt> on Ubuntu). Then, after
unpacking the dragonegg source tarball or downloading the svn sources, install
dragonegg as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> make
<span class="gp">$</span> sudo cp dragonegg.so <span class="sb">`</span>gcc -print-file-name<span class="o">=</span>plugin<span class="sb">`</span>
</pre></div>
</div>
<p>Finally, add something like the following lines to your shell startup files,
so that Pure uses gcc+dragonegg for all inlined C/C++/Fortran code:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">export PURE_CC=&quot;gcc -fplugin=dragonegg&quot;</span>
<span class="go">export PURE_CXX=&quot;g++ -fplugin=dragonegg&quot;</span>
<span class="go">export PURE_FC=&quot;gfortran -fplugin=dragonegg&quot;</span>
</pre></div>
</div>
<p>(Please also check the README file included in the dragonegg package for
further installation and usage instructions. Also, examples/bitcode/Makefile
in the Pure distribution demonstrates how to use gcc+dragonegg as an external
compiler to generate LLVM bitcode from the command line.)</p>
</div>
</div>
<div class="section" id="installing-from-development-sources">
<h2>Installing From Development Sources<a class="headerlink" href="#installing-from-development-sources" title="Permalink to this headline">¶</a></h2>
<p>The latest development version of Pure is available in its Git
source code repository. You can browse the repository at:</p>
<p><a class="reference external" href="https://bitbucket.org/purelang/pure-lang">https://bitbucket.org/purelang/pure-lang</a></p>
<p>(You&#8217;ll notice that the repository also contains various addon modules. See
the pure subdirectory for the latest sources of the Pure interpreter itself.)</p>
<p>Note that if you&#8217;re going with the development sources, you&#8217;ll also need
fairly recent versions of autoconf, flex and bison (autoconf 2.63, flex 2.5.31
and bison 2.3 should be ok).</p>
<p>To compile from the development sources, replace steps 4 and 5 above with:</p>
<p><strong>Step 4&#8217;.</strong> Fetch the latest sources from the repository:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> git clone https://bitbucket.org/purelang/pure-lang
</pre></div>
</div>
<p>This clones the repository and puts it into the pure-lang subdirectory in the
current directory. This step needs to be done only once; once you&#8217;ve cloned
the repository, you can update it to the latest revision at any time by
running <tt class="docutils literal"><span class="pre">git</span> <span class="pre">pull</span></tt>.</p>
<p><strong>Step 5&#8217;.</strong> Configure, build and install Pure.</p>
<p>This is pretty much the same as with the distribution tarball, except that you
need to run &#8216;autoreconf&#8217; once to generate the configure script which isn&#8217;t
included in the source repository.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>pure-lang/pure
<span class="gp">$</span> autoreconf
<span class="gp">$</span> ./configure --enable-release
<span class="gp">$</span> make
<span class="gp">$</span> sudo make install
</pre></div>
</div>
<p>(Don&#8217;t forget to also run <tt class="docutils literal"><span class="pre">make</span> <span class="pre">check</span></tt> to make sure that the interpreter is
in good working condition.)</p>
<p><strong>Step 6&#8217;.</strong> In addition, you can also build and install a recent snapshot of
the documentation from the repository.</p>
<p>You need to have a recent Sphinx version installed to do that; you can find
this at <a class="reference external" href="http://sphinx.pocoo.org/">http://sphinx.pocoo.org/</a>. Have a look at the Makefile in the
pure-lang/sphinx subdirectory or type <tt class="docutils literal"><span class="pre">make</span> <span class="pre">help</span></tt> there for instructions.</p>
<p>Alternatively, a ready-made recent snapshot of the documentation in html and
pdf formats is also available in its own repository, which can be cloned as
follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> git clone https://bitbucket.org/puredocs/puredocs.bitbucket.org.git
</pre></div>
</div>
</div>
<div class="section" id="other-build-and-installation-options">
<h2>Other Build and Installation Options<a class="headerlink" href="#other-build-and-installation-options" title="Permalink to this headline">¶</a></h2>
<p>The Pure configure script takes a few options which enable you to change the
installation path and control a number of other build options. Moreover, there
are some environment variables which also affect compilation and installation.</p>
<p>Use <tt class="docutils literal"><span class="pre">./configure</span> <span class="pre">--help</span></tt> to print a summary of the provided options.</p>
<div class="section" id="installation-path">
<h3>Installation Path<a class="headerlink" href="#installation-path" title="Permalink to this headline">¶</a></h3>
<p>By default, the pure program, the runtime.h header file, the runtime library,
the pure.pc file and the library scripts are installed in /usr/local/bin,
/usr/local/include/pure, /usr/local/lib, /usr/local/lib/pkg-config and
/usr/local/lib/pure, respectively. This can be changed by specifying the
desired installation prefix with the <tt class="docutils literal"><span class="pre">--prefix</span></tt> option, e.g.:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-release --prefix<span class="o">=</span>/usr
</pre></div>
</div>
<p>In addition, the <tt class="docutils literal"><span class="pre">DESTDIR</span></tt> variable enables package maintainers to install
Pure into a special &#8220;staging&#8221; directory, so that installed files can be
packaged more easily. If set at installation time, <tt class="docutils literal"><span class="pre">DESTDIR</span></tt> will be used as
an additional prefix to all installation paths. For instance, the following
command will put all installed files into the tmp-root subdirectory of the
current directory:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> make install <span class="nv">DESTDIR</span><span class="o">=</span>tmp-root
</pre></div>
</div>
<p>Note that if you install Pure into a non-standard location, you may have to
set <tt class="docutils literal"><span class="pre">LD_LIBRARY_PATH</span></tt> or a similar variable so that the dynamic linker finds
the Pure runtime library, libpure.so. Also, when compiling and linking addon
modules you might have to set <tt class="docutils literal"><span class="pre">C_INCLUDE_PATH</span></tt> and <tt class="docutils literal"><span class="pre">LIBRARY_PATH</span></tt> (or
similar) so that the header and library of the runtime library is found. (This
will become unnecessary once all addon modules have been converted to use
pkg-config, see below, but this isn&#8217;t the case right now.) On some systems
(notably, BSD) this is even necessary with the default prefix, because
/usr/local is not in the default search paths.</p>
<p>As of Pure 0.47, Pure also installs a pkg-config file which may be queried by
module Makefiles to determine how to build a module and link it against the
Pure runtime library; see <a class="reference internal" href="#pkg-config-support">Pkg-config Support</a> below. This file will usually
be installed into <tt class="docutils literal"><span class="pre">$(prefix)/lib/pkg-config</span></tt>. Again, if you use a
non-standard installation prefix, you will have to tell pkg-config about the
location of the file by adjusting the <tt class="docutils literal"><span class="pre">PKG_CONFIG_PATH</span></tt> environment variable
accordingly, see pkg-config(1) for details.</p>
</div>
<div class="section" id="tool-prefix-and-llvm-version">
<h3>Tool Prefix and LLVM Version<a class="headerlink" href="#tool-prefix-and-llvm-version" title="Permalink to this headline">¶</a></h3>
<p>On some systems the LLVM toolchain may be located in special directories not
on the <tt class="docutils literal"><span class="pre">PATH</span></tt>, so that different LLVM installations can coexist on the same
system. This is often the case, e.g., if LLVM was installed from a binary
package.</p>
<p>To deal with this situation, the configure script distributed with Pure 0.55
and later allows you to specify the directory with the LLVM toolchain using
the <tt class="docutils literal"><span class="pre">--with-tool-prefix</span></tt> configure option. E.g.:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --with-tool-prefix<span class="o">=</span>/usr/lib/llvm-3.4/bin
</pre></div>
</div>
<p>This is also the directory where configure will first look for the
<tt class="docutils literal"><span class="pre">llvm-config</span></tt> script, so that the proper LLVM version is selected for
compilation.</p>
<p>You can also specify the desired LLVM version with the <tt class="docutils literal"><span class="pre">--with-llvm-version</span></tt>
option. This causes configure to look for the <tt class="docutils literal"><span class="pre">llvm-config-x.y</span></tt> script on
the <tt class="docutils literal"><span class="pre">PATH</span></tt>, where <tt class="docutils literal"><span class="pre">x.y</span></tt> is the specified version number. If this option
isn&#8217;t specified, the default is to look for the <tt class="docutils literal"><span class="pre">llvm-config</span></tt> script on the
<tt class="docutils literal"><span class="pre">PATH</span></tt> (this should always work if you installed LLVM from source).</p>
<p>If none of these yield a usable <tt class="docutils literal"><span class="pre">llvm-config</span></tt> script, configure will try to
locate an <tt class="docutils literal"><span class="pre">llvm-config-x.y</span></tt> script by iterating through some recent LLVM
releases, preferring the latest version if found. If this fails, too,
configure gives up and prints an error message indicating that it couldn&#8217;t
locate a suitable LLVM installation. This is a fatal error, so if you see this
then you&#8217;ll either have to install LLVM yourself, or try to locate a suitable
LLVM installation and tell configure about it, using the options explained
above.</p>
</div>
<div class="section" id="versioned-installations">
<h3>Versioned Installations<a class="headerlink" href="#versioned-installations" title="Permalink to this headline">¶</a></h3>
<p>Beginning with version 0.4, Pure fully supports parallel installations of
different versions of the interpreter. As of Pure 0.21, to enable this you
have to specify <tt class="docutils literal"><span class="pre">--enable-versioned</span></tt> when running configure:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-release --enable-versioned
</pre></div>
</div>
<p>When this option is enabled, bin/pure, include/pure, lib/pure,
lib/pkg-config/pure.pc and man/man1/pure.1 are actually symbolic links to the
current version (bin/pure-x.y, include/pure-x.y etc., where x.y is the version
number). If you install a new version of the interpreter, the old version
remains available as pure-x.y.</p>
<p>Note that versioned and unversioned installations don&#8217;t mix very well, it&#8217;s
either one or the other. If you already have an unversioned install of Pure,
you must first remove it before switching to the versioned scheme.</p>
<p>It <em>is</em> possible, however, to have versioned and unversioned installations
under different installation prefixes. For instance, having an unversioned
install under /usr and several versioned installations under /usr/local is ok.</p>
</div>
<div class="section" id="separate-build-directory">
<h3>Separate Build Directory<a class="headerlink" href="#separate-build-directory" title="Permalink to this headline">¶</a></h3>
<p>It is possible to build Pure in a separate directory, in order to keep your
source tree tidy and clean, or to build multiple versions of the interpreter
with different compilation flags from the same source tree.</p>
<p>To these ends, just cd to the build directory and run configure and make
there, e.g. (this assumes that you start from the source directory):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> mkdir BUILD
<span class="gp">$</span> <span class="nb">cd </span>BUILD
<span class="gp">$</span> ../configure --enable-release
<span class="gp">$</span> make
</pre></div>
</div>
</div>
<div class="section" id="compiler-and-linker-options">
<h3>Compiler and Linker Options<a class="headerlink" href="#compiler-and-linker-options" title="Permalink to this headline">¶</a></h3>
<p>There are a number of environment variables you can set on the configure
command line if you need special compiler or linker options:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">CPPFLAGS</span></tt>: preprocessor options (<tt class="docutils literal"><span class="pre">-I</span></tt>, <tt class="docutils literal"><span class="pre">-D</span></tt>, etc.)</li>
<li><tt class="docutils literal"><span class="pre">CXXFLAGS</span></tt>: C++ compilation options (<tt class="docutils literal"><span class="pre">-g</span></tt>, <tt class="docutils literal"><span class="pre">-O</span></tt>, etc.)</li>
<li><tt class="docutils literal"><span class="pre">CFLAGS</span></tt>:   C compilation options (<tt class="docutils literal"><span class="pre">-g</span></tt>, <tt class="docutils literal"><span class="pre">-O</span></tt>, etc.)</li>
<li><tt class="docutils literal"><span class="pre">LDFLAGS</span></tt>:  linker flags (<tt class="docutils literal"><span class="pre">-s</span></tt>, <tt class="docutils literal"><span class="pre">-L</span></tt>, etc.)</li>
<li><tt class="docutils literal"><span class="pre">LIBS</span></tt>:     additional objects and libraries (<tt class="docutils literal"><span class="pre">-lfoo</span></tt>, <tt class="docutils literal"><span class="pre">bar.o</span></tt>, etc.)</li>
</ul>
<p>(The <tt class="docutils literal"><span class="pre">CFLAGS</span></tt> variable is only used to build the pure_main.o module which is
linked into batch-compiled executables, see &#8220;Batch Compilation&#8221; in the manual
for details.)</p>
<p>For instance, the following configure command changes the default compilation
options to <tt class="docutils literal"><span class="pre">-g</span></tt> and adds /opt/include and /opt/lib to the include and
library search paths, respectively:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure <span class="nv">CPPFLAGS</span><span class="o">=</span>-I/opt/include <span class="nv">CXXFLAGS</span><span class="o">=</span>-g <span class="nv">LDFLAGS</span><span class="o">=</span>-L/opt/lib
</pre></div>
</div>
<p>More details on the build and installation process and other available targets
and options can be found in the Makefile.</p>
</div>
<div class="section" id="predefined-build-types">
<h3>Predefined Build Types<a class="headerlink" href="#predefined-build-types" title="Permalink to this headline">¶</a></h3>
<p>For convenience, configure provides some options to set up <tt class="docutils literal"><span class="pre">CPPFLAGS</span></tt> and
<tt class="docutils literal"><span class="pre">CXXFLAGS</span></tt> for various build types. Please note that most of these options
assume gcc right now, so if you use another compiler you&#8217;ll probably have to
set up compilation flags manually by using the variables described in the
previous section instead.</p>
<p>The default build includes debugging information and additional runtime checks
which provide diagnostics useful for maintainers if anything is wrong with the
interpreter. It is also noticeably slower than the &#8220;release&#8221; build. If you
want to enjoy maximum performance, you should configure Pure for a release
build as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-release
</pre></div>
</div>
<p>This disables all runtime checks and debugging information in the interpreter,
and uses a higher optimization level (<tt class="docutils literal"><span class="pre">-O3</span></tt>), making the interpreter go
substantially faster on most systems.</p>
<p>To get smaller executables with either the default or the release build, add
<tt class="docutils literal"><span class="pre">LDFLAGS=-s</span></tt> to the configure command (gcc only, other compilers may provide
a similar flag or a separate command to strip compiled executables and
libraries).</p>
<p>You can also do a &#8220;debug&#8221; build as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-debug
</pre></div>
</div>
<p>This is like the default build, but disables all optimizations, so compilation
is faster but the compiled interpreter is <em>much</em> slower than even the default
build. Hence this build is only recommended for debugging purposes.</p>
<p>You can combine all build types with the <tt class="docutils literal"><span class="pre">--enable-warnings</span></tt> option to
enable compiler warnings (<tt class="docutils literal"><span class="pre">-Wall</span></tt>):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-release --enable-warnings
</pre></div>
</div>
<p>This option is useful to check the interpreter sources for questionable
constructs which might actually be bugs. However, for some older gcc versions
it spits out lots of bogus warnings, so it is not enabled by default.</p>
<p>In addition, there is an option to build a &#8220;monolithic&#8221; interpreter which is
linked statically instead of producing a separate runtime library:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-release --disable-shared
</pre></div>
</div>
<p>We strongly discourage from using this option, since it drastically increases
the size of the executable and thereby the memory footprint of the interpreter
if several interpreter processes are running simultaneously. It also makes it
impossible to use batch compilation and addon modules which require the
runtime library. We only provide this as a workaround for older LLVM versions
which cannot be linked into shared libraries on some systems.</p>
<p>In general, the build options can be combined freely with the variables
described in the previous section, except that <tt class="docutils literal"><span class="pre">--enable-release</span></tt> and
<tt class="docutils literal"><span class="pre">--enable-debug</span></tt> will always override the debugging (<tt class="docutils literal"><span class="pre">-g</span></tt>) and
optimization (<tt class="docutils literal"><span class="pre">-O</span></tt>) options in <tt class="docutils literal"><span class="pre">CFLAGS</span></tt> and <tt class="docutils literal"><span class="pre">CXXFLAGS</span></tt>. Other options
will be preserved. For instance, the following configures for a release build,
but sets the warning flags manually and enables C++0x support in gcc:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./configure --enable-release <span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">&quot;-Wall&quot;</span> <span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">&quot;-std=c++0x -Wall&quot;</span>
</pre></div>
</div>
<p>If you mix build types and manual compilation flags in this way then it&#8217;s
always a good idea to check the resulting compilation options printed out at
the end of the <tt class="docutils literal"><span class="pre">configure</span></tt> run. If <tt class="docutils literal"><span class="pre">configure</span></tt> seems to get things wrong
then you&#8217;ll have to set up all required flags manually instead.</p>
</div>
<div class="section" id="running-pure-from-the-source-directory">
<h3>Running Pure From The Source Directory<a class="headerlink" href="#running-pure-from-the-source-directory" title="Permalink to this headline">¶</a></h3>
<p>After your build is done, you should also run <tt class="docutils literal"><span class="pre">make</span> <span class="pre">check</span></tt> to verify that
your Pure interpreter works correctly. This can be done without installing the
software. In fact, there&#8217;s no need to install the interpreter at all if you
just want to take it for a test drive, you can simply run it from the source
directory, if you set up the following environment variables (this assumes
that you built Pure in the source directory; when using a separate build
directory, you&#8217;ll have to change the paths accordingly):</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">LD_LIBRARY_PATH=.</span></tt></dt>
<dd>This is required on Linux systems so that libpure.so is found. Other systems
may require an analogous setting, or none at all.</dd>
<dt><tt class="docutils literal"><span class="pre">PURELIB=./lib</span></tt></dt>
<dd>This is required on all systems so that the interpreter finds the prelude
and other library scripts.</dd>
</dl>
<p>After that you should be able to run the Pure interpreter from the source
directory, by typing <tt class="docutils literal"><span class="pre">./pure</span></tt>.</p>
</div>
<div class="section" id="other-targets">
<h3>Other Targets<a class="headerlink" href="#other-targets" title="Permalink to this headline">¶</a></h3>
<p>The Makefile supports the usual <tt class="docutils literal"><span class="pre">clean</span></tt> and <tt class="docutils literal"><span class="pre">distclean</span></tt> targets, and
<tt class="docutils literal"><span class="pre">realclean</span></tt> will remove all files created by the maintainer, including test
logs and C++ source files generated from Flex and Bison grammars. (Only use
the latter if you know what you are doing, since it will remove files which
require special tools to be regenerated.)</p>
<p>Maintainers can roll distribution tarballs with <tt class="docutils literal"><span class="pre">make</span> <span class="pre">dist</span></tt> and <tt class="docutils literal"><span class="pre">make</span>
<span class="pre">distcheck</span></tt> (the latter is like <tt class="docutils literal"><span class="pre">make</span> <span class="pre">dist</span></tt>, but also does a test build and
installation to verify that your tarball contains all needed bits and pieces).</p>
<p>Last but not least, if you modify configure.ac for some reason then you can
regenerate the configure script and config.h.in with <tt class="docutils literal"><span class="pre">make</span> <span class="pre">config</span></tt>. This
needs autoconf, of course. (The distribution was prepared using autoconf
2.68.)</p>
</div>
<div class="section" id="pkg-config-support">
<h3>Pkg-config Support<a class="headerlink" href="#pkg-config-support" title="Permalink to this headline">¶</a></h3>
<p>Pure 0.47 and later install a pkg-config file (pure.pc) which lets addon
modules query the installed Pure for the information needed to build and
install a module. Besides the usual information provided by pkg-config, such
as <tt class="docutils literal"><span class="pre">--cflags</span></tt> and <tt class="docutils literal"><span class="pre">--libs</span></tt> (which are set up so that the Pure runtime
header and library will be found), pure.pc also defines a few additional
variables which can be queried with pkg-config&#8217;s <tt class="docutils literal"><span class="pre">--variable</span></tt> option:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">DLL</span></tt>: shared library extension for the host platform</li>
<li><tt class="docutils literal"><span class="pre">PIC</span></tt>: position-independent code flag if required on the host platform</li>
<li><tt class="docutils literal"><span class="pre">shared</span></tt>: flag used to create shared libraries on the host platform</li>
<li><tt class="docutils literal"><span class="pre">extraflags</span></tt>: same as <tt class="docutils literal"><span class="pre">$shared</span> <span class="pre">$PIC</span></tt></li>
</ul>
<p>Together with the <tt class="docutils literal"><span class="pre">libdir</span></tt> variable, this provides you with the information
needed to build and install most Pure modules without much ado. As of Pure
0.55, pure.pc also defines the <tt class="docutils literal"><span class="pre">tool_prefix</span></tt> variable which gives the LLVM
toolchain prefix specified at configure time, cf. <a class="reference internal" href="#tool-prefix-and-llvm-version">Tool Prefix and LLVM
Version</a>.</p>
<p>If you want to use this information, you need to have pkg-config installed,
see <a class="reference external" href="http://pkg-config.freedesktop.org">http://pkg-config.freedesktop.org</a>. This program should be readily
available on most Unix-like platforms, and a Windows version is available as
well. An example illustrating the use of pkg-config can be found in the
examples/hellomod directory in the sources.</p>
</div>
</div>
<div class="section" id="system-notes">
<h2>System Notes<a class="headerlink" href="#system-notes" title="Permalink to this headline">¶</a></h2>
<p>Pure is known to work on recent Linux, Mac OS X and BSD versions under x86,
x86-64 (AMD/Intel x86, 32 and 64 bit) and ppc (PowerPC), as well as on MS
Windows (AMD/Intel x86, 32 bit). There are a few known quirks for specific
platforms and/or LLVM versions which are discussed below, along with
corresponding workarounds.</p>
<div class="section" id="all-platforms">
<h3>All Platforms<a class="headerlink" href="#all-platforms" title="Permalink to this headline">¶</a></h3>
<p>Compiling the default and release versions using gcc with all warnings turned
on (<tt class="docutils literal"><span class="pre">-Wall</span></tt>) might give you the warning &#8220;dereferencing type-punned pointer
will break strict-aliasing rules&#8221; at some point in util.cc with some gcc
versions. This is harmless and can be ignored.</p>
<p>If your Pure program runs out of stack space, the interpreter may segfault.
While the Pure interpreter does advisory stack checks to avoid that kind of
mishap and generate an orderly exception instead, it has no way of knowing the
actual stack size available to programs on your system. So if you&#8217;re getting
segfaults due to stack overflows then you&#8217;ll have to set an appropriate stack
size limit manually with the <span class="target" id="index-0"></span><a class="reference internal" href="pure.html#envvar-PURE_STACK"><tt class="xref std std-envvar docutils literal"><span class="pre">PURE_STACK</span></tt></a> environment variable; see
the Pure manual for details.</p>
</div>
<div class="section" id="llvm-2-5">
<h3>LLVM 2.5<a class="headerlink" href="#llvm-2-5" title="Permalink to this headline">¶</a></h3>
<p>The LLVM 2.5 JIT is broken on x86-32 if it is built with <tt class="docutils literal"><span class="pre">--enable-pic</span></tt>, so
make sure you do <em>not</em> use this option when compiling LLVM &lt;=2.5 on 32 bit
systems. Some older LLVM 2.5 packages for Linux are broken on x86-32 for this
reason (this has been reported for Ubuntu 9.04 and Fedora Core 10), the
symptom being that the Pure interpreter fails a lot of checks and/or segfaults
right at startup. In that case you&#8217;ll have to find a newer, corrected package
or build your own LLVM from source instead.</p>
<p>On the other hand, building the Pure runtime library (libpure) on x86-64
systems <em>requires</em> that you configure LLVM 2.5 with <tt class="docutils literal"><span class="pre">--enable-pic</span></tt> so that
the static LLVM libraries can be linked into the runtime library. With LLVM
2.6 and later, this option isn&#8217;t needed anymore.</p>
<p>This LLVM version also has issues on PowerPC. Use LLVM 2.6 or later instead
and check the notes on <a class="reference internal" href="#powerpc">PowerPC</a> below.</p>
<p>Please also note that LLVM 2.5 is the oldest LLVM version that we still
support right now. If you&#8217;re still running this version (or any of the 2.x
versions) then you should really upgrade. Newer LLVM versions offer
substantial improvements in both compilation time and code quality. Support
for LLVM versions older than 3.0 is likely to be dropped in future Pure
releases.</p>
</div>
<div class="section" id="llvm-3-3">
<h3>LLVM 3.3<a class="headerlink" href="#llvm-3-3" title="Permalink to this headline">¶</a></h3>
<p>Reportedly the Pure batch compiler is broken when using LLVM 3.3 on Mac OS X.
If you need the batch compiler then use either LLVM 3.2 or 3.4+ on OS X
instead, these are known to work on that platform.</p>
</div>
<div class="section" id="llvm-3-4">
<h3>LLVM 3.4+<a class="headerlink" href="#llvm-3-4" title="Permalink to this headline">¶</a></h3>
<p>On Linux, the <tt class="docutils literal"><span class="pre">llc</span></tt> program from LLVM 3.4 and 3.5 is known to create native
assembler (.s) code which doesn&#8217;t mangle assembler symbols as it used to be in
earlier releases. When compiling Pure modules with the batch compiler, this
results in native assembler code which can&#8217;t be compiled using the system
assemblers. As a remedy, the batch compiler in Pure 0.61 and later now creates
native object (.o) files directly using llc, without going through the native
assembler stage.</p>
</div>
<div class="section" id="powerpc">
<h3>PowerPC<a class="headerlink" href="#powerpc" title="Permalink to this headline">¶</a></h3>
<p>You&#8217;ll need Pure &gt;= 0.35 and LLVM &gt;= 2.6. Also make sure that you always
configure LLVM with <tt class="docutils literal"><span class="pre">--disable-expensive-checks</span></tt> and Pure with
<tt class="docutils literal"><span class="pre">--disable-fastcc</span></tt>. With these settings Pure should work fine on ppc (tested
on ppc32 running Fedora Core 11 and 12), but note that tail call optimization
doesn&#8217;t work on this platform right now because of LLVM limitations.</p>
</div>
<div class="section" id="linux">
<h3>Linux<a class="headerlink" href="#linux" title="Permalink to this headline">¶</a></h3>
<p>Linux is the primary development platform for this software, and the sources
should build out of the box on all recent Linux distributions. Packages for
various Linux distributions are also available, please check the Pure website
for details.</p>
</div>
<div class="section" id="mac-os-x">
<h3>Mac OS X<a class="headerlink" href="#mac-os-x" title="Permalink to this headline">¶</a></h3>
<p>Pure should build fine on recent OS X versions, and a port by Ryan Schmidt
exists in the MacPorts collection, see <a class="reference external" href="http://www.macports.org/">http://www.macports.org/</a>. If you
install straight from the source, make sure that you use a recent LLVM version
(LLVM 2.7 or later should work fine on all flavours of Intel Macs).</p>
<p>Even if you compile Pure from source, we recommend installing LLVM and the
other dependencies from MacPorts. In that case you&#8217;ll have to add a few
options to the configure command so that the required header files, libraries
and LLVM tools are found:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">./configure --enable-release --prefix=/opt/local \</span>
<span class="go">CPPFLAGS=-I/opt/local/include LDFLAGS=-L/opt/local/lib \</span>
<span class="go">--with-tool-prefix=/opt/local/libexec/llvm-3.4/bin</span>
</pre></div>
</div>
<p>This assumes that your MacPorts installation lives under /opt/local and that
you&#8217;re using LLVM 3.4; otherwise you&#8217;ll have to adjust the configure options
accordingly.</p>
<p>On really old Macs from the bygone PPC era you&#8217;ll have to be prepared to deal
with all kinds of issues with compilers, LLVM toolchain etc. If you&#8217;re still
using one of these, your best bet is to find a port on MacPorts which works
for your OS X version.</p>
</div>
<div class="section" id="bsd">
<h3>BSD<a class="headerlink" href="#bsd" title="Permalink to this headline">¶</a></h3>
<p>FreeBSD now offers a fairly extensive selection of Pure packages in their
distribution.</p>
<p>Compilation from source should also work fine on recent NetBSD and FreeBSD
versions if you use Pure 0.33 or later. Also make sure that you install a
recent port of LLVM which has the <tt class="docutils literal"><span class="pre">--enable-optimized</span></tt> flag enabled.</p>
<p>Building Pure requires GNU make, thus you will have to use gmake instead of
make. In addition to gmake, you&#8217;ll need recent versions of the following
packages: perl5, flex, bison, gmp, mpfr and readline (or editline). Depending
on your system, you might also have to set up some compiler and linker paths.
E.g., the following reportedly does the trick on NetBSD:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">export C_INCLUDE_PATH=/usr/local/include:/usr/pkg/include</span>
<span class="go">export LIBRARY_PATH=/usr/local/lib:/usr/pkg/lib</span>
<span class="go">export LD_LIBRARY_PATH=/usr/pkg/lib:/usr/local/lib</span>
</pre></div>
</div>
</div>
<div class="section" id="ms-windows">
<h3>MS Windows<a class="headerlink" href="#ms-windows" title="Permalink to this headline">¶</a></h3>
<p>Thanks to Jiri Spitz&#8217; perseverance, tireless testing and bug reports, the
sources compile and run fine on Windows, using the Mingw port of the GNU C++
compiler and the MSYS environment from <a class="reference external" href="http://www.mingw.org/">http://www.mingw.org/</a>. Just do the
usual <tt class="docutils literal"><span class="pre">./configure</span> <span class="pre">&amp;&amp;</span> <span class="pre">make</span> <span class="pre">&amp;&amp;</span> <span class="pre">make</span> <span class="pre">install</span></tt>. You&#8217;ll need LLVM, of course
(which builds with Mingw just fine), and a few additional libraries for which
headers and precompiled binaries are available from the Pure website
(<a class="reference external" href="http://purelang.bitbucket.org">http://purelang.bitbucket.org</a>).</p>
<p>However, the easiest way is to just go with the Pure MSI package available on
the Pure website. This includes all required libraries and some shortcuts to
run the Pure interpreter and read online documentation in html help format, as
well as &#8220;PurePad&#8221;, an alternative GUI frontend for editing and running Pure
scripts on Windows.</p>
<p>After installing the MSI, you might also want to go to the LLVM website and
grab the LLVM toolchain for mingw32/x86. It is sufficient to install the &#8220;LLVM
binaries&#8221; package on your system to make the Pure batch compiler work. Just
unzip these into some convenient location on your harddrive and set up
<tt class="docutils literal"><span class="pre">PATH</span></tt> so that it points to the llvm-x.y directory.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installing Pure (and LLVM)</a><ul>
<li><a class="reference internal" href="#quick-summary">Quick Summary</a></li>
<li><a class="reference internal" href="#basic-installation">Basic Installation</a></li>
<li><a class="reference internal" href="#emacs-pure-mode">Emacs Pure Mode</a></li>
<li><a class="reference internal" href="#texmacs-plugin">TeXmacs Plugin</a></li>
<li><a class="reference internal" href="#installing-an-llvm-capable-c-c-compiler">Installing an LLVM-capable C/C++ Compiler</a><ul>
<li><a class="reference internal" href="#clang">clang</a></li>
<li><a class="reference internal" href="#llvm-gcc">llvm-gcc</a></li>
<li><a class="reference internal" href="#dragonegg">dragonegg</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-from-development-sources">Installing From Development Sources</a></li>
<li><a class="reference internal" href="#other-build-and-installation-options">Other Build and Installation Options</a><ul>
<li><a class="reference internal" href="#installation-path">Installation Path</a></li>
<li><a class="reference internal" href="#tool-prefix-and-llvm-version">Tool Prefix and LLVM Version</a></li>
<li><a class="reference internal" href="#versioned-installations">Versioned Installations</a></li>
<li><a class="reference internal" href="#separate-build-directory">Separate Build Directory</a></li>
<li><a class="reference internal" href="#compiler-and-linker-options">Compiler and Linker Options</a></li>
<li><a class="reference internal" href="#predefined-build-types">Predefined Build Types</a></li>
<li><a class="reference internal" href="#running-pure-from-the-source-directory">Running Pure From The Source Directory</a></li>
<li><a class="reference internal" href="#other-targets">Other Targets</a></li>
<li><a class="reference internal" href="#pkg-config-support">Pkg-config Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#system-notes">System Notes</a><ul>
<li><a class="reference internal" href="#all-platforms">All Platforms</a></li>
<li><a class="reference internal" href="#llvm-2-5">LLVM 2.5</a></li>
<li><a class="reference internal" href="#llvm-3-3">LLVM 3.3</a></li>
<li><a class="reference internal" href="#llvm-3-4">LLVM 3.4+</a></li>
<li><a class="reference internal" href="#powerpc">PowerPC</a></li>
<li><a class="reference internal" href="#linux">Linux</a></li>
<li><a class="reference internal" href="#mac-os-x">Mac OS X</a></li>
<li><a class="reference internal" href="#bsd">BSD</a></li>
<li><a class="reference internal" href="#ms-windows">MS Windows</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pure-midi.html"
                        title="previous chapter">pure-midi</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="windows.html"
                        title="next chapter">Running Pure on Windows</a></p>
<h3>This Page</h3>
<ul class="this-page-menu">
  <li><a href="bugs.html">Report a Bug</a></li>
  <li><a href="_sources/install.txt"
         rel="nofollow">Show Source</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pure-modindex.html" title="Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="windows.html" title="Running Pure on Windows"
             >next</a> |</li>
        <li class="right" >
          <a href="pure-midi.html" title="pure-midi"
             >previous</a> |</li>
        <li><a href="index.html">Pure Language and Library Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
    &copy; Copyright 2009-2016, Albert Gräf et al.
    Last updated on Jul 07, 2016.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>

  </body>
</html>