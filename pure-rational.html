

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Pure-Rational - Rational number library for the Pure programming language &mdash; Pure Language and Library Documentation</title>
    
    <link rel="stylesheet" href="_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.66',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="Pure Language and Library Documentation" href="index.html" />
    <link rel="next" title="Computer Algebra with Pure: A Reduce Interface" href="pure-reduce.html" />
    <link rel="prev" title="pure-octave" href="pure-octave.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pure-modindex.html" title="Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pure-reduce.html" title="Computer Algebra with Pure: A Reduce Interface"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pure-octave.html" title="pure-octave"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Pure Language and Library Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pure-rational-rational-number-library-for-the-pure-programming-language">
<h1>Pure-Rational - Rational number library for the Pure programming language<a class="headerlink" href="#pure-rational-rational-number-library-for-the-pure-programming-language" title="Permalink to this headline">¶</a></h1>
<p>Version 0.1, March 01, 2018</p>
<div class="line-block">
<div class="line">Rob Hubbard</div>
<div class="line">Albert Graef &lt;<a class="reference external" href="mailto:aggraef&#37;&#52;&#48;gmail&#46;com">aggraef<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</div>
<div class="line">Jiri Spitz &lt;<a class="reference external" href="mailto:jiri&#46;spitz&#37;&#52;&#48;bluetone&#46;cz">jiri<span>&#46;</span>spitz<span>&#64;</span>bluetone<span>&#46;</span>cz</a>&gt;</div>
</div>
<p>This package provides a Pure port of <a class="reference external" href="http://q-lang.sourceforge.net/addons.html">Q+Q</a>, Rob Hubbard&#8217;s rational number
library for the Q programming language. The port was done by Jiri Spitz. It
contains <tt class="docutils literal"><span class="pre">rational.pure</span></tt>, a collection of utility functions for rational
numbers, and <tt class="docutils literal"><span class="pre">rat_interval.pure</span></tt>, a module for doing interval arithmetic
needed by <tt class="docutils literal"><span class="pre">rational.pure</span></tt>. These modules are designed to work with the
<tt class="docutils literal"><span class="pre">math.pure</span></tt> module (part of the standard Pure library), which contains the
definition of Pure&#8217;s rational type and implements the basic rational
arithmetic.</p>
<p>This document is an edited version of Rob&#8217;s original <a class="reference external" href="http://downloads.sourceforge.net/q-lang/rational.pdf?download">Q+Q manual</a> available
from the Q website, slightly adjusted to account for the Pure specifics of the
implementation. In particular, note that the operations provided by
<tt class="docutils literal"><span class="pre">rational.pure</span></tt> and <tt class="docutils literal"><span class="pre">rat_interval.pure</span></tt> live in their own <tt class="docutils literal"><span class="pre">rational</span></tt> and
<tt class="docutils literal"><span class="pre">interval</span></tt> namespaces, respectively, so if you want to get unqualified
access to the symbols of these modules (as the examples in this manual assume)
then you&#8217;ll have to import the modules as follows:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="kr">using</span> rational, rat_interval<span class="p">;</span>
<span class="kr">using</span> <span class="kr">namespace</span> rational, interval<span class="p">;</span>
</pre></div>
</div>
<p>Also note that <a class="reference internal" href="#module-rational"><tt class="xref pure pure-mod docutils literal"><span class="pre">rational</span></tt></a> always pulls in the <a class="reference internal" href="purelib.html#module-math"><tt class="xref pure pure-mod docutils literal"><span class="pre">math</span></tt></a> module, so you
don&#8217;t have to import the latter explicitly if you are using <a class="reference internal" href="#module-rational"><tt class="xref pure pure-mod docutils literal"><span class="pre">rational</span></tt></a>.</p>
<p>Another minor difference to the Q version of this module is that rational
results always have Pure bigints as their numerators and denominators, hence
the <tt class="docutils literal"><span class="pre">L</span></tt> suffix in the printed results. Also, unary minus binds weaker in
Pure than the rational division operator, so a negative rational number will
be printed as, e.g., <tt class="docutils literal"><span class="pre">(-1L)%2L</span></tt>, which looks a bit funny but is correct
since Pure rationals always carry their sign in the numerator.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#copying" id="id2">Copying</a></li>
<li><a class="reference internal" href="#installation" id="id3">Installation</a></li>
<li><a class="reference internal" href="#introduction" id="id4">Introduction</a><ul>
<li><a class="reference internal" href="#module-rational" id="id5">The Rational Module</a></li>
<li><a class="reference internal" href="#the-files-and-the-default-prelude" id="id6">The Files and the Default Prelude</a><ul>
<li><a class="reference internal" href="#math-pure-and-other-files" id="id7">math.pure and Other Files</a></li>
<li><a class="reference internal" href="#rational-pure" id="id8">rational.pure</a></li>
<li><a class="reference internal" href="#rat-interval-pure" id="id9">rat_interval.pure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notation" id="id10">Notation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-rational-type" id="id11">The Rational Type</a><ul>
<li><a class="reference internal" href="#constructors" id="id12">Constructors</a></li>
<li><a class="reference internal" href="#deconstructors" id="id13">&#8216;Deconstructors&#8217;</a></li>
<li><a class="reference internal" href="#type-and-value-tests" id="id14">Type and Value Tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#arithmetic" id="id15">Arithmetic</a><ul>
<li><a class="reference internal" href="#operators" id="id16">Operators</a></li>
<li><a class="reference internal" href="#more-on-division" id="id17">More on Division</a></li>
<li><a class="reference internal" href="#relations-equality-and-inequality-tests" id="id18">Relations — Equality and Inequality Tests</a></li>
<li><a class="reference internal" href="#comparison-function" id="id19">Comparison Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mathematical-functions" id="id20">Mathematical Functions</a><ul>
<li><a class="reference internal" href="#absolute-value-and-sign" id="id21">Absolute Value and Sign</a></li>
<li><a class="reference internal" href="#greatest-common-divisor-gcd-and-least-common-multiple-lcm" id="id22">Greatest Common Divisor (GCD) and Least Common Multiple (LCM)</a></li>
<li><a class="reference internal" href="#extrema-minima-and-maxima" id="id23">Extrema (Minima and Maxima)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#special-rational-functions" id="id24">Special Rational Functions</a><ul>
<li><a class="reference internal" href="#complexity" id="id25">Complexity</a><ul>
<li><a class="reference internal" href="#complexity-relations" id="id26">Complexity Relations</a></li>
<li><a class="reference internal" href="#complexity-comparison-function" id="id27">Complexity Comparison Function</a></li>
<li><a class="reference internal" href="#complexity-extrema" id="id28">Complexity Extrema</a></li>
<li><a class="reference internal" href="#other-complexity-functions" id="id29">Other Complexity Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mediants-and-farey-sequences" id="id30">Mediants and Farey Sequences</a></li>
<li><a class="reference internal" href="#rational-type-simplification" id="id31">Rational Type Simplification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-z-rounding" id="id32"><strong>Q</strong> -&gt; <strong>Z</strong> — Rounding</a><ul>
<li><a class="reference internal" href="#rounding-to-integer" id="id33">Rounding to Integer</a></li>
<li><a class="reference internal" href="#integer-and-fraction-parts" id="id34">Integer and Fraction Parts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rounding-to-multiples" id="id35">Rounding to Multiples</a></li>
<li><a class="reference internal" href="#q-r-conversion-casting" id="id36"><strong>Q</strong> -&gt; <strong>R</strong> — Conversion / Casting</a></li>
<li><a class="reference internal" href="#r-q-approximation" id="id37"><strong>R</strong> -&gt; <strong>Q</strong> — Approximation</a><ul>
<li><a class="reference internal" href="#module-rat_interval" id="id38">Intervals</a><ul>
<li><a class="reference internal" href="#interval-constructors-and-deconstructors" id="id39">Interval Constructors and &#8216;Deconstructors&#8217;</a></li>
<li><a class="reference internal" href="#interval-type-tests" id="id40">Interval Type Tests</a></li>
<li><a class="reference internal" href="#interval-arithmetic-operators-and-relations" id="id41">Interval Arithmetic Operators and Relations</a></li>
<li><a class="reference internal" href="#interval-maths" id="id42">Interval Maths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#least-complex-approximation-within-epsilon" id="id43">Least Complex Approximation within Epsilon</a></li>
<li><a class="reference internal" href="#best-approximation-with-bounded-denominator" id="id44">Best Approximation with Bounded Denominator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#decomposition" id="id45">Decomposition</a></li>
<li><a class="reference internal" href="#continued-fractions" id="id46">Continued Fractions</a><ul>
<li><a class="reference internal" href="#id1" id="id47">Introduction</a></li>
<li><a class="reference internal" href="#generating-continued-fractions" id="id48">Generating Continued Fractions</a><ul>
<li><a class="reference internal" href="#exact" id="id49">Exact</a></li>
<li><a class="reference internal" href="#inexact" id="id50">Inexact</a></li>
</ul>
</li>
<li><a class="reference internal" href="#evaluating-continued-fractions" id="id51">Evaluating Continued Fractions</a><ul>
<li><a class="reference internal" href="#convergents" id="id52">Convergents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rational-complex-numbers" id="id53">Rational Complex Numbers</a><ul>
<li><a class="reference internal" href="#rational-complex-constructors-and-deconstructors" id="id54">Rational Complex Constructors and &#8216;Deconstructors&#8217;</a></li>
<li><a class="reference internal" href="#rational-complex-type-and-value-tests" id="id55">Rational Complex Type and Value Tests</a></li>
<li><a class="reference internal" href="#rational-complex-arithmetic-operators-and-relations" id="id56">Rational Complex Arithmetic Operators and Relations</a></li>
<li><a class="reference internal" href="#rational-complex-maths" id="id57">Rational Complex Maths</a></li>
<li><a class="reference internal" href="#rational-complex-type-simplification" id="id58">Rational Complex Type Simplification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#string-formatting-and-evaluation" id="id59">String Formatting and Evaluation</a><ul>
<li><a class="reference internal" href="#the-naming-of-the-string-conversion-functions" id="id60">The Naming of the String Conversion Functions</a></li>
<li><a class="reference internal" href="#internationalisation-and-format-structures" id="id61">Internationalisation and Format Structures</a></li>
<li><a class="reference internal" href="#digit-grouping" id="id62">Digit Grouping</a></li>
<li><a class="reference internal" href="#radices" id="id63">Radices</a></li>
<li><a class="reference internal" href="#error-terms" id="id64">Error Terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-fraction-string-i-n-d" id="id65"><strong>Q</strong> &lt;-&gt; Fraction String (“i + n/d”)</a><ul>
<li><a class="reference internal" href="#formatting-to-fraction-strings" id="id66">Formatting to Fraction Strings</a></li>
<li><a class="reference internal" href="#evaluation-of-fraction-strings" id="id67">Evaluation of Fraction Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-recurring-numeral-expansion-string-i-fr" id="id68"><strong>Q</strong> &lt;-&gt; Recurring Numeral Expansion String (“I.FR”)</a><ul>
<li><a class="reference internal" href="#formatting-to-recurring-expansion-strings" id="id69">Formatting to Recurring Expansion Strings</a></li>
<li><a class="reference internal" href="#evaluation-of-recurring-expansion-strings" id="id70">Evaluation of Recurring Expansion Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-numeral-expansion-string-i-f-10e" id="id71"><strong>Q</strong> &lt;-&gt; Numeral Expansion String (“I.F × 10E”)</a><ul>
<li><a class="reference internal" href="#formatting-to-expansion-strings" id="id72">Formatting to Expansion Strings</a><ul>
<li><a class="reference internal" href="#functions-for-fixed-decimal-places" id="id73">Functions for Fixed Decimal Places</a></li>
<li><a class="reference internal" href="#functions-for-significant-figures" id="id74">Functions for Significant Figures</a></li>
<li><a class="reference internal" href="#functions-for-scientific-notation-and-engineering-notation" id="id75">Functions for Scientific Notation and Engineering Notation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#evaluation-of-expansion-strings" id="id76">Evaluation of Expansion Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#numeral-string-q-approximation" id="id77">Numeral String -&gt; <strong>Q</strong> — Approximation</a></li>
</ul>
</div>
<div class="section" id="copying">
<h2><a class="toc-backref" href="#id2">Copying</a><a class="headerlink" href="#copying" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Copyright (c) 2006 - 2010 by Rob Hubbard.</div>
<div class="line">Copyright (c) 2006 - 2010 by Albert Graef &lt;<a class="reference external" href="mailto:aggraef&#37;&#52;&#48;gmail&#46;com">aggraef<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;.</div>
<div class="line">Copyright (c) 2010 by Jiri Spitz &lt;<a class="reference external" href="mailto:jiri&#46;spitz&#37;&#52;&#48;bluetone&#46;cz">jiri<span>&#46;</span>spitz<span>&#64;</span>bluetone<span>&#46;</span>cz</a>&gt;.</div>
</div>
<p>Pure-rational is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation, either version 3 of the License, or (at your option) any
later version.</p>
<p>Pure-rational is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU Public License along with this
program. If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id3">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Get the latest source from
<a class="reference external" href="https://bitbucket.org/purelang/pure-lang/downloads/pure-rational-0.1.tar.gz">https://bitbucket.org/purelang/pure-lang/downloads/pure-rational-0.1.tar.gz</a>.</p>
<p>Then run <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span></tt> (as root) to install pure-rational in the Pure
library directory. This requires GNU make, and of course you need to have Pure
installed.</p>
<p><tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span></tt> tries to guess your Pure installation directory. If it gets
this wrong, you can install using <tt class="docutils literal"><span class="pre">make</span> <span class="pre">install</span> <span class="pre">prefix=/usr</span></tt> which sets the
installation prefix. Please see the Makefile for details.</p>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id4">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-rational">
<span id="the-rational-module"></span><h3><a class="toc-backref" href="#id5">The Rational Module</a><a class="headerlink" href="#module-rational" title="Permalink to this headline">¶</a></h3>
<p>This module provides additional operations on the rational number type provided
by the <tt class="docutils literal"><span class="pre">math.pure</span></tt> module in the standard library. The module is compatible
with Pure version 0.43 (onwards).</p>
</div>
<div class="section" id="the-files-and-the-default-prelude">
<h3><a class="toc-backref" href="#id6">The Files and the Default Prelude</a><a class="headerlink" href="#the-files-and-the-default-prelude" title="Permalink to this headline">¶</a></h3>
<p>The implementation of the rational type and associated utilities is
distributed across various files.</p>
<div class="section" id="math-pure-and-other-files">
<h4><a class="toc-backref" href="#id7">math.pure and Other Files</a><a class="headerlink" href="#math-pure-and-other-files" title="Permalink to this headline">¶</a></h4>
<p>The file <tt class="docutils literal"><span class="pre">math.pure</span></tt> defines the type, its constructors and &#8216;deconstructors&#8217;
and basic arithmetical and mathematical operators and functions. This is part
of the standard Pure library. A few definitions associated with rationals are
also defined in other standard library modules. In particular, the type tests
are contained in <tt class="docutils literal"><span class="pre">primitives.pure</span></tt>.</p>
<p>It is also possible to create rational complex numbers (in addition to double
complex numbers and integral or Gaussian complex numbers). That is, rationals
play nicely with the complex number constructors provided in the <tt class="docutils literal"><span class="pre">math.pure</span></tt>
module. This is discussed further in <a class="reference internal" href="#rational-complex-numbers">Rational Complex Numbers</a>.</p>
</div>
<div class="section" id="rational-pure">
<h4><a class="toc-backref" href="#id8">rational.pure</a><a class="headerlink" href="#rational-pure" title="Permalink to this headline">¶</a></h4>
<p>Additional &#8216;rational utilities&#8217;, not included in the <tt class="docutils literal"><span class="pre">math.pure</span></tt> module, are
defined in <tt class="docutils literal"><span class="pre">rational.pure</span></tt>. The functions include further arithmetical and
mathematical operators and functions, continued fraction support, approximation
routines and string formatting and evaluation.</p>
<p>The rational utilities include some &#8216;rational complex number&#8217; functions.</p>
</div>
<div class="section" id="rat-interval-pure">
<h4><a class="toc-backref" href="#id9">rat_interval.pure</a><a class="headerlink" href="#rat-interval-pure" title="Permalink to this headline">¶</a></h4>
<p>Amongst the rational utilities are some functions that return a rational
interval. The file <tt class="docutils literal"><span class="pre">rat_interval.pure</span></tt> is a partial implementation of
interval arithmetic. Intervals are discussed further in <a class="reference internal" href="#intervals">Intervals</a>.</p>
</div>
</div>
<div class="section" id="notation">
<h3><a class="toc-backref" href="#id10">Notation</a><a class="headerlink" href="#notation" title="Permalink to this headline">¶</a></h3>
<p>Throughout this document, the parameters q, q0, q1, ... usually denote
rationals (∈ <strong>Q</strong>), parameters z, ... usually denote integers (∈ <strong>Z</strong>), r,
... usually denote real numbers (∈ <strong>R</strong>), c, ...  usually denote complex
numbers (∈ <strong>C</strong>), n, ... usually denote parameters of any numeric type, v,
... usually denote parameters of any interval type, and x, ... usually denote
parameters of any type.</p>
<p>The reals are not just the doubles, but include rationals and integers. The
term &#8216;rational&#8217; usually refers to a rational number ∈ <strong>Q</strong> ⊃ <strong>Z</strong>, or an
expression of type rational or integer.</p>
</div>
</div>
<div class="section" id="the-rational-type">
<h2><a class="toc-backref" href="#id11">The Rational Type</a><a class="headerlink" href="#the-rational-type" title="Permalink to this headline">¶</a></h2>
<div class="section" id="constructors">
<h3><a class="toc-backref" href="#id12">Constructors</a><a class="headerlink" href="#constructors" title="Permalink to this headline">¶</a></h3>
<p>Rationals are constructed with the <tt class="docutils literal"><span class="pre">%</span></tt> exact division operator, and other
kinds of numbers can be converted to rationals with the <tt class="docutils literal"><span class="pre">rational</span></tt> function.
These are both defined in math.pure.</p>
<dl class="function">
<dt id="%/rational">
n1 <tt class="descname">%</tt> n2<a class="headerlink" href="#%/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>is the exact division operator, which may be used as a constructor (for
integers n1 and n2). This is described in <a class="reference internal" href="#more-on-division">More on Division</a>.</p>
</dd></dl>

<dl class="function">
<dt id="rational/rational">
<tt class="descname">rational</tt> x<a class="headerlink" href="#rational/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>converts the given number <tt class="docutils literal"><span class="pre">x</span></tt> to a rational.</p>
</dd></dl>

<p><strong>Example 1</strong> Constructing a fraction:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="mi">44</span>%<span class="mi">14</span><span class="p">;</span>
<span class="mi">22L</span>%<span class="mi">7L</span>
</pre></div>
</div>
<p><strong>Example 2</strong> Converting from an integer:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational <span class="mi">3</span><span class="p">;</span>
<span class="mi">3L</span>%<span class="mi">1L</span>
</pre></div>
</div>
</div>
<div class="section" id="deconstructors">
<h3><a class="toc-backref" href="#id13">&#8216;Deconstructors&#8217;</a><a class="headerlink" href="#deconstructors" title="Permalink to this headline">¶</a></h3>
<p>A rational number is in simplest form if the numerator and denominator are
coprime (i.e. do not have a factor in common) and the denominator is positive
(and, specifically, non-zero). Sometimes the term &#8216;irreducible&#8217; is used for a
rational in simplest form. This is a property of the representation of the
rational number and not of the number itself.</p>
<dl class="function">
<dt id="num/rational">
<tt class="descname">num</tt> q<a class="headerlink" href="#num/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>given a rational or integer q, returns the ‘(signed) simplest
numerator’, i.e.  the numerator of the normalised form of q.</p>
</dd></dl>

<dl class="function">
<dt id="den/rational">
<tt class="descname">den</tt> q<a class="headerlink" href="#den/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>given a rational or integer q, returns the ‘(positive) simplest
denominator’,  i.e. the denominator of the normalised form of q.</p>
</dd></dl>

<dl class="function">
<dt id="rational::num_den">
<tt class="descclassname">rational::</tt><tt class="descname">num_den</tt> q<a class="headerlink" href="#rational::num_den" title="Permalink to this definition">¶</a></dt>
<dd><p>given a rational or integer q, returns a pair (n, d) containing the
(signed) simplest numerator n and the (positive) simplest denominator
d. This is the inverse (up to equivalence) of rational as defined on
integer pairs (see <a class="reference internal" href="#constructors">Constructors</a>).</p>
</dd></dl>

<p><strong>Example 3</strong> Using num_den to obtain a representation in simplest form:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> q = (<span class="mi">44</span>%(-<span class="mi">14</span>))<span class="p">;</span>
<span class="gp">&gt; </span>num q<span class="p">;</span>
-<span class="mi">22L</span>
<span class="gp">&gt; </span>den q<span class="p">;</span>
<span class="mi">7L</span>
<span class="gp">&gt; </span>num_den q<span class="p">;</span>
-<span class="mi">22L</span>,<span class="mi">7L</span>
<span class="gp">&gt; </span>num_den <span class="mi">3</span><span class="p">;</span>
<span class="mi">3L</span>,<span class="mi">1L</span>
<span class="gp">&gt; </span>num_den (-<span class="mi">3</span>)<span class="p">;</span>
-<span class="mi">3L</span>,<span class="mi">1L</span>
</pre></div>
</div>
<p>Together, <a class="reference internal" href="purelib.html#num" title="num"><tt class="xref pure pure-func docutils literal"><span class="pre">num</span></tt></a> and <a class="reference internal" href="purelib.html#den" title="den"><tt class="xref pure pure-func docutils literal"><span class="pre">den</span></tt></a> are a pair of &#8216;decomposition&#8217;
operators, and <a class="reference internal" href="#rational::num_den" title="rational::num_den"><tt class="xref pure pure-func docutils literal"><span class="pre">num_den</span></tt></a> is also a decomposition operator. There are
others (see <a class="reference internal" href="#decomposition">Decomposition</a>). The integer and fraction function (see <a class="reference internal" href="#integer-and-fraction-parts">Integer
and Fraction Parts</a>) may be used in conjunction with <a class="reference internal" href="#rational::num_den_gauss" title="rational::num_den_gauss"><tt class="xref pure pure-func docutils literal"><span class="pre">num_den_gauss</span></tt></a> to
decompose a rational into integer, numerator and denominator parts.</p>
</div>
<div class="section" id="type-and-value-tests">
<h3><a class="toc-backref" href="#id14">Type and Value Tests</a><a class="headerlink" href="#type-and-value-tests" title="Permalink to this headline">¶</a></h3>
<p>The functions <a class="reference internal" href="purelib.html#rationalp" title="rationalp"><tt class="xref pure pure-func docutils literal"><span class="pre">rationalp</span></tt></a> and <a class="reference internal" href="purelib.html#ratvalp" title="ratvalp"><tt class="xref pure pure-func docutils literal"><span class="pre">ratvalp</span></tt></a> and other rational
variants are new for rationals and the standard functions <a class="reference internal" href="purelib.html#exactp" title="exactp"><tt class="xref pure pure-func docutils literal"><span class="pre">exactp</span></tt></a> and
<a class="reference internal" href="purelib.html#inexactp" title="inexactp"><tt class="xref pure pure-func docutils literal"><span class="pre">inexactp</span></tt></a> are extended for rationals.</p>
<p>A value is &#8216;exact&#8217;, or of an exact type, if it is of a type that is able to
represent the values returned by arithmetical operations exactly; in a sense, it
is &#8216;closed&#8217; under arithmetical operations. Otherwise, a value is &#8216;inexact&#8217;.
Inexact types are able to store some values only approximately.</p>
<p>The doubles are not an exact type. The results of some operations on some
values that are stored exactly, can’t be stored exactly. (Furthermore, doubles
are intended to represent real numbers; no irrational number (∈ <strong>R</strong> \
<strong>Q</strong>) can be stored exactly as a double; even some rational (∈ <strong>Q</strong>) numbers
are not stored exactly.)</p>
<p>The rationals are an exact type. All rational numbers (subject to available
resources, of course) are stored exactly. The results of the arithmetical
operations on rationals are rationals represented exactly. Beware that the
standard <tt class="docutils literal"><span class="pre">intvalp</span></tt> and <a class="reference internal" href="purelib.html#ratvalp" title="ratvalp"><tt class="xref pure pure-func docutils literal"><span class="pre">ratvalp</span></tt></a> may return 1 even if the value is
of double type. However, these functions may be combined with <a class="reference internal" href="purelib.html#exactp" title="exactp"><tt class="xref pure pure-func docutils literal"><span class="pre">exactp</span></tt></a>.</p>
<dl class="function">
<dt id="exactp/rational">
<tt class="descname">exactp</tt> x<a class="headerlink" href="#exactp/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x has an exact value.</p>
</dd></dl>

<dl class="function">
<dt id="inexactp/rational">
<tt class="descname">inexactp</tt> x<a class="headerlink" href="#inexactp/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x has an inexact value.</p>
</dd></dl>

<dl class="function">
<dt id="rationalp/rational">
<tt class="descname">rationalp</tt> x<a class="headerlink" href="#rationalp/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x is of rational type.</p>
</dd></dl>

<dl class="function">
<dt id="ratvalp/rational">
<tt class="descname">ratvalp</tt> x<a class="headerlink" href="#ratvalp/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x has a rational value.</p>
</dd></dl>

<p><strong>Example 4</strong> Rational value tests:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> l = [<span class="mi">9</span>, <span class="mi">9</span>%<span class="mi">1</span>, <span class="mi">9</span>%<span class="mi">2</span>, <span class="mf">4.5</span>, sqrt <span class="mi">2</span>, <span class="mi">1</span>+i, inf, nan]<span class="p">;</span>
<span class="gp">&gt; </span>map exactp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map inexactp l<span class="p">;</span>
[<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>]
<span class="gp">&gt; </span>map rationalp l<span class="p">;</span>
[<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map ratvalp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map (\x -&gt; (exactp x &amp;&amp; ratvalp x)) l<span class="p">;</span> <span class="c1">// &quot;has exact rational value&quot;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map intvalp l<span class="p">;</span> <span class="c1">// for comparison</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map (\x -&gt; (exactp x &amp;&amp; intvalp x)) l<span class="p">;</span> <span class="c1">// &quot;has exact integer value&quot;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
</pre></div>
</div>
<p>See <a class="reference internal" href="#rational-complex-numbers">Rational Complex Numbers</a> for details about rational complex numbers, and
<a class="reference internal" href="#rational-complex-type-and-value-tests">Rational Complex Type and Value Tests</a> for details of their type and value
tests.</p>
</div>
</div>
<div class="section" id="arithmetic">
<h2><a class="toc-backref" href="#id15">Arithmetic</a><a class="headerlink" href="#arithmetic" title="Permalink to this headline">¶</a></h2>
<div class="section" id="operators">
<h3><a class="toc-backref" href="#id16">Operators</a><a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h3>
<p>The standard arithmetic operators (+), (−) and (*) are overloaded to have at
least one rational operand. If both operands are rational then the
result is rational. If one operand is integer, then the result is
rational. If one operand is double, then the result is double.</p>
<p>The operators (/) and (%) are overloaded for division on at least one
rational operand. The value returned by (/) is always <tt class="docutils literal"><span class="pre">inexact</span></tt> (in the
sense of <a class="reference internal" href="#type-and-value-tests">Type and Value Tests</a>). The value returned by (%) is <tt class="docutils literal"><span class="pre">exact</span></tt> (if it
exists).</p>
<p>The standard function <tt class="docutils literal"><span class="pre">pow</span></tt> is overloaded to have a rational left
operand. If <tt class="docutils literal"><span class="pre">pow</span></tt> is passed integer operands where the right operand is
negative, then a rational is returned. The right operand should be an
integer; negative values are permitted (because q<sup>−z</sup> =
1/q<sup>z</sup>). It is not overloaded to also have a rational right operand
because such values are not generally rational
(e.g. q<sup>1/n</sup> = <sup>n</sup>√q).</p>
<p>The standard arithmetic operator (^) is also overloaded, but produces a
double value (as always).</p>
<p><strong>Example 5</strong> Arithmetic:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="mi">5</span>%<span class="mi">7</span> + <span class="mi">2</span>%<span class="mi">3</span><span class="p">;</span>
<span class="mi">29L</span>%<span class="mi">21L</span>
<span class="gp">&gt; </span>str_mixed ans<span class="p">;</span>
<span class="s">&quot;1L+8L/21L&quot;</span>
<span class="gp">&gt; </span><span class="mi">1</span> + <span class="mi">2</span>%<span class="mi">3</span><span class="p">;</span>
<span class="mi">5L</span>%<span class="mi">3L</span>
<span class="gp">&gt; </span>ans + <span class="mf">1.0</span><span class="p">;</span>
<span class="mf">2.66666666666667</span>
<span class="gp">&gt; </span><span class="mi">3</span>%<span class="mi">8</span> - <span class="mi">1</span>%<span class="mi">3</span><span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">24L</span>
<span class="gp">&gt; </span>(<span class="mi">11</span>%<span class="mi">10</span>) ^ <span class="mi">3</span><span class="p">;</span>
<span class="mf">1.331</span>
<span class="gp">&gt; </span>pow (<span class="mi">11</span>%<span class="mi">10</span>) <span class="mi">3</span><span class="p">;</span>
<span class="mi">1331L</span>%<span class="mi">1000L</span>
<span class="gp">&gt; </span>pow <span class="mi">3</span> <span class="mi">5</span><span class="p">;</span>
<span class="mi">243L</span>
<span class="gp">&gt; </span>pow <span class="mi">3</span> (-<span class="mi">5</span>)<span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">243L</span>
</pre></div>
</div>
<p>(See the function <a class="reference internal" href="#rational::str_mixed" title="rational::str_mixed"><tt class="xref pure pure-func docutils literal"><span class="pre">str_mixed</span></tt></a>.)</p>
<p>Beware that (/) on integers will not produce a rational result.</p>
<p><strong>Example 6</strong> Division:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="mi">44</span>/<span class="mi">14</span><span class="p">;</span>
<span class="mf">3.14285714285714</span>
<span class="gp">&gt; </span><span class="mi">44</span>%<span class="mi">14</span><span class="p">;</span>
<span class="mi">22L</span>%<span class="mi">7L</span>
<span class="gp">&gt; </span>str_mixed ans<span class="p">;</span>
<span class="s">&quot;3L+1L/7L&quot;</span>
</pre></div>
</div>
<p>(See the function <a class="reference internal" href="#rational::str_mixed" title="rational::str_mixed"><tt class="xref pure pure-func docutils literal"><span class="pre">str_mixed</span></tt></a>.)</p>
</div>
<div class="section" id="more-on-division">
<h3><a class="toc-backref" href="#id17">More on Division</a><a class="headerlink" href="#more-on-division" title="Permalink to this headline">¶</a></h3>
<p>There is a rational-aware divide operator on the numeric types:</p>
<dl class="function">
<dt>
n1 <tt class="descname">%</tt> n2</dt>
<dd><p>returns the quotient (∈ <strong>Q</strong>) of n1 and n2. If n1 and n2 are rational or
integer then the result is rational. This operator has the precedence
of division (/).</p>
</dd></dl>

<p><strong>Example 7</strong> Using % like a constructor:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="mi">44</span> % <span class="mi">14</span><span class="p">;</span>
<span class="mi">22L</span>%<span class="mi">7L</span>
<span class="gp">&gt; </span><span class="mi">2</span> + <span class="mi">3</span>%<span class="mi">8</span><span class="p">;</span> <span class="c1">// &quot;2 3/8&quot;</span>
<span class="mi">19L</span>%<span class="mi">8L</span>
<span class="gp">&gt; </span>str_mixed ans<span class="p">;</span>
<span class="s">&quot;2L+3L/8L&quot;</span>
</pre></div>
</div>
<p>(See the function <a class="reference internal" href="#rational::str_mixed" title="rational::str_mixed"><tt class="xref pure pure-func docutils literal"><span class="pre">str_mixed</span></tt></a>.)</p>
<dl class="function">
<dt id="rational::reciprocal">
<tt class="descclassname">rational::</tt><tt class="descname">reciprocal</tt> n<a class="headerlink" href="#rational::reciprocal" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the reciprocal of n: 1/n.</p>
</dd></dl>

<p><strong>Example 8</strong> Reciprocal:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>reciprocal (<span class="mi">22</span>%<span class="mi">7</span>)<span class="p">;</span>
<span class="mi">7L</span>%<span class="mi">22L</span>
</pre></div>
</div>
<p>The following division functions are parameterised by a rounding mode
<tt class="docutils literal"><span class="pre">roundfun</span></tt>. The available rounding modes are described in <a class="reference internal" href="#rounding-to-integer">Rounding to
Integer</a>.</p>
<dl class="function">
<dt id="rational::divide">
<tt class="descclassname">rational::</tt><tt class="descname">divide</tt> roundfun n d<a class="headerlink" href="#rational::divide" title="Permalink to this definition">¶</a></dt>
<dd><p>for rationals n and d returns a pair (q, r) of &#8216;quotient&#8217; and &#8216;remainder&#8217;
where q is an integer and r is a rational such that |r| &lt; |d| (or
better) and n = q * d + r. Further conditions may hold, depending on the
chosen rounding mode <tt class="docutils literal"><span class="pre">roundfun</span></tt> (see <a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a>).
If <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="purelib.html#floor" title="floor"><tt class="xref pure pure-func docutils literal"><span class="pre">floor</span></tt></a> then 0 ≤ r &lt; d.
If <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="purelib.html#ceil" title="ceil"><tt class="xref pure pure-func docutils literal"><span class="pre">ceil</span></tt></a> then −d &lt; r ≤ 0.
If <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="purelib.html#trunc" title="trunc"><tt class="xref pure pure-func docutils literal"><span class="pre">trunc</span></tt></a> then |r| &lt; |d| and sgn r ∈ {0, sgn d}.
If <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="purelib.html#round" title="round"><tt class="xref pure pure-func docutils literal"><span class="pre">round</span></tt></a>, <tt class="docutils literal"><span class="pre">roundfun</span></tt> =
<tt class="xref pure pure-func docutils literal"><span class="pre">round_zero_bias</span></tt> or <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="#rational::round_unbiased" title="rational::round_unbiased"><tt class="xref pure pure-func docutils literal"><span class="pre">round_unbiased</span></tt></a> then
|r| ≤ d/2.</p>
</dd></dl>

<dl class="function">
<dt id="rational::quotient">
<tt class="descclassname">rational::</tt><tt class="descname">quotient</tt> roundfun nN d<a class="headerlink" href="#rational::quotient" title="Permalink to this definition">¶</a></dt>
<dd><p>returns just the quotient as produced by <a class="reference internal" href="#rational::divide" title="rational::divide"><tt class="xref pure pure-func docutils literal"><span class="pre">divide</span></tt></a> roundfun n d.</p>
</dd></dl>

<dl class="function">
<dt id="rational::modulus">
<tt class="descclassname">rational::</tt><tt class="descname">modulus</tt> roundfun n d<a class="headerlink" href="#rational::modulus" title="Permalink to this definition">¶</a></dt>
<dd><p>returns just the remainder as produced by <a class="reference internal" href="#rational::divide" title="rational::divide"><tt class="xref pure pure-func docutils literal"><span class="pre">divide</span></tt></a> roundfun n d.</p>
</dd></dl>

<dl class="function">
<dt id="div/rational">
q1 <tt class="descname">div</tt> q2<a class="headerlink" href="#div/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>(overload of the built-in div) q1 and q2 may be rational or integer.
Returns an integer.</p>
</dd></dl>

<dl class="function">
<dt id="mod/rational">
q1 <tt class="descname">mod</tt> q2<a class="headerlink" href="#mod/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>(overload of the built-in mod) q1 and q2 may be rational or integer.
Returns a rational. If q = q1 div q2 and r = q1 mod q2 then q1 = q * q2 +
q, q ∈ <strong>Z</strong>, |r| &lt; |q2| and sgn r ∈ {0, sgn q2}.</p>
</dd></dl>

</div>
<div class="section" id="relations-equality-and-inequality-tests">
<h3><a class="toc-backref" href="#id18">Relations — Equality and Inequality Tests</a><a class="headerlink" href="#relations-equality-and-inequality-tests" title="Permalink to this headline">¶</a></h3>
<p>The standard arithmetic operators (==), (~=), (&lt;), (&lt;=), (&gt;), (&gt;=) are
overloaded to have at least one rational operand. The other operand may be
rational, integer or double.</p>
<p><strong>Example 9</strong> Inequality:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="mi">3</span>%<span class="mi">8</span> &lt; <span class="mi">1</span>%<span class="mi">3</span><span class="p">;</span>
<span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="comparison-function">
<h3><a class="toc-backref" href="#id19">Comparison Function</a><a class="headerlink" href="#comparison-function" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::cmp">
<tt class="descclassname">rational::</tt><tt class="descname">cmp</tt> n1 n2<a class="headerlink" href="#rational::cmp" title="Permalink to this definition">¶</a></dt>
<dd><p>is the &#8216;comparison&#8217; (or &#8216;compare&#8217;) function, and returns sgn (n1 − n2);
that is, it returns −1 if n1 &lt; n2, 0 if n1 = n2, and +1 if n1 &gt; n2.</p>
</dd></dl>

<p><strong>Example 10</strong> Compare:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>cmp (<span class="mi">3</span>%<span class="mi">8</span>) (<span class="mi">1</span>%<span class="mi">3</span>)<span class="p">;</span>
<span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mathematical-functions">
<h2><a class="toc-backref" href="#id20">Mathematical Functions</a><a class="headerlink" href="#mathematical-functions" title="Permalink to this headline">¶</a></h2>
<p>Most mathematical functions, including the elementary functions (sin, sin<sup>−1</sup>, sinh, sinh<sup>−1</sup>, cos, ... , exp, ln, ... ), are not closed on
the set of rational numbers. That is, most mathematical functions do not yield a
rational number in general when applied to a rational number. Therefore the
elementary functions are not defined for rationals. To apply these
functions, first apply a cast to double, or compose the function with a
cast.</p>
<div class="section" id="absolute-value-and-sign">
<h3><a class="toc-backref" href="#id21">Absolute Value and Sign</a><a class="headerlink" href="#absolute-value-and-sign" title="Permalink to this headline">¶</a></h3>
<p>The standard <tt class="docutils literal"><span class="pre">abs</span></tt> and <tt class="docutils literal"><span class="pre">sgn</span></tt> functions are overloaded for rationals.</p>
<dl class="function">
<dt id="abs/rational">
<tt class="descname">abs</tt> q<a class="headerlink" href="#abs/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>returns absolute value, or magnitude, |q| of q; abs q = |q| = q × sgn q
(see  below).</p>
</dd></dl>

<dl class="function">
<dt id="sgn/rational">
<tt class="descname">sgn</tt> q<a class="headerlink" href="#sgn/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the sign of q as an integer; returns −1 if q &lt; 0, 0 if q = 0, +1
if q &gt; 0.</p>
</dd></dl>

<p>Together, these functions satisfy the property ∀q • (sgn q) * (abs q) = q (i.e.
∀q • (sgn q) * |q| = q). Thus these provide a pair of &#8216;decomposition&#8217;
operators; there are others (see <a class="reference internal" href="#decomposition">Decomposition</a>).</p>
</div>
<div class="section" id="greatest-common-divisor-gcd-and-least-common-multiple-lcm">
<h3><a class="toc-backref" href="#id22">Greatest Common Divisor (GCD) and Least Common Multiple (LCM)</a><a class="headerlink" href="#greatest-common-divisor-gcd-and-least-common-multiple-lcm" title="Permalink to this headline">¶</a></h3>
<p>The standard functions <tt class="docutils literal"><span class="pre">gcd</span></tt> and <tt class="docutils literal"><span class="pre">lcm</span></tt> are overloaded for rationals, and
mixtures of integer and rational.</p>
<dl class="function">
<dt id="gcd/rational">
<tt class="descname">gcd</tt> n1 n2<a class="headerlink" href="#gcd/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>The GCD is also known as the Highest Common Factor (HCF). The GCD of
rationals q1 and q2 is the largest (therefore positive) rational f such
that f divides into both q1 and q2 exactly, i.e. an integral number of
times. This is not defined for n1 and n2 both zero. For integral q1 and q2,
this definition coincides with the usual definition of GCD for integers.</p>
</dd></dl>

<p><strong>Example 11</strong> With two rationals:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> a = <span class="mi">7</span>%<span class="mi">12</span><span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> b = <span class="mi">21</span>%<span class="mi">32</span><span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> f = gcd a b<span class="p">;</span>
<span class="gp">&gt; </span>f<span class="p">;</span>
<span class="mi">7L</span>%<span class="mi">96L</span>
<span class="gp">&gt; </span>a % f<span class="p">;</span>
<span class="mi">8L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>b % f<span class="p">;</span>
<span class="mi">9L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<p><strong>Example 12</strong> With a rational and an integer:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> f = gcd (<span class="mi">6</span>%<span class="mi">5</span>) <span class="mi">4</span><span class="p">;</span>
<span class="gp">&gt; </span>f<span class="p">;</span>
<span class="mi">2L</span>%<span class="mi">5L</span>
<span class="gp">&gt; </span>(<span class="mi">6</span>%<span class="mi">5</span>) % f<span class="p">;</span>
<span class="mi">3L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span><span class="mi">4</span> % f<span class="p">;</span>
<span class="mi">10L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<p><strong>Example 13</strong> With integral rationals and with integers:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>gcd (rational <span class="mi">18</span>) (rational <span class="mi">24</span>)<span class="p">;</span>
<span class="mi">6L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>gcd <span class="mi">18</span> <span class="mi">24</span><span class="p">;</span>
<span class="mi">6</span>
</pre></div>
</div>
<p><strong>Example 14</strong> The behaviour with negative numbers:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>gcd (rational (-<span class="mi">18</span>)) (rational <span class="mi">24</span>)<span class="p">;</span>
<span class="mi">6L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>gcd (rational <span class="mi">18</span>) (rational (-<span class="mi">24</span>))<span class="p">;</span>
<span class="mi">6L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>gcd (rational (-<span class="mi">18</span>)) (rational (-<span class="mi">24</span>))<span class="p">;</span>
<span class="mi">6L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<dl class="function">
<dt id="lcm/rational">
<tt class="descname">lcm</tt> n1 n2<a class="headerlink" href="#lcm/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>The LCM of rationals q1 and q2 is the smallest positive rational m such
that both q1 and q2 divide m exactly. This is not defined for n1 and n2
both zero.  For integral q1 and q2, this definition coincides with the
usual definition of LCM for integers.</p>
</dd></dl>

<p><strong>Example 15</strong> With two rationals:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> a = <span class="mi">7</span>%<span class="mi">12</span><span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> bB = <span class="mi">21</span>%<span class="mi">32</span><span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> m = lcm a b<span class="p">;</span>
<span class="gp">&gt; </span>m<span class="p">;</span>
<span class="mi">21L</span>%<span class="mi">4L</span>
<span class="gp">&gt; </span>m % a<span class="p">;</span>
<span class="mi">9L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>m % b<span class="p">;</span>
<span class="mi">8L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<p><strong>Example 16</strong> With a rational and an integer:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> m = lcm (<span class="mi">6</span>%<span class="mi">5</span>) <span class="mi">4</span><span class="p">;</span>
<span class="gp">&gt; </span>m<span class="p">;</span>
<span class="mi">12L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>m % (<span class="mi">6</span>%<span class="mi">5</span>)<span class="p">;</span>
<span class="mi">10L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<p><strong>Example 17</strong> The behaviour with negative numbers:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>lcm (rational (-<span class="mi">18</span>)) (rational <span class="mi">24</span>)<span class="p">;</span>
<span class="mi">72L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>lcm (rational <span class="mi">18</span>) (rational (-<span class="mi">24</span>))<span class="p">;</span>
<span class="mi">72L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>lcm (rational (-<span class="mi">18</span>)) (rational (-<span class="mi">24</span>))<span class="p">;</span>
<span class="mi">72L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<p>Together, the GCD and LCM have the following property when applied to two
numbers: (gcd q1 q2) * (lcm q1 q2) = |q1 * q2|.</p>
</div>
<div class="section" id="extrema-minima-and-maxima">
<h3><a class="toc-backref" href="#id23">Extrema (Minima and Maxima)</a><a class="headerlink" href="#extrema-minima-and-maxima" title="Permalink to this headline">¶</a></h3>
<p>The standard <tt class="docutils literal"><span class="pre">min</span></tt> and <tt class="docutils literal"><span class="pre">max</span></tt> functions work with rational values.</p>
<p><strong>Example 18</strong> Maximum:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>max (<span class="mi">3</span>%<span class="mi">8</span>) (<span class="mi">1</span>%<span class="mi">3</span>)<span class="p">;</span>
<span class="mi">3L</span>%<span class="mi">8L</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="special-rational-functions">
<h2><a class="toc-backref" href="#id24">Special Rational Functions</a><a class="headerlink" href="#special-rational-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="complexity">
<h3><a class="toc-backref" href="#id25">Complexity</a><a class="headerlink" href="#complexity" title="Permalink to this headline">¶</a></h3>
<p>The &#8216;complexity&#8217; (or &#8216;complicatedness&#8217;) of a rational is a measure of the
greatness of its simplest (positive) denominator.</p>
<p>The complexity of a number is not itself made available, but various functions
and operators are provided to allow complexities to be compared. Generally, it
does not make sense to operate directly on complexity values.</p>
<p>The complexity functions in this section may be applied to integers (the
least complex), rationals, or reals (doubles; the most complex).</p>
<p>Functions concerning &#8216;complexity&#8217; are named with &#8216;cplx&#8217;, whereas functions
concerning &#8216;complex numbers&#8217; (see <a class="reference internal" href="#rational-complex-numbers">Rational Complex Numbers</a>) are named with
&#8216;comp&#8217;.</p>
<div class="section" id="complexity-relations">
<h4><a class="toc-backref" href="#id26">Complexity Relations</a><a class="headerlink" href="#complexity-relations" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::eq_cplx">
n1 <tt class="descclassname">rational::</tt><tt class="descname">eq_cplx</tt> n2<a class="headerlink" href="#rational::eq_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;[is] equally complex [to]&#8221; — returns 1 if n1 and n2 are equally complex;
returns 0 otherwise. Equal complexity is not the same a equality; n1 and n2
are equally complex if their simplest denominators are equal. Equal
complexity forms an equivalence relation on rationals.</p>
</dd></dl>

<p><strong>Example 19</strong> Complexity equality test:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>(<span class="mi">1</span>%<span class="mi">3</span>) eq_cplx (<span class="mi">100</span>%<span class="mi">3</span>)<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>(<span class="mi">1</span>%<span class="mi">4</span>) eq_cplx (<span class="mi">1</span>%<span class="mi">5</span>)<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>(<span class="mi">3</span>%<span class="mi">3</span>) eq_cplx (<span class="mi">1</span>%<span class="mi">3</span>)<span class="p">;</span> <span class="c1">// LHS is not in simplest form</span>
<span class="mi">0</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::not_eq_cplx">
n1 <tt class="descclassname">rational::</tt><tt class="descname">not_eq_cplx</tt> n2<a class="headerlink" href="#rational::not_eq_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;not equally complex&#8221; — returns 0 if n1 and n2 are equally complex; returns
1 otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="rational::less_cplx">
n1 <tt class="descclassname">rational::</tt><tt class="descname">less_cplx</tt> n2<a class="headerlink" href="#rational::less_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;[is] less complex [than]&#8221; (or &#8220;simpler&#8221;) — returns 1 if n1 is strictly
less complex than n2; returns 0 otherwise. This forms a partial strict
ordering on rationals.</p>
</dd></dl>

<p><strong>Example 20</strong> Complexity inequality test:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>(<span class="mi">1</span>%<span class="mi">3</span>) less_cplx (<span class="mi">100</span>%<span class="mi">3</span>)<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>(<span class="mi">1</span>%<span class="mi">4</span>) less_cplx (<span class="mi">1</span>%<span class="mi">5</span>)<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>(<span class="mi">3</span>%<span class="mi">3</span>) less_cplx (<span class="mi">1</span>%<span class="mi">3</span>)<span class="p">;</span> <span class="c1">// LHS is not in simplest form</span>
<span class="mi">1</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::less_eq_cplx">
n1 <tt class="descclassname">rational::</tt><tt class="descname">less_eq_cplx</tt> n2<a class="headerlink" href="#rational::less_eq_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;less or equally complex&#8221; (or &#8220;not more complex&#8221;) — returns 1 if n1 is less
complex than or equally complex to n2; returns 0 otherwise. This forms a
partial non-strict ordering on rationals.</p>
</dd></dl>

<dl class="function">
<dt id="rational::more_cplx">
n1 <tt class="descclassname">rational::</tt><tt class="descname">more_cplx</tt> n2<a class="headerlink" href="#rational::more_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;[is] more complex [than]&#8221; — returns 1 if n1 is strictly more complex than
n2; returns 0 otherwise. This forms a partial strict ordering on rationals.</p>
</dd></dl>

<dl class="function">
<dt id="rational::more_eq_cplx">
n1 <tt class="descclassname">rational::</tt><tt class="descname">more_eq_cplx</tt> n2<a class="headerlink" href="#rational::more_eq_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>&#8220;more or equally complex&#8221; (or &#8220;not less complex&#8221;) — returns 1 if n1 is more
complex than or equally complex to n2; returns 0 otherwise. This forms a
partial non-strict ordering on rationals.</p>
</dd></dl>

</div>
<div class="section" id="complexity-comparison-function">
<h4><a class="toc-backref" href="#id27">Complexity Comparison Function</a><a class="headerlink" href="#complexity-comparison-function" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::cmp_complexity">
<tt class="descclassname">rational::</tt><tt class="descname">cmp_complexity</tt> n1 n2<a class="headerlink" href="#rational::cmp_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>is the &#8216;complexity comparison&#8217; function, and returns the sign of the
difference in complexity; that is, it returns −1 if n1 is less complex than
n2, 0 if n1 and n2 are equally complex (but not necessarily equal), and +1
if n1 is more complex than n2.</p>
</dd></dl>

<p><strong>Example 21</strong> Complexity comparison:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>cmp_complexity (<span class="mi">1</span>%<span class="mi">3</span>) (<span class="mi">100</span>%<span class="mi">3</span>)<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>cmp_complexity (<span class="mi">1</span>%<span class="mi">4</span>) (<span class="mi">1</span>%<span class="mi">5</span>)<span class="p">;</span>
-<span class="mi">1</span>
<span class="gp">&gt; </span>cmp_complexity (<span class="mi">3</span>%<span class="mi">3</span>) (<span class="mi">1</span>%<span class="mi">3</span>)<span class="p">;</span> <span class="c1">// LHS is not in simplest form</span>
-<span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="complexity-extrema">
<h4><a class="toc-backref" href="#id28">Complexity Extrema</a><a class="headerlink" href="#complexity-extrema" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::least_cplx">
<tt class="descclassname">rational::</tt><tt class="descname">least_cplx</tt> n1 n2<a class="headerlink" href="#rational::least_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the least complex of n1 and n2; if they’re equally complex, n1 is
returned.</p>
</dd></dl>

<p><strong>Example 22</strong> Complexity selection:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>least_cplx (<span class="mi">100</span>%<span class="mi">3</span>) (<span class="mi">1</span>%<span class="mi">3</span>)<span class="p">;</span>
<span class="mi">100L</span>%<span class="mi">3L</span>
<span class="gp">&gt; </span>least_cplx (<span class="mi">1</span>%<span class="mi">5</span>) (<span class="mi">1</span>%<span class="mi">4</span>)<span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">4L</span>
<span class="gp">&gt; </span>least_cplx (<span class="mi">1</span>%<span class="mi">3</span>) (<span class="mi">3</span>%<span class="mi">3</span>)<span class="p">;</span> <span class="c1">// second argument not in simplest form</span>
<span class="mi">1L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::most_cplx">
<tt class="descclassname">rational::</tt><tt class="descname">most_cplx</tt> n1 n2<a class="headerlink" href="#rational::most_cplx" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the most complex of n1 and n2; if they’re equally complex, n1 is
returned.</p>
</dd></dl>

</div>
<div class="section" id="other-complexity-functions">
<h4><a class="toc-backref" href="#id29">Other Complexity Functions</a><a class="headerlink" href="#other-complexity-functions" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::complexity_rel">
<tt class="descclassname">rational::</tt><tt class="descname">complexity_rel</tt> n1 op n2<a class="headerlink" href="#rational::complexity_rel" title="Permalink to this definition">¶</a></dt>
<dd><p>returns &#8220;complexity-of n1&#8221; compared by operator op to the “complexity-of
n2”. This is equivalent to prefix complexity rel op n1 n2 (below), but is
the more readable form.</p>
</dd></dl>

<p><strong>Example 23</strong> Complexity relations:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>complexity_rel (<span class="mi">1</span>%<span class="mi">3</span>) (==) (<span class="mi">100</span>%<span class="mi">3</span>)<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>complexity_rel (<span class="mi">1</span>%<span class="mi">4</span>) (&lt;=) (<span class="mi">1</span>%<span class="mi">5</span>)<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>complexity_rel (<span class="mi">1</span>%<span class="mi">4</span>) (&gt;) (<span class="mi">1</span>%<span class="mi">5</span>)<span class="p">;</span>
<span class="mi">0</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::_complexity_rel">
<tt class="descclassname">rational::</tt><tt class="descname">_complexity_rel</tt> op n1 n2<a class="headerlink" href="#rational::_complexity_rel" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the same as complexity_rel n1 op n2, but this form is more
convenient for currying.</p>
</dd></dl>

</div>
</div>
<div class="section" id="mediants-and-farey-sequences">
<h3><a class="toc-backref" href="#id30">Mediants and Farey Sequences</a><a class="headerlink" href="#mediants-and-farey-sequences" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::mediant">
<tt class="descclassname">rational::</tt><tt class="descname">mediant</tt> q1 q2<a class="headerlink" href="#rational::mediant" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the canonical mediant of the rationals q1 and q2, a form of
(nonarithmetic) average on rationals. The mediant of the representations
n1/d1 = q1 and n2/d2 = q2, where d1 and d2 must be positive, is defined as
(n1 + n2)/(d1 + d2). A mediant of the rationals q1 and q2 is a mediant of
some representation of each of q1 and q2. That is, the mediant is dependent
upon the representations and therefore is not well-defined as a function on
pairs of rationals. The canonical mediant always assumes the simplest
representation, and therefore is well-defined as a function on pairs of
rationals.</p>
<p>By the phrase “the mediant” (as opposed to just “a mediant”) we
always mean “the canonical mediant”.</p>
<p>If q1 &lt; q2, then any mediant q is always such that q1 &lt; q &lt; q2.</p>
<p>The (canonical) mediant has some special properties. If q1 and q2 are
integers, then the mediant is the arithmetic mean. If q1 and q2 are unit
fractions (reciprocals of integers), then the mediant is the harmonic mean.
The mediant of q and 1/q is ±1, (which happens to be a geometric mean with
the correct sign, although this is a somewhat uninteresting and degenerate
case).</p>
</dd></dl>

<p><strong>Example 24</strong> Mediants:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>mediant (<span class="mi">1</span>%<span class="mi">4</span>) (<span class="mi">3</span>%<span class="mi">10</span>)<span class="p">;</span>
<span class="mi">2L</span>%<span class="mi">7L</span>
<span class="gp">&gt; </span>mediant <span class="mi">3</span> <span class="mi">7</span><span class="p">;</span> <span class="c1">// both integers</span>
<span class="mi">5L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>mediant <span class="mi">3</span> <span class="mi">8</span><span class="p">;</span> <span class="c1">// both integers again</span>
<span class="mi">11L</span>%<span class="mi">2L</span>
<span class="gp">&gt; </span>mediant (<span class="mi">1</span>%<span class="mi">3</span>) (<span class="mi">1</span>%<span class="mi">7</span>)<span class="p">;</span> <span class="c1">// both unit fractions</span>
<span class="mi">1L</span>%<span class="mi">5L</span>
<span class="gp">&gt; </span>mediant (<span class="mi">1</span>%<span class="mi">3</span>) (<span class="mi">1</span>%<span class="mi">8</span>)<span class="p">;</span> <span class="c1">// both unit fractions again</span>
<span class="mi">2L</span>%<span class="mi">11L</span>
<span class="gp">&gt; </span>mediant (-<span class="mi">10</span>) (-<span class="mi">1</span>%<span class="mi">10</span>)<span class="p">;</span>
(-<span class="mi">1L</span>)%<span class="mi">1L</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::farey">
<tt class="descclassname">rational::</tt><tt class="descname">farey</tt> k<a class="headerlink" href="#rational::farey" title="Permalink to this definition">¶</a></dt>
<dd><p>for an integer k, farey returns the ordered list containing the order-k
Farey sequence, which is the ordered list of all rational numbers between 0
and 1 inclusive with (simplest) denominator at most k.</p>
</dd></dl>

<p><strong>Example 25</strong> A Farey sequence:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>map str_mixed (farey <span class="mi">6</span>)<span class="p">;</span>
[<span class="s">&quot;0L&quot;</span>,<span class="s">&quot;1L/6L&quot;</span>,<span class="s">&quot;1L/5L&quot;</span>,<span class="s">&quot;1L/4L&quot;</span>,<span class="s">&quot;1L/3L&quot;</span>,<span class="s">&quot;2L/5L&quot;</span>,<span class="s">&quot;1L/2L&quot;</span>,<span class="s">&quot;3L/5L&quot;</span>,<span class="s">&quot;2L/3L&quot;</span>,
<span class="s">&quot;3L/4L&quot;</span>,<span class="s">&quot;4L/5L&quot;</span>,<span class="s">&quot;5L/6L&quot;</span>,<span class="s">&quot;1L&quot;</span>]
</pre></div>
</div>
<p>(See the function <a class="reference internal" href="#rational::str_mixed" title="rational::str_mixed"><tt class="xref pure pure-func docutils literal"><span class="pre">str_mixed</span></tt></a>.)</p>
<p>Farey sequences and mediants are closely related. Three rationals q1 &lt; q2 &lt; q3
are consecutive members of a Farey sequence if and only if q2 is the mediant of
q1 and q3. If rationals q1 = n1/d1 &lt; q2 = n2/d2 are consecutive members of a
Farey sequence, then n2d1 − n1d2 = 1.</p>
</div>
<div class="section" id="rational-type-simplification">
<h3><a class="toc-backref" href="#id31">Rational Type Simplification</a><a class="headerlink" href="#rational-type-simplification" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::rat_simplify">
<tt class="descclassname">rational::</tt><tt class="descname">rat_simplify</tt> q<a class="headerlink" href="#rational::rat_simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q with rationals simplified to integers, if possible.</p>
</dd></dl>

<p><strong>Example 26</strong> Rational type simplification:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> l = [<span class="mi">9</span>, <span class="mi">9</span>%<span class="mi">1</span>, <span class="mi">9</span>%<span class="mi">2</span>, <span class="mf">4.5</span>, <span class="mi">9</span>%<span class="mi">1</span>+i, <span class="mi">9</span>%<span class="mi">2</span>+i]<span class="p">;</span> l<span class="p">;</span>
[<span class="mi">9</span>,<span class="mi">9L</span>%<span class="mi">1L</span>,<span class="mi">9L</span>%<span class="mi">2L</span>,<span class="mf">4.5</span>,<span class="mi">9L</span>%<span class="mi">1L</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">2L</span>+:<span class="mi">1</span>]
<span class="gp">&gt; </span>map rat_simplify l<span class="p">;</span>
[<span class="mi">9</span>,<span class="mi">9</span>,<span class="mi">9L</span>%<span class="mi">2L</span>,<span class="mf">4.5</span>,<span class="mi">9</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">2L</span>+:<span class="mi">1</span>]
</pre></div>
</div>
<p>See <a class="reference internal" href="#rational-complex-numbers">Rational Complex Numbers</a> for details about rational complex numbers, and
<a class="reference internal" href="#rational-complex-type-simplification">Rational Complex Type Simplification</a> for details of their type
simplification.</p>
</div>
</div>
<div class="section" id="q-z-rounding">
<h2><a class="toc-backref" href="#id32"><strong>Q</strong> -&gt; <strong>Z</strong> — Rounding</a><a class="headerlink" href="#q-z-rounding" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rounding-to-integer">
<h3><a class="toc-backref" href="#id33">Rounding to Integer</a><a class="headerlink" href="#rounding-to-integer" title="Permalink to this headline">¶</a></h3>
<p>Some of these are new functions, and some are overloads of standard functions.
The behaviour of the overloads is consistent with that of the standard
functions.</p>
<dl class="function">
<dt id="floor/rational">
<tt class="descname">floor</tt> q<a class="headerlink" href="#floor/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>(overload of standard function) returns q rounded downwards, i.e. towards
−1, to an integer, usually denoted bQc.</p>
</dd></dl>

<dl class="function">
<dt id="ceil/rational">
<tt class="descname">ceil</tt> q<a class="headerlink" href="#ceil/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>(overload of standard function) returns q rounded upwards, i.e. towards +1,
to an integer, usually denoted dQe.</p>
</dd></dl>

<dl class="function">
<dt id="trunc/rational">
<tt class="descname">trunc</tt> q<a class="headerlink" href="#trunc/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>(overload of standard function) returns q truncated, i.e. rounded towards
0, to an integer.</p>
</dd></dl>

<dl class="function">
<dt id="round/rational">
<tt class="descname">round</tt> q<a class="headerlink" href="#round/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>(overload of standard function) returns q &#8216;rounded off&#8217;, i.e. rounded to
the nearest integer, with ‘half-integers’ (values that are an integer plus
a half) rounded away from zero.</p>
</dd></dl>

<dl class="function">
<dt id="rational::round_zero_bias">
<tt class="descclassname">rational::</tt><tt class="descname">round_zero_bias</tt> q<a class="headerlink" href="#rational::round_zero_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>(new function) returns q &#8216;rounded off&#8217;, i.e. rounded to the nearest
integer, but with ‘half-integers’ rounded towards zero.</p>
</dd></dl>

<dl class="function">
<dt id="rational::round_unbiased">
<tt class="descclassname">rational::</tt><tt class="descname">round_unbiased</tt> q<a class="headerlink" href="#rational::round_unbiased" title="Permalink to this definition">¶</a></dt>
<dd><p>(new function) returns q rounded to the nearest integer, with
‘half-integers’ rounded to the nearest even integer.</p>
</dd></dl>

<p><strong>Example 27</strong> Illustration of the different rounding modes:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> l = iterwhile (&lt;= <span class="mi">3</span>) (+(<span class="mi">1</span>%<span class="mi">2</span>)) (- rational <span class="mi">3</span>)<span class="p">;</span>
<span class="gp">&gt; </span>map <span class="kt">double</span> l<span class="p">;</span> <span class="c1">// (just to show the values in a familiar format)</span>
[-<span class="mf">3.0</span>,-<span class="mf">2.5</span>,-<span class="mf">2.0</span>,-<span class="mf">1.5</span>,-<span class="mf">1.0</span>,-<span class="mf">0.5</span>,<span class="mf">0.0</span>,<span class="mf">0.5</span>,<span class="mf">1.0</span>,<span class="mf">1.5</span>,<span class="mf">2.0</span>,<span class="mf">2.5</span>,<span class="mf">3.0</span>]
<span class="gp">&gt; </span>map floor l<span class="p">;</span>
[-<span class="mi">3L</span>,-<span class="mi">3L</span>,-<span class="mi">2L</span>,-<span class="mi">2L</span>,-<span class="mi">1L</span>,-<span class="mi">1L</span>,<span class="mi">0L</span>,<span class="mi">0L</span>,<span class="mi">1L</span>,<span class="mi">1L</span>,<span class="mi">2L</span>,<span class="mi">2L</span>,<span class="mi">3L</span>]
<span class="gp">&gt; </span>map ceil l<span class="p">;</span>
[-<span class="mi">3L</span>,-<span class="mi">2L</span>,-<span class="mi">2L</span>,-<span class="mi">1L</span>,-<span class="mi">1L</span>,<span class="mi">0L</span>,<span class="mi">0L</span>,<span class="mi">1L</span>,<span class="mi">1L</span>,<span class="mi">2L</span>,<span class="mi">2L</span>,<span class="mi">3L</span>,<span class="mi">3L</span>]
<span class="gp">&gt; </span>map trunc l<span class="p">;</span>
[-<span class="mi">3L</span>,-<span class="mi">2L</span>,-<span class="mi">2L</span>,-<span class="mi">1L</span>,-<span class="mi">1L</span>,<span class="mi">0L</span>,<span class="mi">0L</span>,<span class="mi">0L</span>,<span class="mi">1L</span>,<span class="mi">1L</span>,<span class="mi">2L</span>,<span class="mi">2L</span>,<span class="mi">3L</span>]
<span class="gp">&gt; </span>map round l<span class="p">;</span>
[-<span class="mi">3L</span>,-<span class="mi">3L</span>,-<span class="mi">2L</span>,-<span class="mi">2L</span>,-<span class="mi">1L</span>,-<span class="mi">1L</span>,<span class="mi">0L</span>,<span class="mi">1L</span>,<span class="mi">1L</span>,<span class="mi">2L</span>,<span class="mi">2L</span>,<span class="mi">3L</span>,<span class="mi">3L</span>]
<span class="gp">&gt; </span>map round_zero_bias l<span class="p">;</span>
[-<span class="mi">3L</span>,-<span class="mi">2L</span>,-<span class="mi">2L</span>,-<span class="mi">1L</span>,-<span class="mi">1L</span>,<span class="mi">0L</span>,<span class="mi">0L</span>,<span class="mi">0L</span>,<span class="mi">1L</span>,<span class="mi">1L</span>,<span class="mi">2L</span>,<span class="mi">2L</span>,<span class="mi">3L</span>]
<span class="gp">&gt; </span>map round_unbiased l<span class="p">;</span>
[-<span class="mi">3L</span>,-<span class="mi">2L</span>,-<span class="mi">2L</span>,-<span class="mi">2L</span>,-<span class="mi">1L</span>,<span class="mi">0L</span>,<span class="mi">0L</span>,<span class="mi">0L</span>,<span class="mi">1L</span>,<span class="mi">2L</span>,<span class="mi">2L</span>,<span class="mi">2L</span>,<span class="mi">3L</span>]
</pre></div>
</div>
<p>(See the function <a class="reference internal" href="purelib.html#double" title="double"><tt class="xref pure pure-func docutils literal"><span class="pre">double</span></tt></a>.)</p>
</div>
<div class="section" id="integer-and-fraction-parts">
<h3><a class="toc-backref" href="#id34">Integer and Fraction Parts</a><a class="headerlink" href="#integer-and-fraction-parts" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::integer_and_fraction">
<tt class="descclassname">rational::</tt><tt class="descname">integer_and_fraction</tt> roundfun q<a class="headerlink" href="#rational::integer_and_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a pair (z, f) where z is the &#8216;integer part&#8217; as an integer, f is the
&#8216;fraction part&#8217; as a rational, where the rounding operations are performed
using rounding mode <tt class="docutils literal"><span class="pre">roundfun</span></tt> (see <a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a>).</p>
</dd></dl>

<p><strong>Example 28</strong> Integer and fraction parts with the different rounding modes:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> nc = -<span class="mi">22</span>%<span class="mi">7</span><span class="p">;</span>
<span class="gp">&gt; </span>integer_and_fraction floor nc<span class="p">;</span>
-<span class="mi">4L</span>,<span class="mi">6L</span>%<span class="mi">7L</span>
<span class="gp">&gt; </span>integer_and_fraction trunc nc<span class="p">;</span>
-<span class="mi">3L</span>,(-<span class="mi">1L</span>)%<span class="mi">7L</span>
<span class="gp">&gt; </span>integer_and_fraction round nc<span class="p">;</span>
-<span class="mi">3L</span>,(-<span class="mi">1L</span>)%<span class="mi">7L</span>
</pre></div>
</div>
<p>It is always the case that z and f have the property that q = z + f. However,
the remaining properties depend upon the choice of <tt class="docutils literal"><span class="pre">roundfun</span></tt>.
Thus this provides a &#8216;decomposition&#8217; operator; there are others (see
<a class="reference internal" href="#decomposition">Decomposition</a>).
If <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="purelib.html#floor" title="floor"><tt class="xref pure pure-func docutils literal"><span class="pre">floor</span></tt></a> then 0 ≤ f &lt; 1.
If <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="purelib.html#ceil" title="ceil"><tt class="xref pure pure-func docutils literal"><span class="pre">ceil</span></tt></a> then −1 &lt; f ≤ 0.
If <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="purelib.html#trunc" title="trunc"><tt class="xref pure pure-func docutils literal"><span class="pre">trunc</span></tt></a> then |f| &lt; 1 and sgn f ∈ {0, sgn q}.
If <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="purelib.html#round" title="round"><tt class="xref pure pure-func docutils literal"><span class="pre">round</span></tt></a>, <tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="#rational::round_zero_bias" title="rational::round_zero_bias"><tt class="xref pure pure-func docutils literal"><span class="pre">round_zero_bias</span></tt></a> or
<tt class="docutils literal"><span class="pre">roundfun</span></tt> = <a class="reference internal" href="#rational::round_unbiased" title="rational::round_unbiased"><tt class="xref pure pure-func docutils literal"><span class="pre">round_unbiased</span></tt></a> then |f| ≤ 1/2.</p>
<dl class="function">
<dt id="rational::fraction">
<tt class="descclassname">rational::</tt><tt class="descname">fraction</tt> roundfun q<a class="headerlink" href="#rational::fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>returns just the &#8216;fraction part&#8217; as a rational, where the rounding
operations are performed using <tt class="docutils literal"><span class="pre">roundfun</span></tt>. The corresponding function
&#8216;integer&#8217; is not provided, as integer <tt class="docutils literal"><span class="pre">roundfun</span></tt> q would be just
<tt class="docutils literal"><span class="pre">roundfun</span></tt> q. The integer and fraction function (probably with
<a class="reference internal" href="purelib.html#trunc" title="trunc"><tt class="xref pure pure-func docutils literal"><span class="pre">trunc</span></tt></a> or <a class="reference internal" href="purelib.html#floor" title="floor"><tt class="xref pure pure-func docutils literal"><span class="pre">floor</span></tt></a> rounding mode) may be used in
conjunction with <a class="reference internal" href="#rational::num_den" title="rational::num_den"><tt class="xref pure pure-func docutils literal"><span class="pre">num_den</span></tt></a> (see <a class="reference internal" href="#deconstructors">&#8216;Deconstructors&#8217;</a>) to decompose a
rational into integer, numerator and denominator parts.</p>
</dd></dl>

<dl class="function">
<dt id="int/rational">
<tt class="descname">int</tt> q<a class="headerlink" href="#int/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>overloads the built-in int and returns the &#8216;integer part&#8217; of q consistent
with the built-in.</p>
</dd></dl>

<dl class="function">
<dt id="frac/rational">
<tt class="descname">frac</tt> q<a class="headerlink" href="#frac/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>overloads the built-in frac and returns the &#8216;fraction part&#8217; of q consistent
with the built-in.</p>
</dd></dl>

<p><strong>Example 29</strong> Standard integer and fraction parts:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> nc = -<span class="mi">22</span>%<span class="mi">7</span><span class="p">;</span>
<span class="gp">&gt; </span><span class="kt">int</span> nc<span class="p">;</span>
-<span class="mi">3</span>
<span class="gp">&gt; </span>frac nc<span class="p">;</span>
(-<span class="mi">1L</span>)%<span class="mi">7L</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rounding-to-multiples">
<h2><a class="toc-backref" href="#id35">Rounding to Multiples</a><a class="headerlink" href="#rounding-to-multiples" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="rational::round_to_multiple">
<tt class="descclassname">rational::</tt><tt class="descname">round_to_multiple</tt> roundfun multOf q<a class="headerlink" href="#rational::round_to_multiple" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q rounded to an integer multiple of a non-zero value multOf, using
<tt class="docutils literal"><span class="pre">roundfun</span></tt> as the rounding mode (see <a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a>). Note that it
is the multiple that is rounded in the prescribed way, and not the final
result, which may make a difference in the case that multOf is negative. If
that is not the desired behaviour, pass this function the absolute value of
multOf rather than multOf. Similar comments apply to the following
functions.</p>
</dd></dl>

<dl class="function">
<dt id="rational::floor_multiple">
<tt class="descclassname">rational::</tt><tt class="descname">floor_multiple</tt> multOf q<a class="headerlink" href="#rational::floor_multiple" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q rounded to a downwards integer multiple of multOf.</p>
</dd></dl>

<dl class="function">
<dt id="rational::ceil_multiple">
<tt class="descclassname">rational::</tt><tt class="descname">ceil_multiple</tt> multOf q<a class="headerlink" href="#rational::ceil_multiple" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q rounded to an upwards integer multiple of multOf.</p>
</dd></dl>

<dl class="function">
<dt id="rational::trunc_multiple">
<tt class="descclassname">rational::</tt><tt class="descname">trunc_multiple</tt> multOf q<a class="headerlink" href="#rational::trunc_multiple" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q rounded towards zero to an integer multiple of multOf.</p>
</dd></dl>

<dl class="function">
<dt id="rational::round_multiple">
<tt class="descclassname">rational::</tt><tt class="descname">round_multiple</tt> multOf q<a class="headerlink" href="#rational::round_multiple" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q rounded towards the nearest integer multiple of multOf, with
half-integer multiples rounded away from 0.</p>
</dd></dl>

<dl class="function">
<dt id="rational::round_multiple_zero_bias">
<tt class="descclassname">rational::</tt><tt class="descname">round_multiple_zero_bias</tt> multOf q<a class="headerlink" href="#rational::round_multiple_zero_bias" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q rounded towards the nearest integer multiple of multOf, with
half-integer multiples rounded towards 0.</p>
</dd></dl>

<dl class="function">
<dt id="rational::round_multiple_unbiased">
<tt class="descclassname">rational::</tt><tt class="descname">round_multiple_unbiased</tt> multOf q<a class="headerlink" href="#rational::round_multiple_unbiased" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q rounded towards the nearest integer multiple of multOf, with
half-integer multiples rounded to an even multiple.</p>
</dd></dl>

<p><strong>Example 30</strong> Round to multiple:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> l = [<span class="mf">34.9</span>, <span class="mi">35</span>, <span class="mi">35</span>%<span class="mi">1</span>, <span class="mf">35.0</span>, <span class="mf">35.1</span>]<span class="p">;</span>
<span class="gp">&gt; </span>map <span class="kt">double</span> l<span class="p">;</span> <span class="c1">// (just to show the values in a familiar format)</span>
[<span class="mf">34.9</span>,<span class="mf">35.0</span>,<span class="mf">35.0</span>,<span class="mf">35.0</span>,<span class="mf">35.1</span>]
<span class="gp">&gt; </span>map (floor_multiple <span class="mi">10</span>) l<span class="p">;</span>
[<span class="mf">30.0</span>,<span class="mi">30L</span>,<span class="mi">30L</span>,<span class="mf">30.0</span>,<span class="mf">30.0</span>]
<span class="gp">&gt; </span>map (ceil_multiple <span class="mi">10</span>) l<span class="p">;</span>
[<span class="mf">40.0</span>,<span class="mi">40L</span>,<span class="mi">40L</span>,<span class="mf">40.0</span>,<span class="mf">40.0</span>]
<span class="gp">&gt; </span>map (trunc_multiple <span class="mi">10</span>) l<span class="p">;</span>
[<span class="mf">30.0</span>,<span class="mi">30L</span>,<span class="mi">30L</span>,<span class="mf">30.0</span>,<span class="mf">30.0</span>]
<span class="gp">&gt; </span>map (round_multiple <span class="mi">10</span>) l<span class="p">;</span>
[<span class="mf">30.0</span>,<span class="mi">40L</span>,<span class="mi">40L</span>,<span class="mf">40.0</span>,<span class="mf">40.0</span>]
<span class="gp">&gt; </span>map (round_multiple_zero_bias <span class="mi">10</span>) l<span class="p">;</span>
[<span class="mf">30.0</span>,<span class="mi">30L</span>,<span class="mi">30L</span>,<span class="mf">30.0</span>,<span class="mf">40.0</span>]
<span class="gp">&gt; </span>map (round_multiple_unbiased <span class="mi">10</span>) l<span class="p">;</span>
[<span class="mf">30.0</span>,<span class="mi">40L</span>,<span class="mi">40L</span>,<span class="mf">40.0</span>,<span class="mf">40.0</span>]
</pre></div>
</div>
<p>(See the function <a class="reference internal" href="purelib.html#double" title="double"><tt class="xref pure pure-func docutils literal"><span class="pre">double</span></tt></a>.)</p>
<p>The round multiple functions may be used to find a fixed denominator
approximation of a number. (The simplest denominator may actually be a proper
factor of the chosen value.) To approximate for a bounded (rather than
particular) denominator, use rational approx max den instead (see <a class="reference internal" href="#best-approximation-with-bounded-denominator">Best
Approximation with Bounded Denominator</a>).</p>
<p><strong>Example 31</strong> Finding the nearest q = n/d value to 1/e ≈ 0.368 where d = 1000
(actually, where d|1000):</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> co_E = exp (-<span class="mi">1</span>)<span class="p">;</span>
co_E<span class="p">;</span>
<span class="mf">0.367879441171442</span>
<span class="gp">&gt; </span>round_multiple (<span class="mi">1</span>%<span class="mi">1000</span>) (rational co_E)<span class="p">;</span>
<span class="mi">46L</span>%<span class="mi">125L</span>
<span class="gp">&gt; </span><span class="mi">1000</span> * ans<span class="p">;</span>
<span class="mi">368L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<p><strong>Example 32</strong> Finding the nearest q = n/d value to 1/φ ≈ 0.618 where d = 3<sup>5</sup> = 243 (actually, where d|243):</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> co_Phi = (sqrt <span class="mi">5</span> - <span class="mi">1</span>) / <span class="mi">2</span><span class="p">;</span>
<span class="gp">&gt; </span>round_multiple (<span class="mi">1</span>%<span class="mi">243</span>) (rational co_Phi)<span class="p">;</span>
<span class="mi">50L</span>%<span class="mi">81L</span>
</pre></div>
</div>
<p>Other methods for obtaining a rational approximation of a number are
described in <a class="reference internal" href="#r-q-approximation">R -&gt; Q — Approximation</a>.</p>
</div>
<div class="section" id="q-r-conversion-casting">
<h2><a class="toc-backref" href="#id36"><strong>Q</strong> -&gt; <strong>R</strong> — Conversion / Casting</a><a class="headerlink" href="#q-r-conversion-casting" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="double/rational">
<tt class="descname">double</tt> q<a class="headerlink" href="#double/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>(overload of built-in) returns a double having a value as close as possible
to q. (Overflow, underflow and loss of accuracy are potential problems.
rationals that are too absolutely large or too absolutely small may
overflow or underflow; some rationals can not be represented exactly as a
double.)</p>
</dd></dl>

</div>
<div class="section" id="r-q-approximation">
<h2><a class="toc-backref" href="#id37"><strong>R</strong> -&gt; <strong>Q</strong> — Approximation</a><a class="headerlink" href="#r-q-approximation" title="Permalink to this headline">¶</a></h2>
<p>This section describes functions that approximate a number (usually a
double) by a rational. See <a class="reference internal" href="#rounding-to-multiples">Rounding to Multiples</a> for approximation of
a number by a rational with a fixed denominator. See <a class="reference internal" href="#numeral-string-q-approximation">Numeral String -&gt; Q
— Approximation</a> for approximation by a rational of a string representation
of a real number.</p>
<div class="section" id="module-rat_interval">
<span id="intervals"></span><h3><a class="toc-backref" href="#id38">Intervals</a><a class="headerlink" href="#module-rat_interval" title="Permalink to this headline">¶</a></h3>
<p>Some of the approximation functions return an <strong class="dfn">interval</strong>. The file
<tt class="docutils literal"><span class="pre">rat_interval.pure</span></tt> is a basic implementation of interval arithmetic, and is
not included in the default prelude. It is not intended to provide a complete
implementation of interval arithmetic. The notions of &#8216;open&#8217; and &#8216;closed&#8217;
intervals are not distinguished. Infinite and half-infinite intervals are not
specifically provided. Some operations and functions may be missing. The most
likely functions to be used are simply the &#8216;deconstructors&#8217;; see <a class="reference internal" href="#interval-constructors-and-deconstructors">Interval
Constructors and &#8216;Deconstructors&#8217;</a>.</p>
<div class="section" id="interval-constructors-and-deconstructors">
<h4><a class="toc-backref" href="#id39">Interval Constructors and &#8216;Deconstructors&#8217;</a><a class="headerlink" href="#interval-constructors-and-deconstructors" title="Permalink to this headline">¶</a></h4>
<p>Intervals are constructed with the function interval.</p>
<dl class="function">
<dt id="interval::interval">
<tt class="descclassname">interval::</tt><tt class="descname">interval</tt> (n1, n2)<a class="headerlink" href="#interval::interval" title="Permalink to this definition">¶</a></dt>
<dd><p>given a pair of numbers (z1 &lt;= z2), this returns the interval z1..z2. This
is the inverse of <tt class="docutils literal"><span class="pre">lo_up</span></tt>.</p>
</dd></dl>

<p><strong>Example 33</strong> Constructing an interval:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> v = interval (<span class="mi">3</span>, <span class="mi">8</span>)<span class="p">;</span>
<span class="gp">&gt; </span>v<span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mi">3</span> <span class="mi">8</span>
</pre></div>
</div>
<dl class="function">
<dt id="interval::lower">
<tt class="descclassname">interval::</tt><tt class="descname">lower</tt> v<a class="headerlink" href="#interval::lower" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the infimum (roughly, minimum) of v.</p>
</dd></dl>

<dl class="function">
<dt id="interval::upper">
<tt class="descclassname">interval::</tt><tt class="descname">upper</tt> v<a class="headerlink" href="#interval::upper" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the supremum (roughly, maximum) of v.</p>
</dd></dl>

<dl class="function">
<dt id="interval::lo_up">
<tt class="descclassname">interval::</tt><tt class="descname">lo_up</tt> v<a class="headerlink" href="#interval::lo_up" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a pair (l, u) containing the lower l and upper u extrema of the
interval v. This is the inverse of interval as defined on number pairs.</p>
</dd></dl>

<p><strong>Example 34</strong> Deconstructing an interval:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>lower v<span class="p">;</span>
<span class="mi">3</span>
<span class="gp">&gt; </span>upper v<span class="p">;</span>
<span class="mi">8</span>
<span class="gp">&gt; </span>lo_up v<span class="p">;</span>
<span class="mi">3</span>,<span class="mi">8</span>
</pre></div>
</div>
</div>
<div class="section" id="interval-type-tests">
<h4><a class="toc-backref" href="#id40">Interval Type Tests</a><a class="headerlink" href="#interval-type-tests" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt>
<tt class="descname">exactp</tt> v</dt>
<dd><p>returns whether an interval v has exact extrema.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">inexactp</tt> v</dt>
<dd><p>returns whether an interval v has an inexact extremum.</p>
</dd></dl>

<dl class="function">
<dt id="interval::intervalp">
<tt class="descclassname">interval::</tt><tt class="descname">intervalp</tt> x<a class="headerlink" href="#interval::intervalp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x is of type interval.</p>
</dd></dl>

<dl class="function">
<dt id="interval::interval_valp">
<tt class="descclassname">interval::</tt><tt class="descname">interval_valp</tt> x<a class="headerlink" href="#interval::interval_valp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x has an interval value.</p>
</dd></dl>

<dl class="function">
<dt id="interval::ratinterval_valp">
<tt class="descclassname">interval::</tt><tt class="descname">ratinterval_valp</tt> x<a class="headerlink" href="#interval::ratinterval_valp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x has an interval value with rational extrema.</p>
</dd></dl>

<dl class="function">
<dt id="interval::intinterval_valp">
<tt class="descclassname">interval::</tt><tt class="descname">intinterval_valp</tt> x<a class="headerlink" href="#interval::intinterval_valp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x has an interval value with integral extrema.</p>
</dd></dl>

<p><strong>Example 35</strong> Interval value tests:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> l = [interval(<span class="mi">0</span>,<span class="mi">1</span>), interval(<span class="mi">0</span>,<span class="mi">1</span>%<span class="mi">1</span>), interval(<span class="mi">0</span>,<span class="mi">3</span>%<span class="mi">2</span>), interval(<span class="mi">0</span>,<span class="mf">1.5</span>)]<span class="p">;</span>
<span class="gp">&gt; </span>map exactp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map inexactp l<span class="p">;</span>
[<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>]
<span class="gp">&gt; </span>map intervalp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>]
<span class="gp">&gt; </span>map interval_valp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>]
<span class="gp">&gt; </span>map ratinterval_valp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>]
<span class="gp">&gt; </span>map intinterval_valp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>]
</pre></div>
</div>
</div>
<div class="section" id="interval-arithmetic-operators-and-relations">
<h4><a class="toc-backref" href="#id41">Interval Arithmetic Operators and Relations</a><a class="headerlink" href="#interval-arithmetic-operators-and-relations" title="Permalink to this headline">¶</a></h4>
<p>The standard arithmetic operators (+), (−), (*), (/) and (%) are overloaded for
intervals. The divide operators (/) and (%) do not produce a result if the
right operand is an interval containing 0.</p>
<p id="example-36"><strong>Example 36</strong> Some intervals:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> a = interval (<span class="mi">11</span>, <span class="mi">19</span>)<span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> b = interval (<span class="mi">16</span>, <span class="mi">24</span>)<span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> c = interval (<span class="mi">21</span>, <span class="mi">29</span>)<span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> d = interval (<span class="mi">23</span>, <span class="mi">27</span>)<span class="p">;</span>
</pre></div>
</div>
<p><strong>Example 37</strong> Interval arithmetic:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> p = interval (<span class="mi">0</span>, <span class="mi">1</span>)<span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> s = interval (-<span class="mi">1</span>, <span class="mi">1</span>)<span class="p">;</span>
<span class="gp">&gt; </span>a + b<span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mi">27</span> <span class="mi">43</span>
<span class="gp">&gt; </span>a - b<span class="p">;</span>
interval<span class="p">::</span>Ivl (-<span class="mi">13</span>) <span class="mi">3</span>
<span class="gp">&gt; </span>a * b<span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mi">176</span> <span class="mi">456</span>
<span class="gp">&gt; </span>p * <span class="mi">2</span><span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mi">0</span> <span class="mi">2</span>
<span class="gp">&gt; </span>(-<span class="mi">2</span>) * p<span class="p">;</span>
interval<span class="p">::</span>Ivl (-<span class="mi">2</span>) <span class="mi">0</span>
<span class="gp">&gt; </span>-c<span class="p">;</span>
interval<span class="p">::</span>Ivl (-<span class="mi">29</span>) (-<span class="mi">21</span>)
<span class="gp">&gt; </span>s * a<span class="p">;</span>
interval<span class="p">::</span>Ivl (-<span class="mi">19</span>) <span class="mi">19</span>
<span class="gp">&gt; </span>a % <span class="mi">2</span><span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">11L</span>%<span class="mi">2L</span>) (<span class="mi">19L</span>%<span class="mi">2L</span>)
<span class="gp">&gt; </span>a / <span class="mi">2</span><span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mf">5.5</span> <span class="mf">9.5</span>
<span class="gp">&gt; </span>reciprocal a<span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">1L</span>%<span class="mi">19L</span>) (<span class="mi">1L</span>%<span class="mi">11L</span>)
<span class="gp">&gt; </span><span class="mi">2</span> % a<span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">2L</span>%<span class="mi">19L</span>) (<span class="mi">2L</span>%<span class="mi">11L</span>)
<span class="gp">&gt; </span>a % b<span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">11L</span>%<span class="mi">24L</span>) (<span class="mi">19L</span>%<span class="mi">16L</span>)
<span class="gp">&gt; </span>a % a<span class="p">;</span> <span class="c1">// notice that the intervals are mutually independent here</span>
interval<span class="p">::</span>Ivl (<span class="mi">11L</span>%<span class="mi">19L</span>) (<span class="mi">19L</span>%<span class="mi">11L</span>)
</pre></div>
</div>
<p>There are also some relations defined for intervals. The standard relations
(==) and (~=) are overloaded.</p>
<p>However, rather than overloading (&lt;), (&lt;=), (&gt;), (&gt;=), which could be used for
either ordering or containment with some ambiguity, the module defines
<tt class="docutils literal"><span class="pre">(before)</span></tt>, <tt class="docutils literal"><span class="pre">(within)</span></tt>, and so on. &#8216;Strictness&#8217; refers to the properties at
the end-points.</p>
<dl class="function">
<dt id="interval::before">
v1 <tt class="descclassname">interval::</tt><tt class="descname">before</tt> v2<a class="headerlink" href="#interval::before" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 is entirely before v2.</p>
</dd></dl>

<dl class="function">
<dt id="interval::strictly_before">
v1 <tt class="descclassname">interval::</tt><tt class="descname">strictly_before</tt> v2<a class="headerlink" href="#interval::strictly_before" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 is strictly entirely before v2.</p>
</dd></dl>

<dl class="function">
<dt id="interval::after">
v1 <tt class="descclassname">interval::</tt><tt class="descname">after</tt> v2<a class="headerlink" href="#interval::after" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 is entirely after v2.</p>
</dd></dl>

<dl class="function">
<dt id="interval::strictly_after">
v1 <tt class="descclassname">interval::</tt><tt class="descname">strictly_after</tt> v2<a class="headerlink" href="#interval::strictly_after" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 is strictly entirely after v2.</p>
</dd></dl>

<dl class="function">
<dt id="interval::within">
v1 <tt class="descclassname">interval::</tt><tt class="descname">within</tt> v2<a class="headerlink" href="#interval::within" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 is entirely within v2; i.e. whether v1 is subinterval of
v2.</p>
</dd></dl>

<dl class="function">
<dt id="interval::strictly_within">
v1 <tt class="descclassname">interval::</tt><tt class="descname">strictly_within</tt> v2<a class="headerlink" href="#interval::strictly_within" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 is strictly entirely within v2; i.e. whether v1 is proper
subinterval of v2.</p>
</dd></dl>

<dl class="function">
<dt id="interval::without">
v1 <tt class="descclassname">interval::</tt><tt class="descname">without</tt> v2<a class="headerlink" href="#interval::without" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 entirely contains v2; i.e. whether v1 is superinterval of
v2. &#8216;Without&#8217; is used in the sense of outside or around.</p>
</dd></dl>

<dl class="function">
<dt id="interval::strictly_without">
v1 <tt class="descclassname">interval::</tt><tt class="descname">strictly_without</tt> v2<a class="headerlink" href="#interval::strictly_without" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 strictly entirely contains v2; i.e. whether v1 is proper
superinterval of v2.</p>
</dd></dl>

<dl class="function">
<dt id="interval::disjoint">
v1 <tt class="descclassname">interval::</tt><tt class="descname">disjoint</tt> v2<a class="headerlink" href="#interval::disjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 and v2 are entirely disjoint.</p>
</dd></dl>

<dl class="function">
<dt id="interval::strictly_disjoint">
v <tt class="descclassname">interval::</tt><tt class="descname">strictly_disjoint</tt> v2<a class="headerlink" href="#interval::strictly_disjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether v1 and v2 are entirely strictly disjoint.</p>
</dd></dl>

<p><strong>Example 38</strong> Interval relations:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>a == b<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>a == a<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>a before b<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>a before c<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>c before a<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>a disjoint b<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>c disjoint a<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>a within b<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>a within c<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>d within c<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>c within d<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>a strictly_within a<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>a within a<span class="p">;</span>
<span class="mi">1</span>
</pre></div>
</div>
<p>(The symbols a through d were defined in <a class="reference internal" href="#example-36">Example 36</a>.)</p>
<p>These may also be used with a simple (real) value, and in particular to test
membership.</p>
<p><strong>Example 39</strong> Membership:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="mi">10</span> within a<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span><span class="mi">11</span> within a<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span><span class="mf">11.0</span> within a<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span><span class="mi">12</span> within a<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span><span class="mf">12.0</span> within a<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span><span class="mi">10</span> strictly_within a<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span><span class="mi">11</span> strictly_within a<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>(<span class="mi">11</span>%<span class="mi">1</span>) strictly_within a<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span><span class="mi">12</span> strictly_within a<span class="p">;</span>
<span class="mi">1</span>
<span class="gp">&gt; </span>(<span class="mi">12</span>%<span class="mi">1</span>) strictly_within a<span class="p">;</span>
<span class="mi">1</span>
</pre></div>
</div>
<p>(The symbol a was defined in <a class="reference internal" href="#example-36">Example 36</a>.)</p>
</div>
<div class="section" id="interval-maths">
<h4><a class="toc-backref" href="#id42">Interval Maths</a><a class="headerlink" href="#interval-maths" title="Permalink to this headline">¶</a></h4>
<p>Some standard functions are overloaded for intervals; some new functions are
provided.</p>
<dl class="function">
<dt>
<tt class="descname">abs</tt> v</dt>
<dd><p>returns the interval representing the range of (x) as x varies over v.</p>
</dd></dl>

<p><strong>Example 40</strong> Absolute interval:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>abs (interval (<span class="mi">1</span>, <span class="mi">5</span>))<span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mi">1</span> <span class="mi">5</span>
<span class="gp">&gt; </span>abs (interval (-<span class="mi">1</span>, <span class="mi">5</span>))<span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mi">0</span> <span class="mi">5</span>
<span class="gp">&gt; </span>abs (interval (-<span class="mi">5</span>, -<span class="mi">1</span>))<span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mi">1</span> <span class="mi">5</span>
</pre></div>
</div>
<dl class="function">
<dt>
<tt class="descname">sgn</tt> v</dt>
<dd><p>returns the interval representing the range of sgn(x) as x varies over v.</p>
</dd></dl>

<dl class="function">
<dt id="#/rational">
<tt class="descname">#</tt> v<a class="headerlink" href="##/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the length of an interval.</p>
</dd></dl>

<p><strong>Example 41</strong> Absolute interval:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>#d<span class="p">;</span>
<span class="mi">4</span>
</pre></div>
</div>
<p>(The symbol d was defined in <a class="reference internal" href="#example-36">Example 36</a>.)</p>
</div>
</div>
<div class="section" id="least-complex-approximation-within-epsilon">
<h3><a class="toc-backref" href="#id43">Least Complex Approximation within Epsilon</a><a class="headerlink" href="#least-complex-approximation-within-epsilon" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::rational_approx_epsilon">
<tt class="descclassname">rational::</tt><tt class="descname">rational_approx_epsilon</tt> ε r<a class="headerlink" href="#rational::rational_approx_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the least complex (see <a class="reference internal" href="#complexity-extrema">Complexity Extrema</a>) rational approximation
to r (usually a double) that is ε-close. That is find the q with the
smallest possible denominator such that such that |q − r| ≤ ε. (ε &gt; 0.)</p>
</dd></dl>

<p><strong>Example 42</strong> Rational approximation to π ≈ 3.142 ≈ 22/7:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_approx_epsilon .<span class="mo">01</span> pi<span class="p">;</span>
<span class="mi">22L</span>%<span class="mi">7L</span>
<span class="gp">&gt; </span>abs (ans - pi)<span class="p">;</span>
<span class="mf">0.00126448926734968</span>
</pre></div>
</div>
<p id="example-43"><strong>Example 43</strong> The golden ratio φ = (1 + √5) / 2 ≈ 1.618:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> phi = (<span class="mi">1</span> + sqrt <span class="mi">5</span>) / <span class="mi">2</span><span class="p">;</span>
<span class="gp">&gt; </span>rational_approx_epsilon .<span class="mo">001</span> phi<span class="p">;</span>
<span class="mi">55L</span>%<span class="mi">34L</span>
<span class="gp">&gt; </span>abs (ans - phi)<span class="p">;</span>
<span class="mf">0.000386929926365465</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::rational_approxs_epsilon">
<tt class="descclassname">rational::</tt><tt class="descname">rational_approxs_epsilon</tt> ε r<a class="headerlink" href="#rational::rational_approxs_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a list of ever better rational approximations to r (usually a
double) that is eventually ε-close. (ε &gt; 0.)</p>
</dd></dl>

<p><strong>Example 44</strong> Rational approximations to π:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_approxs_epsilon .<span class="mo">0001</span> pi<span class="p">;</span>
[<span class="mi">3L</span>%<span class="mi">1L</span>,<span class="mi">25L</span>%<span class="mi">8L</span>,<span class="mi">47L</span>%<span class="mi">15L</span>,<span class="mi">69L</span>%<span class="mi">22L</span>,<span class="mi">91L</span>%<span class="mi">29L</span>,<span class="mi">113L</span>%<span class="mi">36L</span>,<span class="mi">135L</span>%<span class="mi">43L</span>,<span class="mi">157L</span>%<span class="mi">50L</span>,<span class="mi">179L</span>%<span class="mi">57L</span>,
<span class="mi">201L</span>%<span class="mi">64L</span>,<span class="mi">223L</span>%<span class="mi">71L</span>,<span class="mi">245L</span>%<span class="mi">78L</span>,<span class="mi">267L</span>%<span class="mi">85L</span>,<span class="mi">289L</span>%<span class="mi">92L</span>,<span class="mi">311L</span>%<span class="mi">99L</span>,<span class="mi">333L</span>%<span class="mi">106L</span>]
</pre></div>
</div>
<p><strong>Example 45</strong> Rational approximations to the golden ratio φ; these
approximations are always reverse consecutive Fibonacci numbers (from f1: 1, 1,
2, 3, 5, 8, 13, 21, 34, 55, 89, ...):</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_approxs_epsilon .<span class="mo">0001</span> phi<span class="p">;</span>
[<span class="mi">1L</span>%<span class="mi">1L</span>,<span class="mi">3L</span>%<span class="mi">2L</span>,<span class="mi">8L</span>%<span class="mi">5L</span>,<span class="mi">21L</span>%<span class="mi">13L</span>,<span class="mi">55L</span>%<span class="mi">34L</span>,<span class="mi">144L</span>%<span class="mi">89L</span>]
</pre></div>
</div>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<dl class="function">
<dt id="rational::rational_interval_epsilon">
<tt class="descclassname">rational::</tt><tt class="descname">rational_interval_epsilon</tt> ε r<a class="headerlink" href="#rational::rational_interval_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the least complex (see <a class="reference internal" href="#complexity-extrema">Complexity Extrema</a>) rational interval
containing r (usually a double) that is ε-small. That is find the least
complex (see <a class="reference internal" href="#complexity-extrema">Complexity Extrema</a>) q1 ≤ q2 such that r ∈ [q1, q2] and
q2 − q1 ≤ ε. (ε &gt; 0.)</p>
</dd></dl>

<p><strong>Example 46</strong> Rational interval surrounding π:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> i_Pi = rational_interval_epsilon .<span class="mo">01</span> pi<span class="p">;</span>
<span class="gp">&gt; </span>i_Pi<span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">47L</span>%<span class="mi">15L</span>) (<span class="mi">22L</span>%<span class="mi">7L</span>)
<span class="gp">&gt; </span><span class="kt">double</span> (lower i_Pi)<span class="p">;</span> pi<span class="p">;</span> <span class="kt">double</span> (upper i_Pi)<span class="p">;</span>
<span class="mf">3.13333333333333</span>
<span class="mf">3.14159265358979</span>
<span class="mf">3.14285714285714</span>
</pre></div>
</div>
<p>(The functions lower and upper are described in <a class="reference internal" href="#interval-constructors-and-deconstructors">Interval Constructors and
&#8216;Deconstructors&#8217;</a>.)</p>
<p><strong>Example 47</strong> Rational interval surrounding the golden ratio φ:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_interval_epsilon .<span class="mo">001</span> phi<span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">55L</span>%<span class="mi">34L</span>) (<span class="mi">89L</span>%<span class="mi">55L</span>)
<span class="gp">&gt; </span>#ans<span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">1870L</span>
</pre></div>
</div>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>. The function <tt class="xref pure pure-func docutils literal"><span class="pre">#</span></tt>
is described in <a class="reference internal" href="#interval-maths">Interval Maths</a>.)</p>
</div>
<div class="section" id="best-approximation-with-bounded-denominator">
<h3><a class="toc-backref" href="#id44">Best Approximation with Bounded Denominator</a><a class="headerlink" href="#best-approximation-with-bounded-denominator" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::rational_approx_max_den">
<tt class="descclassname">rational::</tt><tt class="descname">rational_approx_max_den</tt> maxDen r<a class="headerlink" href="#rational::rational_approx_max_den" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the closest rational approximation to r (usually a double) that
has a denominator no greater than maxDen. (maxDen &gt; 0).</p>
</dd></dl>

<p><strong>Example 48</strong> Rational approximation to π:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_approx_max_den <span class="mi">10</span> pi<span class="p">;</span>
<span class="mi">22L</span>%<span class="mi">7L</span>
</pre></div>
</div>
<p><strong>Example 49</strong> Rational approximation to the golden ratio φ:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_approx_max_den <span class="mi">1000</span> phi<span class="p">;</span>
<span class="mi">1597L</span>%<span class="mi">987L</span>
</pre></div>
</div>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<dl class="function">
<dt id="rational::rational_approxs_max_den">
<tt class="descclassname">rational::</tt><tt class="descname">rational_approxs_max_den</tt> maxDen r<a class="headerlink" href="#rational::rational_approxs_max_den" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a list of ever better rational approximations to r (usually a
double) while the denominator is bounded by maxDen (maxDen &gt; 0).</p>
</dd></dl>

<p><strong>Example 50</strong> Rational approximations to π:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_approxs_max_den <span class="mi">100</span> pi<span class="p">;</span>
[<span class="mi">3L</span>%<span class="mi">1L</span>,<span class="mi">25L</span>%<span class="mi">8L</span>,<span class="mi">47L</span>%<span class="mi">15L</span>,<span class="mi">69L</span>%<span class="mi">22L</span>,<span class="mi">91L</span>%<span class="mi">29L</span>,<span class="mi">113L</span>%<span class="mi">36L</span>,<span class="mi">135L</span>%<span class="mi">43L</span>,<span class="mi">157L</span>%<span class="mi">50L</span>,<span class="mi">179L</span>%<span class="mi">57L</span>,
<span class="mi">201L</span>%<span class="mi">64L</span>,<span class="mi">223L</span>%<span class="mi">71L</span>,<span class="mi">245L</span>%<span class="mi">78L</span>,<span class="mi">267L</span>%<span class="mi">85L</span>,<span class="mi">289L</span>%<span class="mi">92L</span>,<span class="mi">311L</span>%<span class="mi">99L</span>]
</pre></div>
</div>
<p><strong>Example 51</strong> Rational approximations to the golden ratio φ:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_approxs_max_den <span class="mi">100</span> phi<span class="p">;</span>
[<span class="mi">1L</span>%<span class="mi">1L</span>,<span class="mi">3L</span>%<span class="mi">2L</span>,<span class="mi">8L</span>%<span class="mi">5L</span>,<span class="mi">21L</span>%<span class="mi">13L</span>,<span class="mi">55L</span>%<span class="mi">34L</span>,<span class="mi">144L</span>%<span class="mi">89L</span>]
</pre></div>
</div>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<dl class="function">
<dt id="rational::rational_interval_max_den">
<tt class="descclassname">rational::</tt><tt class="descname">rational_interval_max_den</tt> maxDen r<a class="headerlink" href="#rational::rational_interval_max_den" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the smallest rational interval containing r (usually a double)
that has endpoints with denominators no greater than maxDen (maxDen &gt; 0).</p>
</dd></dl>

<p><strong>Example 52</strong> Rational interval surrounding π:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> i_Pi = rational_interval_max_den <span class="mi">100</span> pi <span class="p">;</span> i_Pi<span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">311L</span>%<span class="mi">99L</span>) (<span class="mi">22L</span>%<span class="mi">7L</span>)
<span class="gp">&gt; </span><span class="kt">double</span> (lower i_Pi)<span class="p">;</span> pi<span class="p">;</span> <span class="kt">double</span> (upper i_Pi)<span class="p">;</span>
<span class="mf">3.14141414141414</span>
<span class="mf">3.14159265358979</span>
<span class="mf">3.14285714285714</span>
</pre></div>
</div>
<p><strong>Example 53</strong> Rational interval surrounding the golden ratio φ:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>rational_interval_max_den <span class="mi">1000</span> phi<span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">987L</span>%<span class="mi">610L</span>) (<span class="mi">1597L</span>%<span class="mi">987L</span>)
</pre></div>
</div>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<p>To approximate for a particular (rather than bounded) denominator, use round to
multiple instead (see <a class="reference internal" href="#rounding-to-multiples">Rounding to Multiples</a>).</p>
</div>
</div>
<div class="section" id="decomposition">
<h2><a class="toc-backref" href="#id45">Decomposition</a><a class="headerlink" href="#decomposition" title="Permalink to this headline">¶</a></h2>
<p>There is more than one way to &#8216;decompose&#8217; a rational number into its
&#8216;components&#8217;. It might be split into an integer and a fraction part — see
<a class="reference internal" href="#integer-and-fraction-parts">Integer and Fraction Parts</a>; or sign and absolute value — see <a class="reference internal" href="#absolute-value-and-sign">Absolute Value
and Sign</a>; or numerator and denominator — see <a class="reference internal" href="#deconstructors">&#8216;Deconstructors&#8217;</a>.</p>
</div>
<div class="section" id="continued-fractions">
<h2><a class="toc-backref" href="#id46">Continued Fractions</a><a class="headerlink" href="#continued-fractions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id47">Introduction</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>In &#8220;pure-rational&#8221;, a continued fraction
a<sub>0</sub> + (1 / (a<sub>1</sub> + (1 / (a<sub>2</sub> + ··· + 1 / a<sub>n</sub>)))) where ∀i &gt; 0 • a<sub>i</sub> ≠ 0, is represented by [a<sub>0</sub>, a<sub>1</sub>, a<sub>2</sub>, ... , a<sub>n</sub>].</p>
<p>A &#8216;simple&#8217; continued fraction is one in which ∀i • a<sub>i</sub> ∈ <strong>Z</strong> and ∀i &gt;
0 • a<sub>i</sub> &gt; 0.</p>
<p>Simple continued fractions for rationals are not quite unique since [a<sub>0</sub>, a<sub>1</sub>, ... , a<sub>n</sub>, 1] = [a<sub>0</sub>, a<sub>1</sub>,
... , a<sub>n+1</sub>]. We will refer to these as the &#8216;non-standard&#8217; and
&#8216;standard&#8217; forms, respectively. The following functions return the standard
form.</p>
</div>
<div class="section" id="generating-continued-fractions">
<h3><a class="toc-backref" href="#id48">Generating Continued Fractions</a><a class="headerlink" href="#generating-continued-fractions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="exact">
<h4><a class="toc-backref" href="#id49">Exact</a><a class="headerlink" href="#exact" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::continued_fraction">
<tt class="descclassname">rational::</tt><tt class="descname">continued_fraction</tt> q<a class="headerlink" href="#rational::continued_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Find &#8216;the&#8217; (exact) continued fraction of a rational (including, trivially,
integer) value q.</p>
</dd></dl>

<p><strong>Example 54</strong> The rational 1234/1001:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>continued_fraction (<span class="mi">1234</span>%<span class="mi">1001</span>)<span class="p">;</span>
[<span class="mi">1L</span>,<span class="mi">4L</span>,<span class="mi">3L</span>,<span class="mi">2L</span>,<span class="mi">1L</span>,<span class="mi">1L</span>,<span class="mi">1L</span>,<span class="mi">8L</span>]
<span class="gp">&gt; </span>evaluate_continued_fraction ans<span class="p">;</span>
<span class="mi">1234L</span>%<span class="mi">1001L</span>
</pre></div>
</div>
</div>
<div class="section" id="inexact">
<h4><a class="toc-backref" href="#id50">Inexact</a><a class="headerlink" href="#inexact" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::continued_fraction_max_terms">
<tt class="descclassname">rational::</tt><tt class="descname">continued_fraction_max_terms</tt> n r<a class="headerlink" href="#rational::continued_fraction_max_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Find up to n initial terms of continued fraction of the value r with the
&#8216;remainder&#8217;, if any, in the final element. (If continued_fraction_max_terms
n r returns a list of length n or less, then the result is exact.)</p>
</dd></dl>

<p><strong>Example 55</strong> First 5 terms of the continued fraction for the golden ratio φ:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>continued_fraction_max_terms <span class="mi">5</span> phi<span class="p">;</span>
  [<span class="mf">1.0</span>,<span class="mf">1.0</span>,<span class="mf">1.0</span>,<span class="mf">1.0</span>,<span class="mf">1.0</span>,<span class="mf">1.61803398874989</span>]
<span class="gp">&gt; </span>evaluate_continued_fraction ans<span class="p">;</span>
<span class="mf">1.61803398874989</span>
</pre></div>
</div>
<p>(The symbol phi was defined in <a class="reference internal" href="#example-43">Example 43</a>.)</p>
<dl class="function">
<dt id="rational::continued_fraction_epsilon">
<tt class="descclassname">rational::</tt><tt class="descname">continued_fraction_epsilon</tt> ε r<a class="headerlink" href="#rational::continued_fraction_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Find enough of the initial terms of a continued fraction to within ε of the
value r with the &#8216;remainder&#8217;, if any, in the final element.</p>
</dd></dl>

<p><strong>Example 56</strong> First few terms of the value √2:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>continued_fraction_epsilon .<span class="mo">001</span> (sqrt <span class="mi">2</span>)<span class="p">;</span>
[<span class="mf">1.0</span>,<span class="mf">2.0</span>,<span class="mf">2.0</span>,<span class="mf">2.0</span>,<span class="mf">2.0</span>,<span class="mf">2.41421356237241</span>]
<span class="gp">&gt; </span>map <span class="kt">double</span> (convergents ans)<span class="p">;</span>
[<span class="mf">1.0</span>,<span class="mf">1.5</span>,<span class="mf">1.4</span>,<span class="mf">1.41666666666667</span>,<span class="mf">1.41379310344828</span>,<span class="mf">1.41421356237309</span>]
</pre></div>
</div>
</div>
</div>
<div class="section" id="evaluating-continued-fractions">
<h3><a class="toc-backref" href="#id51">Evaluating Continued Fractions</a><a class="headerlink" href="#evaluating-continued-fractions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::evaluate_continued_fraction">
<tt class="descclassname">rational::</tt><tt class="descname">evaluate_continued_fraction</tt> aa<a class="headerlink" href="#rational::evaluate_continued_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Fold a continued fraction aa into the value it represents. This function is
not limited to simple continued fractions. (Exact simple continued
fractions are folded into a rational.)</p>
</dd></dl>

<p><strong>Example 57</strong> The continued fraction [1, 2, 3, 4] and the non-standard form [4,
3, 2, 1]:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>evaluate_continued_fraction [<span class="mi">1</span>,<span class="mi">2</span>,<span class="mi">3</span>,<span class="mi">4</span>]<span class="p">;</span>
<span class="mi">43L</span>%<span class="mi">30L</span>
<span class="gp">&gt; </span>continued_fraction ans<span class="p">;</span>
[<span class="mi">1L</span>,<span class="mi">2L</span>,<span class="mi">3L</span>,<span class="mi">4L</span>]
<span class="gp">&gt; </span>evaluate_continued_fraction [<span class="mi">4</span>,<span class="mi">3</span>,<span class="mi">2</span>,<span class="mi">1</span>]<span class="p">;</span>
<span class="mi">43L</span>%<span class="mi">10L</span>
<span class="gp">&gt; </span>continued_fraction ans<span class="p">;</span>
[<span class="mi">4L</span>,<span class="mi">3L</span>,<span class="mi">3L</span>]
</pre></div>
</div>
<div class="section" id="convergents">
<h4><a class="toc-backref" href="#id52">Convergents</a><a class="headerlink" href="#convergents" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::convergents">
<tt class="descclassname">rational::</tt><tt class="descname">convergents</tt> aa<a class="headerlink" href="#rational::convergents" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the convergents of the continued fraction aa. This function is not
limited to simple continued fractions.</p>
</dd></dl>

<p><strong>Example 58</strong> Convergents of a continued fraction approximation of the value
√2:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>continued_fraction_max_terms <span class="mi">5</span> (sqrt <span class="mi">2</span>)<span class="p">;</span>
[<span class="mf">1.0</span>,<span class="mf">2.0</span>,<span class="mf">2.0</span>,<span class="mf">2.0</span>,<span class="mf">2.0</span>,<span class="mf">2.41421356237241</span>]
<span class="gp">&gt; </span>convergents ans<span class="p">;</span>
[<span class="mf">1.0</span>,<span class="mf">1.5</span>,<span class="mf">1.4</span>,<span class="mf">1.41666666666667</span>,<span class="mf">1.41379310344828</span>,<span class="mf">1.41421356237309</span>]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rational-complex-numbers">
<h2><a class="toc-backref" href="#id53">Rational Complex Numbers</a><a class="headerlink" href="#rational-complex-numbers" title="Permalink to this headline">¶</a></h2>
<p>Pure together with <tt class="docutils literal"><span class="pre">rational.pure</span></tt> provide various types of number, including
integers (<strong>Z</strong>), doubles (<strong>R</strong>, roughly), complex numbers (<strong>C</strong>)
and Gaussian integers (<strong>Z</strong>[i]), rationals (<strong>Q</strong>) and rational complex
numbers (<strong>Q</strong>[i]).</p>
<p>Functions concerning &#8216;complex numbers&#8217; are named with &#8216;comp&#8217;, whereas functions
concerning &#8216;complexity&#8217; (see <a class="reference internal" href="#complexity">Complexity</a>) are named with &#8216;cplx&#8217;.</p>
<div class="section" id="rational-complex-constructors-and-deconstructors">
<h3><a class="toc-backref" href="#id54">Rational Complex Constructors and &#8216;Deconstructors&#8217;</a><a class="headerlink" href="#rational-complex-constructors-and-deconstructors" title="Permalink to this headline">¶</a></h3>
<p>Complex numbers can have rational parts.</p>
<p><strong>Example 59</strong> Forming a rational complex:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="mi">1</span> +: <span class="mi">1</span> * (<span class="mi">1</span>%<span class="mi">2</span>)<span class="p">;</span>
<span class="mi">1</span>+:<span class="mi">1L</span>%<span class="mi">2L</span>
<span class="gp">&gt; </span>ans * ans<span class="p">;</span>
<span class="mi">3L</span>%<span class="mi">4L</span>+:<span class="mi">1L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<p>And rational numbers can be given complex parts.</p>
<p><strong>Example 60</strong> Complex rationals and complicated rationals:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>(<span class="mi">1</span> +: <span class="mi">2</span>) % (<span class="mi">3</span> +: <span class="mi">4</span>)<span class="p">;</span>
<span class="mi">11L</span>%<span class="mi">25L</span>+:<span class="mi">2L</span>%<span class="mi">25L</span>
<span class="gp">&gt; </span>ans * (<span class="mi">3</span> +: <span class="mi">4</span>)<span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">1L</span>+:<span class="mi">2L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>((<span class="mi">4</span>%<span class="mi">1</span>) * (<span class="mi">0</span> +: <span class="mi">1</span>)) % <span class="mi">2</span><span class="p">;</span>
<span class="mi">0L</span>%<span class="mi">1L</span>+:<span class="mi">2L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>((<span class="mi">4</span>%<span class="mi">1</span>) * (<span class="mi">0</span> +: <span class="mi">1</span>)) % (<span class="mi">1</span>%<span class="mi">2</span>)<span class="p">;</span>
<span class="mi">0L</span>%<span class="mi">1L</span>+:<span class="mi">8L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>((<span class="mi">4</span>%<span class="mi">1</span>) * (<span class="mi">0</span> +: <span class="mi">1</span>)) % (<span class="mi">1</span> + (<span class="mi">1</span>%<span class="mi">2</span>) * (<span class="mi">0</span> +: <span class="mi">1</span>))<span class="p">;</span>
<span class="mi">8L</span>%<span class="mi">5L</span>+:<span class="mi">16L</span>%<span class="mi">5L</span>
<span class="gp">&gt; </span>ans * (<span class="mi">1</span>+(<span class="mi">1</span>%<span class="mi">2</span>) * (<span class="mi">0</span> +: <span class="mi">1</span>))<span class="p">;</span>
<span class="mi">0L</span>%<span class="mi">1L</span>+:<span class="mi">4L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>((<span class="mi">4</span>%<span class="mi">1</span>) * (<span class="mi">0</span> +: <span class="mi">1</span>)) / (<span class="mi">1</span> + (<span class="mi">1</span>%<span class="mi">2</span>) * (<span class="mi">0</span> +: <span class="mi">1</span>))<span class="p">;</span>
<span class="mf">1.6</span>+:<span class="mf">3.2</span>
</pre></div>
</div>
<p>The various parts of a complex rational may be deconstructed using combinations
of num and den and the standard functions re and im.</p>
<p>Thus, taking real and imaginary parts first, a rational complex number may be
considered to be (x<sub>n</sub> / x<sub>d</sub>) + (y<sub>n</sub> / y<sub>d</sub>) * i
with x<sub>n</sub>, x<sub>d</sub>, y<sub>n</sub>, y<sub>d</sub> ∈ <strong>Z</strong>.</p>
<p>A rational complex number may also be decomposed into its &#8216;numerator&#8217; and
&#8216;denominator&#8217;, where these are both integral complex numbers, or &#8216;Gaussian
integers&#8217;, and the denominatoris a minimal choice in some sense.</p>
<p>One way to do this is so that the denominator is the minimum positive integer.
The denominator is a complex number with zero imaginary part.</p>
<p>Thus, taking numerator and denominator parts first, a rational complex number
may be considered to be (n<sub>x</sub> + n<sub>y</sub> * i) / (d + 0 * i) with n<sub>x</sub>, n<sub>y</sub>, d ∈ <strong>Z</strong>.</p>
<p>Another way to do this is so that the denominator is a Gaussian integer with
minimal absolute value. Thus, taking numerator and denominator parts first, a
rational complex number may be considered to be (n<sub>x</sub> + n<sub>y</sub> * i)
/ (d<sub>x</sub> + d<sub>y</sub> * i) with n<sub>x</sub>, n<sub>y</sub>, d<sub>x</sub>, d<sub>y</sub> ∈ <strong>Z</strong>.</p>
<p>The d<sub>x</sub>, d<sub>y</sub> are not unique, but can be chosen such that d<sub>x</sub> &gt; 0 and either |d<sub>y</sub>| &lt; d<sub>x</sub> or d<sub>y</sub> = d<sub>x</sub> &gt; 0.</p>
<dl class="function">
<dt id="rational::num_den_nat">
<tt class="descclassname">rational::</tt><tt class="descname">num_den_nat</tt> c<a class="headerlink" href="#rational::num_den_nat" title="Permalink to this definition">¶</a></dt>
<dd><p>given a complex rational or integer c, returns a pair (n, d)
containing an integral complex (Gaussian integral) numerator n, and the
smallest natural (i.e. positive integral real) complex denominator d,
i.e. a complex number where ℜ(d) ∈ <strong>Z</strong>, ℜ(d) &gt; 0, ℑ(d) = 0; i.e. the
numerator and denominator of one &#8216;normalised&#8217; form of c.</p>
<p>This is an inverse (up to equivalence) of rational as defined on integral
complex pairs (see <a class="reference internal" href="#constructors">Constructors</a>).</p>
</dd></dl>

<dl class="function">
<dt id="rational::num_den_gauss">
<tt class="descclassname">rational::</tt><tt class="descname">num_den_gauss</tt> c<a class="headerlink" href="#rational::num_den_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>given a complex rational or integer c, returns a pair (n, d)
containing an integral complex (Gaussian integral) numerator n, and an
absolutely smallest integral complex denominator d chosen s.t. ℜ(d),=(d) ∈
<strong>Z</strong>, ℜ(d) &gt; 0, and either |ℜ(d)| &lt; ℑ(d) or ℜ(d) = ℑ(d) &gt; 0; i.e. the
numerator and denominator of another &#8216;normalised&#8217; form of c.</p>
<p>This is an inverse (up to equivalence) of rational as defined on integral
complex pairs (see <a class="reference internal" href="#constructors">Constructors</a>).</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">rational::</tt><tt class="descname">num_den</tt> c</dt>
<dd><p>synonymous with num_den_gauss.</p>
<p>This is an inverse (up to equivalence) of rational as defined on integer
pairs (see <a class="reference internal" href="#constructors">Constructors</a>).</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">num</tt> c</dt>
<dd><p>given a complex rational or integer c, returns just the numerator
of the normalised form of c given by num_den c.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descname">den</tt> c</dt>
<dd><p>given a complex rational or integer c, returns just the
denominator of the normalised form of c given by num_den c.</p>
</dd></dl>

<p><strong>Example 61</strong> Rational complex number deconstruction:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> cq = (<span class="mi">1</span>+<span class="mi">2</span>*i)%(<span class="mi">3</span>+<span class="mi">3</span>*i)<span class="p">;</span> cq<span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">2L</span>+:<span class="mi">1L</span>%<span class="mi">6L</span>
<span class="gp">&gt; </span>(re cq, im cq)<span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">2L</span>,<span class="mi">1L</span>%<span class="mi">6L</span>
<span class="gp">&gt; </span>(num . re) cq<span class="p">;</span>
<span class="mi">1L</span>
<span class="gp">&gt; </span>(den . re) cq<span class="p">;</span>
<span class="mi">2L</span>
<span class="gp">&gt; </span>(num . im) cq<span class="p">;</span>
<span class="mi">1L</span>
<span class="gp">&gt; </span>(den . im) cq<span class="p">;</span>
<span class="mi">6L</span>
<span class="gp">&gt; </span><span class="kr">let</span> (n_nat,d_nat) = num_den_nat cq<span class="p">;</span>
<span class="gp">&gt; </span>(n_nat, d_nat)<span class="p">;</span>
<span class="mi">3</span>+:<span class="mi">1</span>,<span class="mi">6</span>+:<span class="mi">0</span>
<span class="gp">&gt; </span>n_nat % d_nat<span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">2L</span>+:<span class="mi">1L</span>%<span class="mi">6L</span>
<span class="gp">&gt; </span>abs d_nat<span class="p">;</span>
<span class="mf">6.0</span>
<span class="gp">&gt; </span><span class="kr">let</span> (n, d) = num_den_gauss cq<span class="p">;</span> (n, d)<span class="p">;</span>
<span class="mi">1L</span>+:<span class="mi">2L</span>,<span class="mi">3L</span>+:<span class="mi">3L</span>
<span class="gp">&gt; </span><span class="kr">let</span> (n,d) = num_den cq<span class="p">;</span> (n, d)<span class="p">;</span>
<span class="mi">1L</span>+:<span class="mi">2L</span>,<span class="mi">3L</span>+:<span class="mi">3L</span>
<span class="gp">&gt; </span>n % d<span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">2L</span>+:<span class="mi">1L</span>%<span class="mi">6L</span>
<span class="gp">&gt; </span>abs d<span class="p">;</span>
<span class="mf">4.24264068711928</span>
<span class="gp">&gt; </span>(re . num) cq<span class="p">;</span>
<span class="mi">1L</span>
<span class="gp">&gt; </span>(im . num) cq<span class="p">;</span>
<span class="mi">2L</span>
<span class="gp">&gt; </span>(re . den) cq<span class="p">;</span> <span class="c1">//always &gt; 0</span>
<span class="mi">3L</span>
<span class="gp">&gt; </span>(im . den) cq<span class="p">;</span> <span class="c1">//always &lt;= (re.den)</span>
<span class="mi">3L</span>
</pre></div>
</div>
</div>
<div class="section" id="rational-complex-type-and-value-tests">
<h3><a class="toc-backref" href="#id55">Rational Complex Type and Value Tests</a><a class="headerlink" href="#rational-complex-type-and-value-tests" title="Permalink to this headline">¶</a></h3>
<p>Beware that <tt class="docutils literal"><span class="pre">intcompvalp</span></tt> and <tt class="docutils literal"><span class="pre">ratcompvapl</span></tt> may return 1 even if the value
is of complex type with double parts. However, these functions may be
combined with <tt class="docutils literal"><span class="pre">exactp</span></tt>.</p>
<dl class="function">
<dt id="complexp/rational">
<tt class="descname">complexp</tt> x<a class="headerlink" href="#complexp/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>standard function; returns whether x is of complex type.</p>
</dd></dl>

<dl class="function">
<dt id="compvalp/rational">
<tt class="descname">compvalp</tt> x<a class="headerlink" href="#compvalp/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>standard function; returns whether x has a complex value (∈ <strong>C</strong> =
<strong>R</strong>[i]).</p>
</dd></dl>

<dl class="function">
<dt id="rational::ratcompvalp">
<tt class="descclassname">rational::</tt><tt class="descname">ratcompvalp</tt> x<a class="headerlink" href="#rational::ratcompvalp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x has a rational complex value (∈ <strong>Q</strong>[i]).</p>
</dd></dl>

<dl class="function">
<dt id="rational::intcompvalp">
<tt class="descclassname">rational::</tt><tt class="descname">intcompvalp</tt> x<a class="headerlink" href="#rational::intcompvalp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether x has an integral complex value (∈ <strong>Z</strong>[i]), i.e. a
Gaussian  integer value.</p>
</dd></dl>

<p><strong>Example 62</strong> Rational complex number value tests:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> l = [<span class="mi">9</span>, <span class="mi">9</span>%<span class="mi">1</span>, <span class="mi">9</span>%<span class="mi">2</span>, <span class="mf">4.5</span>, sqrt <span class="mi">2</span>, <span class="mi">1</span>+:<span class="mi">1</span>, <span class="mi">1</span>%<span class="mi">2</span>+:<span class="mi">1</span>, <span class="mf">0.5</span>+:<span class="mi">1</span>, inf, nan]<span class="p">;</span>
<span class="gp">&gt; </span>map exactp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map inexactp l<span class="p">;</span>
[<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>]
<span class="gp">&gt; </span>map complexp l<span class="p">;</span>
[<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map compvalp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>]
<span class="gp">&gt; </span>map (\x -&gt; (exactp x and compvalp x)) l<span class="p">;</span> <span class="c1">// &quot;has exact complex value&quot;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map ratcompvalp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map (\x -&gt; (exactp x and ratcompvalp x)) l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map intcompvalp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map (\x -&gt; (exactp x and intcompvalp x)) l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map ratvalp l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map (\x -&gt; (exactp x and ratvalp x)) l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map intvalp l<span class="p">;</span> <span class="c1">// for comparison</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]
<span class="gp">&gt; </span>map (\x -&gt; (exactp x and intvalp x)) l<span class="p">;</span>
[<span class="mi">1</span>,<span class="mi">1</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>,<span class="mi">0</span>]

See `Type and Value Tests`_ for some details <span class="kr">of</span> rational <span class="kr">type</span> and value tests.
</pre></div>
</div>
</div>
<div class="section" id="rational-complex-arithmetic-operators-and-relations">
<h3><a class="toc-backref" href="#id56">Rational Complex Arithmetic Operators and Relations</a><a class="headerlink" href="#rational-complex-arithmetic-operators-and-relations" title="Permalink to this headline">¶</a></h3>
<p>The standard arithmetic operators (+), (−), (*), (/), (%), (), (==) and (~=) are
overloaded to have at least one complex and/or rational operand, but (&lt;), (&lt;=),
(&gt;), (&gt;=) are not, as complex numbers are unordered.</p>
<p><strong>Example 63</strong> Rational complex arithmetic:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> w = <span class="mi">1</span>%<span class="mi">2</span> +: <span class="mi">3</span>%<span class="mi">4</span><span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> z = <span class="mi">5</span>%<span class="mi">6</span> +: <span class="mi">7</span>%<span class="mi">8</span><span class="p">;</span>
<span class="gp">&gt; </span>w + z<span class="p">;</span>
<span class="mi">4L</span>%<span class="mi">3L</span>+:<span class="mi">13L</span>%<span class="mi">8L</span>
<span class="gp">&gt; </span>w % z<span class="p">;</span>
<span class="mi">618L</span>%<span class="mi">841L</span>+:<span class="mi">108L</span>%<span class="mi">841L</span>
<span class="gp">&gt; </span>w / z<span class="p">;</span>
<span class="mf">0.734839476813318</span>+:<span class="mf">0.128418549346017</span>
<span class="gp">&gt; </span>w ^ <span class="mi">2</span><span class="p">;</span>
-<span class="mf">0.3125</span>+:<span class="mf">0.75</span>
<span class="gp">&gt; </span>w == z<span class="p">;</span>
<span class="mi">0</span>
<span class="gp">&gt; </span>w == w<span class="p">;</span>
<span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="rational-complex-maths">
<h3><a class="toc-backref" href="#id57">Rational Complex Maths</a><a class="headerlink" href="#rational-complex-maths" title="Permalink to this headline">¶</a></h3>
<p>The standard functions <tt class="docutils literal"><span class="pre">re</span></tt> and <tt class="docutils literal"><span class="pre">im</span></tt> work with rational complex numbers (see
<a class="reference internal" href="#rational-complex-constructors-and-deconstructors">Rational Complex Constructors and &#8216;Deconstructors&#8217;</a>).</p>
<p>The standard functions <tt class="docutils literal"><span class="pre">polar</span></tt>, <tt class="docutils literal"><span class="pre">abs</span></tt> and <tt class="docutils literal"><span class="pre">arg</span></tt> work with rational complex
numbers, but the results are inexact.</p>
<p><strong>Example 64</strong> Rational complex maths:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>polar (<span class="mi">1</span>%<span class="mi">2</span>+:<span class="mi">1</span>%<span class="mi">2</span>)<span class="p">;</span>
<span class="mf">0.707106781186548</span>&lt;:<span class="mf">0.785398163397448</span>
<span class="gp">&gt; </span>abs (<span class="mi">4</span>%<span class="mi">2</span>+:<span class="mi">3</span>%<span class="mi">2</span>)<span class="p">;</span>
<span class="mf">2.5</span>
<span class="gp">&gt; </span>arg (-<span class="mi">1</span>%<span class="mi">1</span>)<span class="p">;</span>
<span class="mf">3.14159265358979</span>
</pre></div>
</div>
<p>There are some additional useful functions for calculating with rational complex
numbers and more general mathematical values.</p>
<dl class="function">
<dt id="rational::norm_gauss">
<tt class="descclassname">rational::</tt><tt class="descname">norm_gauss</tt> c<a class="headerlink" href="#rational::norm_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the Gaussian norm ||c|| of any complex (or real) number c;
this is the square of the absolute value, and is returned as an (exact)
integer.</p>
</dd></dl>

<dl class="function">
<dt id="rational::div_mod_gauss">
<tt class="descclassname">rational::</tt><tt class="descname">div_mod_gauss</tt> n d<a class="headerlink" href="#rational::div_mod_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>performs Gaussian integer division, returning (q, r) where q is a (not
always unique) quotient, and r is a (not always unique) remainder. q and r
are such that n = q * d + r and ||r|| &lt; ||d|| (equivalently, |r|
&lt; |d|).</p>
</dd></dl>

<dl class="function">
<dt id="rational::n_div_gauss">
<tt class="descclassname">rational::</tt><tt class="descname">n_div_gauss</tt> d<a class="headerlink" href="#rational::n_div_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>returns just a quotient from Gaussian integer division as produced by
div_mod_gauss n d.</p>
</dd></dl>

<dl class="function">
<dt id="rational::n_mod_gauss">
<tt class="descclassname">rational::</tt><tt class="descname">n_mod_gauss</tt> d<a class="headerlink" href="#rational::n_mod_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>returns just a remainder from Gaussian integer division as produced by
div_mod_gauss n d.</p>
</dd></dl>

<dl class="function">
<dt id="rational::gcd_gauss">
<tt class="descclassname">rational::</tt><tt class="descname">gcd_gauss</tt> c1 c2<a class="headerlink" href="#rational::gcd_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a GCD G of the Gaussian integers c1,c2. This is chosen so that s.t.
ℜ(G) &gt; 0, and either |ℑ(G)| &lt; ℜ(G) or ℑ(G) = ℜ(G) &gt; 0;</p>
</dd></dl>

<dl class="function">
<dt id="rational::euclid_gcd">
<tt class="descclassname">rational::</tt><tt class="descname">euclid_gcd</tt> zerofun modfun x y<a class="headerlink" href="#rational::euclid_gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a (non-unique) GCD calculated by performing the Euclidean algorithm
on the values x and y (of any type) where zerofun is a predicate for
equality to 0, and modfun is a binary modulus (remainder) function.</p>
</dd></dl>

<dl class="function">
<dt id="rational::euclid_alg">
<tt class="descclassname">rational::</tt><tt class="descname">euclid_alg</tt> zerofun divfun x y<a class="headerlink" href="#rational::euclid_alg" title="Permalink to this definition">¶</a></dt>
<dd><p>returns (g, a, b) where the g is a (non-unique) GCD and a, b are
(arbitrary, non-unique) values such that a * x + b * y = g calculated by
performing the generalised Euclidean algorithm on the values x and y (of
any type) where zerofun is a predicate for equality to 0, and div is a
binary quotient function.</p>
</dd></dl>

<p><strong>Example 65</strong> More rational complex and other maths:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>norm_gauss (<span class="mi">1</span> +: <span class="mi">3</span>)<span class="p">;</span>
<span class="mi">10</span>
<span class="gp">&gt; </span>abs (<span class="mi">1</span> +: <span class="mi">3</span>)<span class="p">;</span>
<span class="mf">3.16227766016838</span>
<span class="gp">&gt; </span>norm_gauss (-<span class="mi">5</span>)<span class="p">;</span>
<span class="mi">25</span>
<span class="gp">&gt; </span><span class="kr">let</span> (q, r) = div_mod_gauss <span class="mi">100</span> (<span class="mi">12</span> +: <span class="mi">5</span>)<span class="p">;</span>
<span class="gp">&gt; </span>(q, r)<span class="p">;</span>
<span class="mi">7L</span>+:-<span class="mi">3L</span>,<span class="mi">1L</span>+:<span class="mi">1L</span>
<span class="gp">&gt; </span>q * (<span class="mi">12</span> +: <span class="mi">5</span>) + r<span class="p">;</span>
<span class="mi">100L</span>+:<span class="mi">0L</span>
<span class="gp">&gt; </span><span class="mi">100</span> div_gauss (<span class="mi">12</span> +: <span class="mi">5</span>)<span class="p">;</span>
<span class="mi">7L</span>+:-<span class="mi">3L</span>
<span class="gp">&gt; </span><span class="mi">100</span> mod_gauss (<span class="mi">12</span> +: <span class="mi">5</span>)<span class="p">;</span>
<span class="mi">1L</span>+:<span class="mi">1L</span>
<span class="gp">&gt; </span>div_mod_gauss <span class="mi">23</span> <span class="mi">5</span><span class="p">;</span>
<span class="mi">5L</span>+:<span class="mi">0L</span>,-<span class="mi">2L</span>+:<span class="mi">0L</span>
<span class="gp">&gt; </span>gcd_gauss (<span class="mi">1</span> +: <span class="mi">2</span>) (<span class="mi">3</span> +: <span class="mi">4</span>)<span class="p">;</span>
<span class="mi">1L</span>+:<span class="mi">0L</span>
<span class="gp">&gt; </span>gcd_gauss <span class="mi">25</span> <span class="mi">15</span><span class="p">;</span>
<span class="mi">5L</span>+:<span class="mi">0L</span>
<span class="gp">&gt; </span>euclid_gcd (==<span class="mi">0</span>) (mod_gauss) (<span class="mi">1</span>+: <span class="mi">2</span>) (<span class="mi">3</span> +: <span class="mi">4</span>)<span class="p">;</span>
<span class="mi">1L</span>+:<span class="mi">0L</span>
<span class="gp">&gt; </span>euclid_gcd (==<span class="mi">0</span>) (mod) <span class="mi">25</span> <span class="mi">15</span><span class="p">;</span>
<span class="mi">5</span>
<span class="gp">&gt; </span><span class="kr">let</span> (g, a, b) = euclid_alg (==<span class="mi">0</span>) (div_gauss) (<span class="mi">1</span> +: <span class="mi">2</span>) (<span class="mi">3</span> +: <span class="mi">4</span>)<span class="p">;</span> g<span class="p">;</span>
<span class="mi">1L</span>+:<span class="mi">0L</span>
<span class="gp">&gt; </span>(a, b)<span class="p">;</span>
-<span class="mi">2L</span>+:<span class="mi">0L</span>,<span class="mi">1L</span>+:<span class="mi">0L</span>
<span class="gp">&gt; </span>a * (<span class="mi">1</span> +: <span class="mi">2</span>) + b * (<span class="mi">3</span> +: <span class="mi">4</span>)<span class="p">;</span>
<span class="mi">1L</span>+:<span class="mi">0L</span>
<span class="gp">&gt; </span><span class="kr">let</span> (g, a, b) = euclid_alg (==<span class="mi">0</span>) (div) <span class="mi">25</span> <span class="mi">15</span><span class="p">;</span> g<span class="p">;</span>
<span class="mi">5</span>
<span class="gp">&gt; </span>(a, b)<span class="p">;</span>
-<span class="mi">1</span>,<span class="mi">2</span>
<span class="gp">&gt; </span>a * <span class="mi">25</span> + b * <span class="mi">15</span><span class="p">;</span>
<span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="section" id="rational-complex-type-simplification">
<h3><a class="toc-backref" href="#id58">Rational Complex Type Simplification</a><a class="headerlink" href="#rational-complex-type-simplification" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::comp_simplify">
<tt class="descclassname">rational::</tt><tt class="descname">comp_simplify</tt> c<a class="headerlink" href="#rational::comp_simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q with complex numbers simplified to reals, if possible.</p>
</dd></dl>

<dl class="function">
<dt id="rational::ratcomp_simplify">
<tt class="descclassname">rational::</tt><tt class="descname">ratcomp_simplify</tt> c<a class="headerlink" href="#rational::ratcomp_simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>returns q with rationals simplified to integers, and complex
numbers simplified to reals, if possible.</p>
</dd></dl>

<p><strong>Example 66</strong> Rational complex number type simplification:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> l = [<span class="mi">9</span>+:<span class="mi">1</span>, <span class="mi">9</span>%<span class="mi">1</span>+:<span class="mi">1</span>, <span class="mi">9</span>%<span class="mi">2</span>+:<span class="mi">1</span>, <span class="mf">4.5</span>+:<span class="mi">1</span>, <span class="mi">9</span>%<span class="mi">1</span>+:<span class="mi">0</span>, <span class="mi">9</span>%<span class="mi">2</span>+:<span class="mi">0</span>, <span class="mf">4.5</span>+:<span class="mf">0.0</span>]<span class="p">;</span>
<span class="gp">&gt; </span>l<span class="p">;</span>
[<span class="mi">9</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">1L</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">2L</span>+:<span class="mi">1</span>,<span class="mf">4.5</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">1L</span>+:<span class="mi">0</span>,<span class="mi">9L</span>%<span class="mi">2L</span>+:<span class="mi">0</span>,<span class="mf">4.5</span>+:<span class="mf">0.0</span>]
<span class="gp">&gt; </span>map comp_simplify l<span class="p">;</span>
[<span class="mi">9</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">1L</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">2L</span>+:<span class="mi">1</span>,<span class="mf">4.5</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">1L</span>,<span class="mi">9L</span>%<span class="mi">2L</span>,<span class="mf">4.5</span>+:<span class="mf">0.0</span>]
<span class="gp">&gt; </span>map ratcomp_simplify l<span class="p">;</span>
[<span class="mi">9</span>+:<span class="mi">1</span>,<span class="mi">9</span>+:<span class="mi">1</span>,<span class="mi">9L</span>%<span class="mi">2L</span>+:<span class="mi">1</span>,<span class="mf">4.5</span>+:<span class="mi">1</span>,<span class="mi">9</span>,<span class="mi">9L</span>%<span class="mi">2L</span>,<span class="mf">4.5</span>+:<span class="mf">0.0</span>]

See `Rational Type Simplification`_ for some details <span class="kr">of</span> rational <span class="kr">type</span>
simplification.
</pre></div>
</div>
</div>
</div>
<div class="section" id="string-formatting-and-evaluation">
<h2><a class="toc-backref" href="#id59">String Formatting and Evaluation</a><a class="headerlink" href="#string-formatting-and-evaluation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-naming-of-the-string-conversion-functions">
<h3><a class="toc-backref" href="#id60">The Naming of the String Conversion Functions</a><a class="headerlink" href="#the-naming-of-the-string-conversion-functions" title="Permalink to this headline">¶</a></h3>
<p>There are several families of functions for converting between strings and
rationals.</p>
<p>The functions that convert from rationals to strings have names based on
that of the standard function <tt class="docutils literal"><span class="pre">str</span></tt>. The <tt class="docutils literal"><span class="pre">str_*</span></tt> functions convert to a
formatted string, and depend on a &#8216;format structure&#8217; parameter (see
<a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a>). The <tt class="docutils literal"><span class="pre">strs_*</span></tt> functions convert
to a tuple of string fragments.</p>
<p>The functions that convert from strings to rationals have names based on that
of the standard function <tt class="docutils literal"><span class="pre">eval</span></tt> (<tt class="docutils literal"><span class="pre">val</span></tt> in Q). The <tt class="docutils literal"><span class="pre">val_*</span></tt> functions
convert from a formatted string, and depend on a format structure
parameter. The <tt class="docutils literal"><span class="pre">sval_*</span></tt> functions convert from a tuple of string fragments.</p>
<p>There are also <tt class="docutils literal"><span class="pre">join_*</span></tt> and <tt class="docutils literal"><span class="pre">split_*</span></tt> functions to join string fragments
into formatted strings, and to split formatted strings into string fragments,
respectively; these depend on a format structure parameter. These functions
are not always invertible, because some of the functions reduce an error term
to just a sign, e.g. <a class="reference internal" href="#rational::str_real_approx_dp" title="rational::str_real_approx_dp"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_approx_dp</span></tt></a> may round a value. Thus
sometimes the <tt class="docutils literal"><span class="pre">join_*</span></tt> and <tt class="docutils literal"><span class="pre">split_*</span></tt> pairs, and the <tt class="docutils literal"><span class="pre">str_*</span></tt> and
<tt class="docutils literal"><span class="pre">val_*</span></tt> pairs are not quite mutual inverses.</p>
</div>
<div class="section" id="internationalisation-and-format-structures">
<h3><a class="toc-backref" href="#id61">Internationalisation and Format Structures</a><a class="headerlink" href="#internationalisation-and-format-structures" title="Permalink to this headline">¶</a></h3>
<p>Many of the string formatting functions in the following sections are
parameterised by a &#8216;format structure&#8217;. Throughout this document, the formal
parameter for the format structure will be <tt class="docutils literal"><span class="pre">fmt</span></tt>. This is simply a record
mapping some string &#8216;codes&#8217; to functions as follows. The functions are mostly
from strings to a string, or from a string to a tuple of strings.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">&quot;sm&quot;</span></tt></dt>
<dd>a function mapping a sign and an unsigned mantissa (or integer) strings to a
signed mantissa (or integer) string.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;se&quot;</span></tt></dt>
<dd>a function mapping a sign and an unsigned exponent string to a signed exponent
string.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;-s&quot;</span></tt></dt>
<dd>a function mapping a signed number string to a pair containing a sign and the
unsigned number string.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;gi&quot;</span></tt></dt>
<dd>a function mapping an integer representing the group size and an integer
string to a grouped integer string.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;gf&quot;</span></tt></dt>
<dd>a function mapping an integer representing the group size and a fraction-part
string to a grouped fraction-part string.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;-g&quot;</span></tt></dt>
<dd>a function mapping a grouped number string to an ungrouped number string.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;zi&quot;</span></tt></dt>
<dd>a function mapping an integer number string to a number string. The input
string representing zero integer part is &#8220;&#8221;, which should be mapped to the
desired representation of zero. All other number strings should be returned
unaltered.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;zf&quot;</span></tt></dt>
<dd>a function mapping a fraction-part number string to a number string. The input
string representing zero fraction part is &#8220;&#8221;, which should be mapped to the
desired representation of zero. All other number strings should be returned
unaltered.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;ir&quot;</span></tt></dt>
<dd>a function mapping initial and recurring parts of a fraction part to the
desired format.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;-ir&quot;</span></tt></dt>
<dd>a function mapping a formatted fraction part to the component initial and
recurring parts.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;if&quot;</span></tt></dt>
<dd>a function mapping an integer string and fraction part string to the
radix-point formatted string.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;-if&quot;</span></tt></dt>
<dd>a function mapping a radix-point formatted string to the component integer
fraction part strings</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;me&quot;</span></tt></dt>
<dd>a function mapping a mantissa string and exponent string to the formatted
exponential string.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;-me&quot;</span></tt></dt>
<dd>a function mapping a formatted exponential string to the component mantissa
and exponent strings.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;e&quot;</span></tt></dt>
<dd>a function mapping an &#8216;error&#8217; number (not string) and a number string to a
formatted number string indicating the sign of the error.</dd>
<dt><tt class="docutils literal"><span class="pre">&quot;-e&quot;</span></tt></dt>
<dd>a function mapping a formatted number string indicating the sign of the error
to the component &#8216;error&#8217; string (not number) and number strings.</dd>
</dl>
<p>Depending upon the format structure, some parameters of some of the functions
taking a format structure may have no effect. For example, an <tt class="docutils literal"><span class="pre">intGroup</span></tt>
parameter specifying the size of the integer digit groups will have no effect if
the integer group separator is the empty string.</p>
<dl class="function">
<dt id="rational::create_format">
<tt class="descclassname">rational::</tt><tt class="descname">create_format</tt> options<a class="headerlink" href="#rational::create_format" title="Permalink to this definition">¶</a></dt>
<dd><p>is a function that provides an easy way to prepare a &#8216;format structure&#8217;
from the simpler &#8216;options structure&#8217;. The options structure is another
record, but from more descriptive strings to a string or tuple of strings.</p>
</dd></dl>

<p>For example, <tt class="docutils literal"><span class="pre">format_uk</span></tt> is generated from <tt class="docutils literal"><span class="pre">options_uk</span></tt> as follows:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="kr">public</span> options_uk<span class="p">;</span>
<span class="kr">const</span> options_uk =
  {
    <span class="s">&quot;sign&quot;</span> =&gt; (<span class="s">&quot;-&quot;</span>,<span class="s">&quot;&quot;</span>,<span class="s">&quot;&quot;</span>),             <span class="c1">// alternative: (&quot;-&quot;,&quot; &quot;,&quot;+&quot;)</span>
    <span class="s">&quot;exponent sign&quot;</span> =&gt; (<span class="s">&quot;-&quot;</span>,<span class="s">&quot;&quot;</span>,<span class="s">&quot;&quot;</span>),    <span class="c1">// alternative: (&quot;-&quot;,&quot;&quot;,&quot;+&quot;)</span>
    <span class="s">&quot;group separator&quot;</span> =&gt; <span class="s">&quot;,&quot;</span>,          <span class="c1">// might be &quot; &quot; or &quot;.&quot; or &quot;&#39;&quot; elsewhere</span>
    <span class="s">&quot;zero&quot;</span> =&gt; <span class="s">&quot;0&quot;</span>,
    <span class="s">&quot;radix point&quot;</span> =&gt; <span class="s">&quot;.&quot;</span>,              <span class="c1">// might be &quot;,&quot; elsewhere</span>
    <span class="s">&quot;fraction group separator&quot;</span> =&gt; <span class="s">&quot;,&quot;</span>,
    <span class="s">&quot;fraction zero&quot;</span> =&gt; <span class="s">&quot;0&quot;</span>,            <span class="c1">// alternative: &quot;&quot;</span>
    <span class="s">&quot;recur brackets&quot;</span> =&gt; (<span class="s">&quot;[&quot;</span>,<span class="s">&quot;...]&quot;</span>),
    <span class="s">&quot;exponent&quot;</span> =&gt; <span class="s">&quot;*10^&quot;</span>,              <span class="c1">// (poor) alternative: &quot;e&quot;</span>
    <span class="s">&quot;error sign&quot;</span> =&gt; (<span class="s">&quot;-&quot;</span>,<span class="s">&quot;&quot;</span>,<span class="s">&quot;+&quot;</span>),
    <span class="s">&quot;error brackets&quot;</span> =&gt; (<span class="s">&quot;(&quot;</span>,<span class="s">&quot;)&quot;</span>)
  }<span class="p">;</span>

<span class="kr">public</span> format_uk<span class="p">;</span>
<span class="kr">const</span> format_uk = create_format options_uk<span class="p">;</span>
</pre></div>
</div>
<p>The exponent string need not depend on the radix, as the numerals for the
number radix in that radix are always &#8220;10&#8221;.</p>
<p>Beware of using &#8220;e&#8221; or &#8220;E&#8221; as an exponent string as these have the potential of
being treated as digits in, e.g., hexadecimal.</p>
<p>Format structures do not have to be generated via create format; they may also
be constructed directly.</p>
</div>
<div class="section" id="digit-grouping">
<h3><a class="toc-backref" href="#id62">Digit Grouping</a><a class="headerlink" href="#digit-grouping" title="Permalink to this headline">¶</a></h3>
<p>Some functions take <tt class="docutils literal"><span class="pre">group</span></tt> parameters. A value of 0 means &#8220;don’t group&#8221;.</p>
</div>
<div class="section" id="radices">
<h3><a class="toc-backref" href="#id63">Radices</a><a class="headerlink" href="#radices" title="Permalink to this headline">¶</a></h3>
<p>The functions that produce a decimal expansion take a Radix argument. The
fraction parts are expanded in that radix (or &#8216;base&#8217;), in addition to the
integer parts. The parameter Radix is not restricted to the usual {2, 8, 10,
16}, but may be any integer from 2 to 36; the numerals (&#8216;digits&#8217;) are chosen
from [&#8220;0&#8221;, ... , &#8220;9&#8221;, &#8220;A&#8221;, ... , &#8220;Z&#8221;]. The letter-digits are always upper
case.</p>
<p>The functions do not attach a prefix (such as &#8220;0x&#8221; for hexadecimal) to the
resulting string.</p>
</div>
<div class="section" id="error-terms">
<h3><a class="toc-backref" href="#id64">Error Terms</a><a class="headerlink" href="#error-terms" title="Permalink to this headline">¶</a></h3>
<p>Some functions return a value including an &#8216;error&#8217; term (in a tuple) or sign (at
the end of a string). Such an error is represents what the next digit would be
as a fraction of the radix.</p>
<p><strong>Example 67</strong> Error term in the tuple of string &#8216;fragments&#8217;:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>strs_real_approx_sf <span class="mi">10</span> floor <span class="mi">3</span> (<span class="mi">234567</span>%<span class="mi">100000</span>)<span class="p">;</span>
<span class="s">&quot;+&quot;</span>,<span class="s">&quot;2&quot;</span>,<span class="s">&quot;34&quot;</span>,<span class="mi">567L</span>%<span class="mi">1000L</span>
<span class="gp">&gt; </span>strs_real_approx_sf <span class="mi">10</span> ceil <span class="mi">3</span> (<span class="mi">234567</span>%<span class="mi">100000</span>)<span class="p">;</span>
<span class="s">&quot;+&quot;</span>,<span class="s">&quot;2&quot;</span>,<span class="s">&quot;35&quot;</span>,(-<span class="mi">433L</span>)%<span class="mi">1000L</span>
</pre></div>
</div>
<p>(See the function <a class="reference internal" href="#rational::strs_real_approx_sf" title="rational::strs_real_approx_sf"><tt class="xref pure pure-func docutils literal"><span class="pre">strs_real_approx_sf</span></tt></a>.)</p>
<p>In strings, only the sign of the error term is given. A “+” should be read as
“and a bit more”; “-” as “but a bit less”.</p>
<p><strong>Example 68</strong> Error sign in the string:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>str_real_approx_sf format_uk <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> floor <span class="mi">3</span> (<span class="mi">234567</span>%<span class="mi">100000</span>)<span class="p">;</span>
<span class="s">&quot;2.34(+)&quot;</span>
<span class="gp">&gt; </span>str_real_approx_sf format_uk <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> ceil <span class="mi">3</span> (<span class="mi">234567</span>%<span class="mi">100000</span>)<span class="p">;</span>
<span class="s">&quot;2.35(-)&quot;</span>
</pre></div>
</div>
<p>(See the function <a class="reference internal" href="#rational::str_real_approx_sf" title="rational::str_real_approx_sf"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_approx_sf</span></tt></a>.)</p>
</div>
</div>
<div class="section" id="q-fraction-string-i-n-d">
<h2><a class="toc-backref" href="#id65"><strong>Q</strong> &lt;-&gt; Fraction String (“i + n/d”)</a><a class="headerlink" href="#q-fraction-string-i-n-d" title="Permalink to this headline">¶</a></h2>
<div class="section" id="formatting-to-fraction-strings">
<h3><a class="toc-backref" href="#id66">Formatting to Fraction Strings</a><a class="headerlink" href="#formatting-to-fraction-strings" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::str_vulgar">
<tt class="descclassname">rational::</tt><tt class="descname">str_vulgar</tt> q<a class="headerlink" href="#rational::str_vulgar" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a String representing the rational (or integer) q in the
form</p>
<ul class="simple">
<li>“[−]n/d”</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="rational::str_vulgar_or_int">
<tt class="descclassname">rational::</tt><tt class="descname">str_vulgar_or_int</tt> q<a class="headerlink" href="#rational::str_vulgar_or_int" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a String representing the rational (or integer) q in one of
the forms</p>
<ul class="simple">
<li>“[−]n/d”</li>
<li>“[−]i”</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="rational::str_mixed">
<tt class="descclassname">rational::</tt><tt class="descname">str_mixed</tt> q<a class="headerlink" href="#rational::str_mixed" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a String representing the rational (or integer) q in one of
the forms</p>
<ul class="simple">
<li>“i + n/d”</li>
<li>“−(i + n/d)”</li>
<li>“[−]n/d”</li>
<li>“[−]i”</li>
</ul>
</dd></dl>

<p><strong>Example 69</strong> The fraction string representations:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> l = iterwhile (&lt;= <span class="mi">3</span>%<span class="mi">2</span>) (+(<span class="mi">1</span>%<span class="mi">2</span>)) (-<span class="mi">3</span>%<span class="mi">2</span>)<span class="p">;</span>
<span class="gp">&gt; </span>l<span class="p">;</span>
[(-<span class="mi">3L</span>)%<span class="mi">2L</span>,(-<span class="mi">1L</span>)%<span class="mi">1L</span>,(-<span class="mi">1L</span>)%<span class="mi">2L</span>,<span class="mi">0L</span>%<span class="mi">1L</span>,<span class="mi">1L</span>%<span class="mi">2L</span>,<span class="mi">1L</span>%<span class="mi">1L</span>,<span class="mi">3L</span>%<span class="mi">2L</span>]
<span class="gp">&gt; </span>map str_vulgar l<span class="p">;</span>
[<span class="s">&quot;-3L/2L&quot;</span>,<span class="s">&quot;-1L/1L&quot;</span>,<span class="s">&quot;-1L/2L&quot;</span>,<span class="s">&quot;0L/1L&quot;</span>,<span class="s">&quot;1L/2L&quot;</span>,<span class="s">&quot;1L/1L&quot;</span>,<span class="s">&quot;3L/2L&quot;</span>]
<span class="gp">&gt; </span>map str_vulgar_or_int l<span class="p">;</span>
[<span class="s">&quot;-3L/2L&quot;</span>,<span class="s">&quot;-1L&quot;</span>,<span class="s">&quot;-1L/2L&quot;</span>,<span class="s">&quot;0L&quot;</span>,<span class="s">&quot;1L/2L&quot;</span>,<span class="s">&quot;1L&quot;</span>,<span class="s">&quot;3L/2L&quot;</span>]
<span class="gp">&gt; </span>map str_mixed l<span class="p">;</span>
[<span class="s">&quot;-(1L+1L/2L)&quot;</span>,<span class="s">&quot;-1L&quot;</span>,<span class="s">&quot;-1L/2L&quot;</span>,<span class="s">&quot;0L&quot;</span>,<span class="s">&quot;1L/2L&quot;</span>,<span class="s">&quot;1L&quot;</span>,<span class="s">&quot;1L+1L/2L&quot;</span>]
</pre></div>
</div>
<p>These might be compared to the behaviour of the standard function <tt class="docutils literal"><span class="pre">str</span></tt>.</p>
<dl class="function">
<dt id="str/rational">
<tt class="descname">str</tt> x<a class="headerlink" href="#str/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a string representing the value x.</p>
</dd></dl>

<p><strong>Example 70</strong> The standard function str:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>map str l<span class="p">;</span>
[<span class="s">&quot;(-3L)%2L&quot;</span>,<span class="s">&quot;(-1L)%1L&quot;</span>,<span class="s">&quot;(-1L)%2L&quot;</span>,<span class="s">&quot;0L%1L&quot;</span>,<span class="s">&quot;1L%2L&quot;</span>,<span class="s">&quot;1L%1L&quot;</span>,<span class="s">&quot;3L%2L&quot;</span>]
</pre></div>
</div>
</div>
<div class="section" id="evaluation-of-fraction-strings">
<h3><a class="toc-backref" href="#id67">Evaluation of Fraction Strings</a><a class="headerlink" href="#evaluation-of-fraction-strings" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::val_vulgar">
<tt class="descclassname">rational::</tt><tt class="descname">val_vulgar</tt> strg<a class="headerlink" href="#rational::val_vulgar" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a rational q represented by the string strg in the form</p>
<ul class="simple">
<li>“[−]n/d”</li>
</ul>
</dd></dl>

<p>Such strings can also be evaluated by the <tt class="docutils literal"><span class="pre">val_mixed</span></tt> function.</p>
<dl class="function">
<dt id="rational::val_mixed">
<tt class="descclassname">rational::</tt><tt class="descname">val_mixed</tt> strg<a class="headerlink" href="#rational::val_mixed" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a rational q represented by the string strg</p>
<ul class="simple">
<li>“i + n/d”</li>
<li>“−(i + n/d)”</li>
<li>“[−]n/d” — thus val_mixed strictly extends val_vulgar</li>
<li>“[−]i”</li>
</ul>
</dd></dl>

<p><strong>Example 71</strong> Evaluating fraction strings:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>val_vulgar <span class="s">&quot;-22/7&quot;</span><span class="p">;</span>
(-<span class="mi">22L</span>)%<span class="mi">7L</span>
<span class="gp">&gt; </span>val_mixed <span class="s">&quot;1L+5L/6L&quot;</span><span class="p">;</span>
<span class="mi">11L</span>%<span class="mi">6L</span>
</pre></div>
</div>
<p>These might be compared to the behaviour of the standard function eval.</p>
<dl class="function">
<dt id="eval/rational">
<tt class="descname">eval</tt> s<a class="headerlink" href="#eval/rational" title="Permalink to this definition">¶</a></dt>
<dd><p>evaluates the string s.</p>
</dd></dl>

<p><strong>Example 72</strong> The standard function eval:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>eval <span class="s">&quot;1+5%6&quot;</span><span class="p">;</span>
<span class="mi">11L</span>%<span class="mi">6L</span>
<span class="gp">&gt; </span>eval <span class="s">&quot;1L+5L/6L&quot;</span><span class="p">;</span>
<span class="mf">1.83333333333333</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="q-recurring-numeral-expansion-string-i-fr">
<h2><a class="toc-backref" href="#id68"><strong>Q</strong> &lt;-&gt; Recurring Numeral Expansion String (“I.FR”)</a><a class="headerlink" href="#q-recurring-numeral-expansion-string-i-fr" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information about the
formatting structure to be supplied in the <tt class="docutils literal"><span class="pre">fmt</span></tt> parameter.</p>
<div class="section" id="formatting-to-recurring-expansion-strings">
<h3><a class="toc-backref" href="#id69">Formatting to Recurring Expansion Strings</a><a class="headerlink" href="#formatting-to-recurring-expansion-strings" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rational::str_real_recur">
<tt class="descclassname">rational::</tt><tt class="descname">str_real_recur</tt> fmt radix intGroup q<a class="headerlink" href="#rational::str_real_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a string (exactly) representing the rational (or integer)
q as base-Radix expansion of one the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.init frac part[smallest recurring frac part ...]”</li>
</ul>
</dd></dl>

<p>Note that there is no fracGroup parameter.</p>
<p>Beware that the string returned by this function can be very long. The length of
the recurring part of such a decimal expansion may be up to one less than the
simplest denominator of q.</p>
<p><strong>Example 73</strong> The recurring radix expansion-type string representations:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">10</span> <span class="mi">3</span> (<span class="mi">4000001</span>%<span class="mi">4</span>)<span class="p">;</span> <span class="c1">// grouped with commas</span>
<span class="s">&quot;1,000,000.25&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">10</span> <span class="mi">0</span> (<span class="mi">4000001</span>%<span class="mi">4</span>)<span class="p">;</span> <span class="c1">// no grouping</span>
<span class="s">&quot;1000000.25&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">10</span> <span class="mi">3</span> (<span class="mi">1000000</span>%<span class="mi">3</span>)<span class="p">;</span>
<span class="s">&quot;333,333.[3...]&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">10</span> <span class="mi">3</span> (<span class="mi">1000000</span>%<span class="mi">7</span>)<span class="p">;</span>
<span class="s">&quot;142,857.[142857...]&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">10</span> <span class="mi">3</span> (-<span class="mi">1</span>%<span class="mi">700</span>)<span class="p">;</span>
<span class="s">&quot;-0.00[142857...]&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">10</span> <span class="mi">3</span> (<span class="mi">127</span>%<span class="mi">128</span>)<span class="p">;</span>
<span class="s">&quot;0.9921875&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">2</span> <span class="mi">4</span> (-<span class="mi">127</span>%<span class="mi">128</span>)<span class="p">;</span>
<span class="s">&quot;-0.1111111&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">16</span> <span class="mi">4</span> (<span class="mi">127</span>%<span class="mi">128</span>)<span class="p">;</span>
<span class="s">&quot;0.FE&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">10</span> <span class="mi">0</span> (<span class="mi">70057</span>%<span class="mi">350</span>)<span class="p">;</span> <span class="c1">// 1%7 + 10001%50;</span>
<span class="s">&quot;200.16[285714...]&quot;</span>
</pre></div>
</div>
<p>The function allows expansion to different radices (bases).</p>
<p><strong>Example 74</strong> The recurring radix expansion in decimal and hexadecimal:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">10</span> <span class="mi">0</span> (<span class="mi">1</span>%<span class="mi">100</span>)<span class="p">;</span>
<span class="s">&quot;0.01&quot;</span>
<span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">16</span> <span class="mi">0</span> (<span class="mi">1</span>%<span class="mi">100</span>)<span class="p">;</span>
<span class="s">&quot;0.0[28F5C...]&quot;</span>
</pre></div>
</div>
<p><strong>Example 75</strong> The recurring radix expansion in duodecimal:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>str_real_recur format_uk <span class="mi">12</span> <span class="mi">0</span> (<span class="mi">1</span>%<span class="mi">100</span>)<span class="p">;</span>
<span class="s">&quot;0.0[15343A0B62A68781B059...]&quot;</span>
</pre></div>
</div>
<p>Note that this bracket notation is not standard in the literature. Usually the
recurring numerals are indicated by a single dot over the initial and final
numerals of the recurring part, or an overline over the recurring part. For
example 1/70 = 0.0˙14285˙7 = 0.0142857 and 1/3 = 0.˙3 = 0.3.</p>
<dl class="function">
<dt id="rational::strs_real_recur">
<tt class="descclassname">rational::</tt><tt class="descname">strs_real_recur</tt> radix q<a class="headerlink" href="#rational::strs_real_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a quadruple of the four strings:</p>
<ul class="simple">
<li>the sign,</li>
<li>integer part (which is empty for 0),</li>
<li>initial fraction part</li>
<li>and recurring fraction part (either and both of which may be empty).</li>
</ul>
</dd></dl>

<p><strong>Example 76</strong> The recurring radix expansion in decimal — the fragments:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>strs_real_recur <span class="mi">10</span> (<span class="mi">100</span>%<span class="mi">7</span>)<span class="p">;</span>
<span class="s">&quot;+&quot;</span>,<span class="s">&quot;14&quot;</span>,<span class="s">&quot;&quot;</span>,<span class="s">&quot;285714&quot;</span>
<span class="gp">&gt; </span>strs_real_recur <span class="mi">10</span> (-<span class="mi">1</span>%<span class="mi">700</span>)<span class="p">;</span>
<span class="s">&quot;-&quot;</span>,<span class="s">&quot;&quot;</span>,<span class="s">&quot;00&quot;</span>,<span class="s">&quot;142857&quot;</span>
<span class="gp">&gt; </span>strs_real_recur <span class="mi">10</span> (<span class="mi">70057</span>%<span class="mi">350</span>)<span class="p">;</span>
<span class="s">&quot;+&quot;</span>,<span class="s">&quot;200&quot;</span>,<span class="s">&quot;16&quot;</span>,<span class="s">&quot;285714&quot;</span>
</pre></div>
</div>
<p>This function may be used to also, e.g. format the integer part with
comma-separated groupings.</p>
<dl class="function">
<dt id="rational::join_str_real_recur">
<tt class="descclassname">rational::</tt><tt class="descname">join_str_real_recur</tt> fmt intGroup sign i fracInit fracRecur<a class="headerlink" href="#rational::join_str_real_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>formats the parts in the quadruple returned by <a class="reference internal" href="#rational::strs_real_recur" title="rational::strs_real_recur"><tt class="xref pure pure-func docutils literal"><span class="pre">strs_real_recur</span></tt></a> to the
sort of string as returned by <a class="reference internal" href="#rational::str_real_recur" title="rational::str_real_recur"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_recur</span></tt></a>.</p>
</dd></dl>

</div>
<div class="section" id="evaluation-of-recurring-expansion-strings">
<h3><a class="toc-backref" href="#id70">Evaluation of Recurring Expansion Strings</a><a class="headerlink" href="#evaluation-of-recurring-expansion-strings" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">str_*</span></tt> and <tt class="docutils literal"><span class="pre">val_*</span></tt> functions depend on a &#8216;format structure&#8217; parameter
(fmt) such as format uk. Conversions may be performed between rationals and
differently formatted strings if a suitable alternative format structure is
supplied. See <a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information
about formatting structures.</p>
<dl class="function">
<dt id="rational::val_real_recur">
<tt class="descclassname">rational::</tt><tt class="descname">val_real_recur</tt> fmt radix strg<a class="headerlink" href="#rational::val_real_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the rational q represented by the base-radix expansion string
strg of one the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.init frac part[recurring frac part ...]”</li>
</ul>
</dd></dl>

<p><strong>Example 77</strong> Conversion from the recurring radix expansion-type string
representations:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>val_real_recur format_uk <span class="mi">10</span> <span class="s">&quot;-12.345&quot;</span><span class="p">;</span>
(-<span class="mi">2469L</span>)%<span class="mi">200L</span>
<span class="gp">&gt; </span>val_real_recur format_uk <span class="mi">10</span> <span class="s">&quot;0.3&quot;</span><span class="p">;</span>
<span class="mi">3L</span>%<span class="mi">10L</span>
<span class="gp">&gt; </span>val_real_recur format_uk <span class="mi">10</span> <span class="s">&quot;0.[3...]&quot;</span><span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">3L</span>
<span class="gp">&gt; </span>val_real_recur format_uk <span class="mi">10</span> <span class="s">&quot;.333[33...]&quot;</span><span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">3L</span>
<span class="gp">&gt; </span>val_real_recur format_uk <span class="mi">10</span> <span class="s">&quot;.[9...]&quot;</span><span class="p">;</span>
<span class="mi">1L</span>%<span class="mi">1L</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::sval_real_recur">
<tt class="descclassname">rational::</tt><tt class="descname">sval_real_recur</tt> radix sign iStr fracStr recurPartStr<a class="headerlink" href="#rational::sval_real_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the rational q represented by the parts</p>
<ul class="simple">
<li>sign</li>
<li>integer part</li>
<li>initial fraction part</li>
<li>recurring fraction part</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="rational::split_str_real_recur">
<tt class="descclassname">rational::</tt><tt class="descname">split_str_real_recur</tt> Fmt strg<a class="headerlink" href="#rational::split_str_real_recur" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a tuple containing the parts</p>
<ul class="simple">
<li>sign</li>
<li>integer part</li>
<li>initial fraction part</li>
<li>recurring fraction part
of one the forms
- “[−]int.frac”
- “[−]int.init frac part[recurring frac part ...]”</li>
</ul>
</dd></dl>

</div>
</div>
<div class="section" id="q-numeral-expansion-string-i-f-10e">
<h2><a class="toc-backref" href="#id71"><strong>Q</strong> &lt;-&gt; Numeral Expansion String (“I.F × 10E”)</a><a class="headerlink" href="#q-numeral-expansion-string-i-f-10e" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information about the
formatting structure to be supplied in the <tt class="docutils literal"><span class="pre">fmt</span></tt> parameter.</p>
<p>The exponent string &#8220;*10^&#8221; need not depend on the radix, as the numerals for
the number radix in that radix are always &#8220;10&#8221;.</p>
<div class="section" id="formatting-to-expansion-strings">
<h3><a class="toc-backref" href="#id72">Formatting to Expansion Strings</a><a class="headerlink" href="#formatting-to-expansion-strings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="functions-for-fixed-decimal-places">
<h4><a class="toc-backref" href="#id73">Functions for Fixed Decimal Places</a><a class="headerlink" href="#functions-for-fixed-decimal-places" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::str_real_approx_dp">
<tt class="descclassname">rational::</tt><tt class="descname">str_real_approx_dp</tt> fmt radix intGroup fracGroup roundfun dp q<a class="headerlink" href="#rational::str_real_approx_dp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a string representing a numeral expansion approximation of q to dp
decimal places, using rounding mode <tt class="docutils literal"><span class="pre">roundfun</span></tt> (see <a class="reference internal" href="#rounding-to-integer">Rounding to
Integer</a>) <tt class="docutils literal"><span class="pre">roundfun</span></tt> is usually <a class="reference internal" href="purelib.html#round" title="round"><tt class="xref pure pure-func docutils literal"><span class="pre">round</span></tt></a> or
<a class="reference internal" href="#rational::round_unbiased" title="rational::round_unbiased"><tt class="xref pure pure-func docutils literal"><span class="pre">round_unbiased</span></tt></a>.  (dp may be positive, zero or negative;
non-positive dps may look misleading — use e.g. scientific notation
instead.)</p>
</dd></dl>

<p><strong>Example 78</strong> Decimal places:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>str_real_approx_dp format_uk <span class="mi">10</span> <span class="mi">3</span> <span class="mi">3</span> round <span class="mi">2</span> (<span class="mi">22</span>%<span class="mi">7</span>)<span class="p">;</span>
<span class="s">&quot;3.14(+)&quot;</span>
<span class="gp">&gt; </span>str_real_approx_dp format_uk <span class="mi">10</span> <span class="mi">3</span> <span class="mi">3</span> ceil <span class="mi">2</span> (<span class="mi">22</span>%<span class="mi">7</span>)<span class="p">;</span>
<span class="s">&quot;3.15(-)&quot;</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::strs_real_approx_dp">
<tt class="descclassname">rational::</tt><tt class="descname">strs_real_approx_dp</tt> radix roundfun do q<a class="headerlink" href="#rational::strs_real_approx_dp" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a tuple of strings</p>
<ul class="simple">
<li>sign</li>
<li>integer part</li>
<li>fraction part</li>
</ul>
<p>representing an expansion to a number of decimal places, together with</p>
<ul class="simple">
<li>the rounding “error”: a fraction representing the next numerals.</li>
</ul>
</dd></dl>

<p><strong>Example 79</strong> Decimal places — the fragments:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>strs_real_approx_dp <span class="mi">10</span> round <span class="mi">2</span> (<span class="mi">22</span>%<span class="mi">7</span>)<span class="p">;</span>
<span class="s">&quot;+&quot;</span>,<span class="s">&quot;3&quot;</span>,<span class="s">&quot;14&quot;</span>,<span class="mi">2L</span>%<span class="mi">7L</span>
<span class="gp">&gt; </span>strs_real_approx_dp <span class="mi">10</span> ceil <span class="mi">2</span> (<span class="mi">22</span>%<span class="mi">7</span>)<span class="p">;</span>
<span class="s">&quot;+&quot;</span>,<span class="s">&quot;3&quot;</span>,<span class="s">&quot;15&quot;</span>,(-<span class="mi">5L</span>)%<span class="mi">7L</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::join_str_real_approx">
<tt class="descclassname">rational::</tt><tt class="descname">join_str_real_approx</tt> fmt intGroup fracGroup sign i frac err<a class="headerlink" href="#rational::join_str_real_approx" title="Permalink to this definition">¶</a></dt>
<dd><p>formats the parts in the quadruple returned by <a class="reference internal" href="#rational::strs_real_approx_dp" title="rational::strs_real_approx_dp"><tt class="xref pure pure-func docutils literal"><span class="pre">strs_real_approx_dp</span></tt></a>
or <a class="reference internal" href="#rational::strs_real_approx_sf" title="rational::strs_real_approx_sf"><tt class="xref pure pure-func docutils literal"><span class="pre">strs_real_approx_sf</span></tt></a> to the sort of string as returned by
<a class="reference internal" href="#rational::str_real_approx_dp" title="rational::str_real_approx_dp"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_approx_dp</span></tt></a> or <a class="reference internal" href="#rational::str_real_approx_sf" title="rational::str_real_approx_sf"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_approx_sf</span></tt></a>.</p>
</dd></dl>

</div>
<div class="section" id="functions-for-significant-figures">
<h4><a class="toc-backref" href="#id74">Functions for Significant Figures</a><a class="headerlink" href="#functions-for-significant-figures" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::str_real_approx_sf">
<tt class="descclassname">rational::</tt><tt class="descname">str_real_approx_sf</tt> fmt radix intGroup fracGroup roundfun sf q<a class="headerlink" href="#rational::str_real_approx_sf" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a string representing a numeral expansion approximation of q to sf
significant figures, using rounding mode <tt class="docutils literal"><span class="pre">roundfun</span></tt> (see <a class="reference internal" href="#rounding-to-integer">Rounding to
Integer</a>).</p>
</dd></dl>

<p><tt class="docutils literal"><span class="pre">roundfun</span></tt> is usually <a class="reference internal" href="purelib.html#round" title="round"><tt class="xref pure pure-func docutils literal"><span class="pre">round</span></tt></a> or <a class="reference internal" href="#rational::round_unbiased" title="rational::round_unbiased"><tt class="xref pure pure-func docutils literal"><span class="pre">round_unbiased</span></tt></a>. (sf must
be positive.)</p>
<p><strong>Example 80</strong> Significant figures:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>str_real_approx_sf format_uk <span class="mi">10</span> <span class="mi">3</span> <span class="mi">3</span> floor <span class="mi">2</span> (<span class="mi">22</span>%<span class="mi">7</span>)<span class="p">;</span>
<span class="s">&quot;3.1(+)&quot;</span>
<span class="gp">&gt; </span>str_real_approx_sf format_uk <span class="mi">10</span> <span class="mi">3</span> <span class="mi">3</span> floor <span class="mi">2</span> ((-<span class="mi">22</span>)%<span class="mi">7</span>)<span class="p">;</span>
<span class="s">&quot;-3.2(+)&quot;</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::strs_real_approx_sf">
<tt class="descclassname">rational::</tt><tt class="descname">strs_real_approx_sf</tt> radix roundfun sf q<a class="headerlink" href="#rational::strs_real_approx_sf" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a tuple of strings</p>
<ul class="simple">
<li>sign,</li>
<li>integer part,</li>
<li>fraction part, representing an expansion to a number of significant
figures, together with</li>
<li>the rounding “error”: a fraction representing the next numerals</li>
</ul>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">rational::</tt><tt class="descname">join_str_real_approx</tt></dt>
<dd><p>see <a class="reference internal" href="#rational::join_str_real_approx" title="rational::join_str_real_approx"><tt class="xref pure pure-func docutils literal"><span class="pre">join_str_real_approx</span></tt></a>.</p>
</dd></dl>

</div>
<div class="section" id="functions-for-scientific-notation-and-engineering-notation">
<h4><a class="toc-backref" href="#id75">Functions for Scientific Notation and Engineering Notation</a><a class="headerlink" href="#functions-for-scientific-notation-and-engineering-notation" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="rational::str_real_approx_sci">
<tt class="descclassname">rational::</tt><tt class="descname">str_real_approx_sci</tt> fmt radix intGroup fracGroup roundfun sf q<a class="headerlink" href="#rational::str_real_approx_sci" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a string expansion with a number of significant figures in
scientific notation, using rounding mode <tt class="docutils literal"><span class="pre">roundfun</span></tt> (see <a class="reference internal" href="#rounding-to-integer">Rounding to
Integer</a>).</p>
<p>(sf must be positive; expStep is usually 3, radix is usually 10,
<tt class="docutils literal"><span class="pre">roundfun</span></tt> is usually <a class="reference internal" href="purelib.html#round" title="round"><tt class="xref pure pure-func docutils literal"><span class="pre">round</span></tt></a> or <a class="reference internal" href="#rational::round_unbiased" title="rational::round_unbiased"><tt class="xref pure pure-func docutils literal"><span class="pre">round_unbiased</span></tt></a>;
<a class="reference internal" href="#rational::str_real_approx_sci" title="rational::str_real_approx_sci"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_approx_sci</span></tt></a> is equivalent to <a class="reference internal" href="#rational::str_real_approx_eng" title="rational::str_real_approx_eng"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_approx_eng</span></tt></a>
(below) with expStep = 1.)</p>
</dd></dl>

<dl class="function">
<dt id="rational::strs_real_approx_sci">
<tt class="descclassname">rational::</tt><tt class="descname">strs_real_approx_sci</tt> radix roundfun sf q<a class="headerlink" href="#rational::strs_real_approx_sci" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a tuple of strings:</p>
<ul class="simple">
<li>sign of mantissa,</li>
<li>integer part of mantissa,</li>
<li>fraction part of mantissa,</li>
<li>sign of exponent,</li>
<li>exponent magnitude</li>
</ul>
<p>representing an expansion to a number of significant figures in scientific
notation together with</p>
<ul class="simple">
<li>the rounding &#8220;error&#8221;: a fraction representing the next numerals.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="rational::str_real_approx_eng">
<tt class="descclassname">rational::</tt><tt class="descname">str_real_approx_eng</tt> fmt expStep radix intGroup fracGroup round sf q<a class="headerlink" href="#rational::str_real_approx_eng" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a string expansion with a number of significant figures in
engineering notation, using rounding mode roundfun.</p>
<p>The ExpStep parameter specifies the granularity of the exponent;
specifically, the exponent will always be divisible by expStep.</p>
<p>(sf must be positive; expStep is usually 3 and must be positive, radix is
usually 10, <tt class="docutils literal"><span class="pre">roundfun</span></tt> is usually <a class="reference internal" href="purelib.html#round" title="round"><tt class="xref pure pure-func docutils literal"><span class="pre">round</span></tt></a> or
<a class="reference internal" href="#rational::round_unbiased" title="rational::round_unbiased"><tt class="xref pure pure-func docutils literal"><span class="pre">round_unbiased</span></tt></a>.)</p>
</dd></dl>

<p><strong>Example 81</strong> Engineering notation:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>str_real_approx_eng format_uk <span class="mi">3</span> <span class="mi">10</span> <span class="mi">3</span> <span class="mi">3</span> round <span class="mi">7</span> (rational <span class="mi">999950</span>)<span class="p">;</span>
<span class="s">&quot;999.950,0*10^3&quot;</span>
<span class="gp">&gt; </span>str_real_approx_eng format_uk <span class="mi">3</span> <span class="mi">10</span> <span class="mi">3</span> <span class="mi">3</span> round <span class="mi">4</span> <span class="mi">999950</span><span class="p">;</span>
<span class="s">&quot;1.000*10^6(-)&quot;</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::strs_real_approx_eng">
<tt class="descclassname">rational::</tt><tt class="descname">strs_real_approx_eng</tt> expStep radix roundfun sf q<a class="headerlink" href="#rational::strs_real_approx_eng" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a tuple of strings:</p>
<ul class="simple">
<li>sign of mantissa,</li>
<li>integer part of mantissa,</li>
<li>fraction part of mantissa,</li>
<li>sign of exponent,</li>
<li>exponent magnitude</li>
</ul>
<p>representing an expansion to a number of significant figures in engineering
notation together with</p>
<ul class="simple">
<li>the rounding “error”: a fraction representing the next numerals.</li>
</ul>
</dd></dl>

<p><strong>Example 82</strong> Engineering notation — the fragments:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>strs_real_approx_eng <span class="mi">3</span> <span class="mi">10</span> round <span class="mi">7</span> (rational <span class="mi">999950</span>)<span class="p">;</span>
<span class="s">&quot;+&quot;</span>,<span class="s">&quot;999&quot;</span>,<span class="s">&quot;9500&quot;</span>,<span class="s">&quot;+&quot;</span>,<span class="s">&quot;3&quot;</span>,<span class="mi">0L</span>%<span class="mi">1L</span>
<span class="gp">&gt; </span>strs_real_approx_eng <span class="mi">3</span> <span class="mi">10</span> round <span class="mi">4</span> <span class="mi">999950</span><span class="p">;</span>
<span class="s">&quot;+&quot;</span>,<span class="s">&quot;1&quot;</span>,<span class="s">&quot;000&quot;</span>,<span class="s">&quot;+&quot;</span>,<span class="s">&quot;6&quot;</span>,(-<span class="mi">1L</span>)%<span class="mi">20L</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::join_str_real_eng">
<tt class="descclassname">rational::</tt><tt class="descname">join_str_real_eng</tt> fmt intGroup fracGroup mantSign mantI mantF rac expSign expI err<a class="headerlink" href="#rational::join_str_real_eng" title="Permalink to this definition">¶</a></dt>
<dd><p>formats the parts in the quadruple returned by <tt class="docutils literal"><span class="pre">strs_real_approx_eng</span></tt> or
strs_real_approx_sci to the sort of string as returned by
<a class="reference internal" href="#rational::str_real_approx_eng" title="rational::str_real_approx_eng"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_approx_eng</span></tt></a> or <a class="reference internal" href="#rational::str_real_approx_sci" title="rational::str_real_approx_sci"><tt class="xref pure pure-func docutils literal"><span class="pre">str_real_approx_sci</span></tt></a>.</p>
</dd></dl>

</div>
</div>
<div class="section" id="evaluation-of-expansion-strings">
<h3><a class="toc-backref" href="#id76">Evaluation of Expansion Strings</a><a class="headerlink" href="#evaluation-of-expansion-strings" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">str_*</span></tt> and <tt class="docutils literal"><span class="pre">val_*</span></tt> functions depend on a &#8216;format structure&#8217; parameter
(fmt) such as format uk. Conversions may be performed between rationals and
differently formatted strings if a suitable alternative format structure is
supplied. See <a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information
about formatting structures.</p>
<dl class="function">
<dt id="rational::val_real_eng">
<tt class="descclassname">rational::</tt><tt class="descname">val_real_eng</tt> fmt radix strg<a class="headerlink" href="#rational::val_real_eng" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the rational q represented by the base-radix expansion string
strg of one the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frace[−]exponent”</li>
</ul>
</dd></dl>

<p><strong>Example 83</strong> Conversion from the recurring radix expansion-type string
representations:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>val_real_eng format_uk <span class="mi">10</span> <span class="s">&quot;-12.345&quot;</span><span class="p">;</span>
(-<span class="mi">2469L</span>)%<span class="mi">200L</span>
<span class="gp">&gt; </span>val_real_eng format_uk <span class="mi">10</span> <span class="s">&quot;-12.345*10^2&quot;</span><span class="p">;</span>
(-<span class="mi">2469L</span>)%<span class="mi">2L</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::sval_real_eng">
<tt class="descclassname">rational::</tt><tt class="descname">sval_real_eng</tt> radix signStr mantIStr mantF racStr expSignStr expStr<a class="headerlink" href="#rational::sval_real_eng" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the rational q represented by the parts</p>
<ul class="simple">
<li>sign</li>
<li>integer part of mantissa</li>
<li>fraction part of mantissa</li>
<li>sign of exponent</li>
<li>exponent</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="rational::split_str_real_eng">
<tt class="descclassname">rational::</tt><tt class="descname">split_str_real_eng</tt> fmt strg<a class="headerlink" href="#rational::split_str_real_eng" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a tuple containing the string parts</p>
<ul class="simple">
<li>sign</li>
<li>integer part of mantissa</li>
<li>fraction part of mantissa</li>
<li>sign of exponent</li>
<li>exponent</li>
<li>the “error” sign</li>
</ul>
<p>of one the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
</dd></dl>

<p>These functions can deal with the fixed decimal places, the significant figures
and the scientific notation in addition to the engineering notation.</p>
</div>
</div>
<div class="section" id="numeral-string-q-approximation">
<h2><a class="toc-backref" href="#id77">Numeral String -&gt; <strong>Q</strong> — Approximation</a><a class="headerlink" href="#numeral-string-q-approximation" title="Permalink to this headline">¶</a></h2>
<p>This section describes functions to approximate by a rational a real number
represented by a string. See <a class="reference internal" href="#r-q-approximation">R -&gt; Q — Approximation</a> for approximation
by a rational of a double.</p>
<p>The <tt class="docutils literal"><span class="pre">str_*</span></tt> and <tt class="docutils literal"><span class="pre">val_*</span></tt> functions depend on a &#8216;format structure&#8217; parameter
(fmt) such as format uk. Conversions may be performed between rationals and
differently formatted strings if a format structure is supplied. See
<a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a> for information about formatting
structures.</p>
<dl class="function">
<dt id="rational::val_eng_approx_epsilon">
<tt class="descclassname">rational::</tt><tt class="descname">val_eng_approx_epsilon</tt> fmt radix epsilon strg<a class="headerlink" href="#rational::val_eng_approx_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the least complex rational approximation q to the number represented
by the base-radix expansion string str in one of the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
<p>that is ε-close. That is find a q such that |q − eval str| ≤ ε.</p>
</dd></dl>

<p><strong>Example 84</strong> Rational from a long string:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kr">let</span> strg = <span class="s">&quot;123.456,789,876,543,212,345,678,987,654,321*10^27&quot;</span><span class="p">;</span>
<span class="gp">&gt; </span><span class="kr">let</span> x = val_real_eng format_uk <span class="mi">10</span> strg<span class="p">;</span>
<span class="gp">&gt; </span>x<span class="p">;</span>
<span class="mi">123456789876543212345678987654321L</span>%<span class="mi">1000L</span>
<span class="gp">&gt; </span><span class="kr">let</span> q = val_eng_approx_epsilon format_uk <span class="mi">10</span> (<span class="mi">1</span>%<span class="mi">100</span>) strg<span class="p">;</span>
<span class="gp">&gt; </span>q<span class="p">;</span>
<span class="mi">1975308638024691397530863802469L</span>%<span class="mi">16L</span>
<span class="gp">&gt; </span><span class="kt">double</span> (x - q)<span class="p">;</span>
<span class="mf">0.0085</span>
<span class="gp">&gt; </span>str_real_approx_eng format_uk <span class="mi">3</span> <span class="mi">10</span> <span class="mi">3</span> <span class="mi">3</span> round <span class="mi">30</span> q<span class="p">;</span>
<span class="s">&quot;123.456,789,876,543,212,345,678,987,654*10^27(+)&quot;</span>
<span class="gp">&gt; </span>str_real_approx_eng format_uk <span class="mi">3</span> <span class="mi">10</span> <span class="mi">3</span> <span class="mi">3</span> round <span class="mi">42</span> q<span class="p">;</span>
<span class="s">&quot;123.456,789,876,543,212,345,678,987,654,312,500,000,000*10^27&quot;</span>
<span class="gp">&gt; </span><span class="kt">double</span> q<span class="p">;</span>
<span class="mf">1.23456789876543e+029</span>
</pre></div>
</div>
<dl class="function">
<dt id="rational::val_eng_interval_epsilon">
<tt class="descclassname">rational::</tt><tt class="descname">val_eng_interval_epsilon</tt> fmt radix epsilon strg<a class="headerlink" href="#rational::val_eng_interval_epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the least complex rational interval containing the number represented
by the base-radix expansion string strg in one of the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
<p>that is &#8220;-small.</p>
</dd></dl>

<dl class="function">
<dt id="rational::val_eng_approx_max_den">
<tt class="descclassname">rational::</tt><tt class="descname">val_eng_approx_max_den</tt> fmt radix maxDen strg<a class="headerlink" href="#rational::val_eng_approx_max_den" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the closest rational approximation to the number represented by the
base-rRadix expansion string strg in one of the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
<p>that has a denominator no greater than maxDen. (maxDen &gt; 0)</p>
</dd></dl>

<dl class="function">
<dt id="rational::val_eng_interval_max_den">
<tt class="descclassname">rational::</tt><tt class="descname">val_eng_interval_max_den</tt> fmt radix maxDen strg<a class="headerlink" href="#rational::val_eng_interval_max_den" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the smallest rational interval containing the number represented by
the base-radix expansion string strg in one of the forms</p>
<ul class="simple">
<li>“[−]int.frac”</li>
<li>“[−]int.frac ×10^[−]exponent”</li>
</ul>
<p>that has endpoints with denominators no greater than maxDen. (maxDen &gt; 0)</p>
</dd></dl>

<p><strong>Example 85</strong> Other rationals from a long string:</p>
<div class="highlight-pure"><div class="highlight"><pre><span></span><span class="gp">&gt; </span>val_eng_approx_epsilon format_uk <span class="mi">10</span> (<span class="mi">1</span>%<span class="mi">100</span>) strg<span class="p">;</span>
<span class="mi">1975308638024691397530863802469L</span>%<span class="mi">16L</span>
<span class="gp">&gt; </span>val_eng_interval_epsilon format_uk <span class="mi">10</span> (<span class="mi">1</span>%<span class="mi">100</span>) strg<span class="p">;</span>
interval<span class="p">::</span>Ivl (<span class="mi">3086419746913580308641974691358L</span>%<span class="mi">25L</span>)
(<span class="mi">3456790116543209945679011654321L</span>%<span class="mi">28L</span>)
<span class="gp">&gt; </span>val_eng_approx_max_den format_uk <span class="mi">10</span> <span class="mi">100</span> strg<span class="p">;</span>
<span class="mi">9999999980000000199999998000000L</span>%<span class="mi">81L</span>
<span class="gp">&gt; </span>val_eng_interval_max_den format_uk <span class="mi">10</span> <span class="mi">100</span> strg<span class="p">;</span>
interval<span class="p">::</span>Ivl <span class="mi">9999999980000000199999998000000L</span>%<span class="mi">81L</span>
<span class="mi">3456790116543209945679011654321L</span>%<span class="mi">28L</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Pure-Rational - Rational number library for the Pure programming language</a><ul>
<li><a class="reference internal" href="#copying">Copying</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#module-rational">The Rational Module</a></li>
<li><a class="reference internal" href="#the-files-and-the-default-prelude">The Files and the Default Prelude</a><ul>
<li><a class="reference internal" href="#math-pure-and-other-files">math.pure and Other Files</a></li>
<li><a class="reference internal" href="#rational-pure">rational.pure</a></li>
<li><a class="reference internal" href="#rat-interval-pure">rat_interval.pure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notation">Notation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-rational-type">The Rational Type</a><ul>
<li><a class="reference internal" href="#constructors">Constructors</a></li>
<li><a class="reference internal" href="#deconstructors">&#8216;Deconstructors&#8217;</a></li>
<li><a class="reference internal" href="#type-and-value-tests">Type and Value Tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#arithmetic">Arithmetic</a><ul>
<li><a class="reference internal" href="#operators">Operators</a></li>
<li><a class="reference internal" href="#more-on-division">More on Division</a></li>
<li><a class="reference internal" href="#relations-equality-and-inequality-tests">Relations — Equality and Inequality Tests</a></li>
<li><a class="reference internal" href="#comparison-function">Comparison Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mathematical-functions">Mathematical Functions</a><ul>
<li><a class="reference internal" href="#absolute-value-and-sign">Absolute Value and Sign</a></li>
<li><a class="reference internal" href="#greatest-common-divisor-gcd-and-least-common-multiple-lcm">Greatest Common Divisor (GCD) and Least Common Multiple (LCM)</a></li>
<li><a class="reference internal" href="#extrema-minima-and-maxima">Extrema (Minima and Maxima)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#special-rational-functions">Special Rational Functions</a><ul>
<li><a class="reference internal" href="#complexity">Complexity</a><ul>
<li><a class="reference internal" href="#complexity-relations">Complexity Relations</a></li>
<li><a class="reference internal" href="#complexity-comparison-function">Complexity Comparison Function</a></li>
<li><a class="reference internal" href="#complexity-extrema">Complexity Extrema</a></li>
<li><a class="reference internal" href="#other-complexity-functions">Other Complexity Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mediants-and-farey-sequences">Mediants and Farey Sequences</a></li>
<li><a class="reference internal" href="#rational-type-simplification">Rational Type Simplification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-z-rounding"><strong>Q</strong> -&gt; <strong>Z</strong> — Rounding</a><ul>
<li><a class="reference internal" href="#rounding-to-integer">Rounding to Integer</a></li>
<li><a class="reference internal" href="#integer-and-fraction-parts">Integer and Fraction Parts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rounding-to-multiples">Rounding to Multiples</a></li>
<li><a class="reference internal" href="#q-r-conversion-casting"><strong>Q</strong> -&gt; <strong>R</strong> — Conversion / Casting</a></li>
<li><a class="reference internal" href="#r-q-approximation"><strong>R</strong> -&gt; <strong>Q</strong> — Approximation</a><ul>
<li><a class="reference internal" href="#module-rat_interval">Intervals</a><ul>
<li><a class="reference internal" href="#interval-constructors-and-deconstructors">Interval Constructors and &#8216;Deconstructors&#8217;</a></li>
<li><a class="reference internal" href="#interval-type-tests">Interval Type Tests</a></li>
<li><a class="reference internal" href="#interval-arithmetic-operators-and-relations">Interval Arithmetic Operators and Relations</a></li>
<li><a class="reference internal" href="#interval-maths">Interval Maths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#least-complex-approximation-within-epsilon">Least Complex Approximation within Epsilon</a></li>
<li><a class="reference internal" href="#best-approximation-with-bounded-denominator">Best Approximation with Bounded Denominator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#decomposition">Decomposition</a></li>
<li><a class="reference internal" href="#continued-fractions">Continued Fractions</a><ul>
<li><a class="reference internal" href="#id1">Introduction</a></li>
<li><a class="reference internal" href="#generating-continued-fractions">Generating Continued Fractions</a><ul>
<li><a class="reference internal" href="#exact">Exact</a></li>
<li><a class="reference internal" href="#inexact">Inexact</a></li>
</ul>
</li>
<li><a class="reference internal" href="#evaluating-continued-fractions">Evaluating Continued Fractions</a><ul>
<li><a class="reference internal" href="#convergents">Convergents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rational-complex-numbers">Rational Complex Numbers</a><ul>
<li><a class="reference internal" href="#rational-complex-constructors-and-deconstructors">Rational Complex Constructors and &#8216;Deconstructors&#8217;</a></li>
<li><a class="reference internal" href="#rational-complex-type-and-value-tests">Rational Complex Type and Value Tests</a></li>
<li><a class="reference internal" href="#rational-complex-arithmetic-operators-and-relations">Rational Complex Arithmetic Operators and Relations</a></li>
<li><a class="reference internal" href="#rational-complex-maths">Rational Complex Maths</a></li>
<li><a class="reference internal" href="#rational-complex-type-simplification">Rational Complex Type Simplification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#string-formatting-and-evaluation">String Formatting and Evaluation</a><ul>
<li><a class="reference internal" href="#the-naming-of-the-string-conversion-functions">The Naming of the String Conversion Functions</a></li>
<li><a class="reference internal" href="#internationalisation-and-format-structures">Internationalisation and Format Structures</a></li>
<li><a class="reference internal" href="#digit-grouping">Digit Grouping</a></li>
<li><a class="reference internal" href="#radices">Radices</a></li>
<li><a class="reference internal" href="#error-terms">Error Terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-fraction-string-i-n-d"><strong>Q</strong> &lt;-&gt; Fraction String (“i + n/d”)</a><ul>
<li><a class="reference internal" href="#formatting-to-fraction-strings">Formatting to Fraction Strings</a></li>
<li><a class="reference internal" href="#evaluation-of-fraction-strings">Evaluation of Fraction Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-recurring-numeral-expansion-string-i-fr"><strong>Q</strong> &lt;-&gt; Recurring Numeral Expansion String (“I.FR”)</a><ul>
<li><a class="reference internal" href="#formatting-to-recurring-expansion-strings">Formatting to Recurring Expansion Strings</a></li>
<li><a class="reference internal" href="#evaluation-of-recurring-expansion-strings">Evaluation of Recurring Expansion Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#q-numeral-expansion-string-i-f-10e"><strong>Q</strong> &lt;-&gt; Numeral Expansion String (“I.F × 10E”)</a><ul>
<li><a class="reference internal" href="#formatting-to-expansion-strings">Formatting to Expansion Strings</a><ul>
<li><a class="reference internal" href="#functions-for-fixed-decimal-places">Functions for Fixed Decimal Places</a></li>
<li><a class="reference internal" href="#functions-for-significant-figures">Functions for Significant Figures</a></li>
<li><a class="reference internal" href="#functions-for-scientific-notation-and-engineering-notation">Functions for Scientific Notation and Engineering Notation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#evaluation-of-expansion-strings">Evaluation of Expansion Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#numeral-string-q-approximation">Numeral String -&gt; <strong>Q</strong> — Approximation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pure-octave.html"
                        title="previous chapter">pure-octave</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pure-reduce.html"
                        title="next chapter">Computer Algebra with Pure: A Reduce Interface</a></p>
<h3>This Page</h3>
<ul class="this-page-menu">
  <li><a href="bugs.html">Report a Bug</a></li>
  <li><a href="_sources/pure-rational.txt"
         rel="nofollow">Show Source</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pure-modindex.html" title="Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pure-reduce.html" title="Computer Algebra with Pure: A Reduce Interface"
             >next</a> |</li>
        <li class="right" >
          <a href="pure-octave.html" title="pure-octave"
             >previous</a> |</li>
        <li><a href="index.html">Pure Language and Library Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
    &copy; Copyright 2009-2018, Albert Gräf et al.
    Last updated on Mar 16, 2018.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>

  </body>
</html>